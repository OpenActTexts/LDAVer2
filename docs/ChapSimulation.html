<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Simulation and Resampling | Loss Data Analytics   Second Edition</title>
  <meta name="description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Simulation and Resampling | Loss Data Analytics   Second Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="github-repo" content="https://github.com/OpenActTexts/LDAVer2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Simulation and Resampling | Loss Data Analytics   Second Edition" />
  
  <meta name="twitter:description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  

<meta name="author" content="An open text authored by the Actuarial Community" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ChapAggLossModels.html"/>
<link rel="next" href="ChBayes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YKJD3496MG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YKJD3496MG');
</script>


<!-- Mathjax Version 2-->
<script type='text/x-mathjax-config'>
		MathJax.Hub.Config({
			extensions: ['tex2jax.js'],
			jax: ['input/TeX', 'output/HTML-CSS'],
			tex2jax: {
				inlineMath: [ ['$','$'], ['\\(','\\)'] ],
				displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
				processEscapes: true
			},
			'HTML-CSS': { availableFonts: ['TeX'] }
		});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_HTML"> </script>


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/survey-jquery/survey.jquery.min.js"></script>
<link href="https://unpkg.com/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>


<script>
function markdownConverterEWF() {  
//Create showdown markdown converter
var converter = new showdown.Converter();
converter.setOption('ghCompatibleHeaderId', true);
survey
    .onTextMarkdown
    .add(function (survey, options) {
        //convert the markdown text to html
        var str = converter.makeHtml(options.text);
        //remove root paragraphs <p></p>
        str = str.substring(3);
        str = str.substring(0, str.length - 4);
        //set html
        options.html = str;
        MathJax.Hub.Queue(['Typeset',MathJax.Hub, 'options']);
    });  
};

// Quiz Header info
const jsonHeader = { 
    showProgressBar: "bottom",
    showTimerPanel: "none",
    maxTimeToFinishPage: 10000,
    maxTimeToFinish: 25000,
    firstPageIsStarted: true,
    startSurveyText: "Start Quiz" //,
//    title: "Does This Make Sense?"
}


// One and Two question quizzes
function jsonSummary1EWF(json) {  
let jsonEnd1 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
};  
return jsonEnd1;
};


function jsonSummary2EWF(json) {  
let jsonEnd2 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
};  
return jsonEnd2;
};

// Three, four, and five question quizzes
function jsonSummary3EWF(json) {  
let jsonEnd3 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][3]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][3]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][3]["questions"][0]["correctAnswer"]
};  
return jsonEnd3;
};

function jsonSummary4EWF(json) {  
jsonEnd4 = jsonSummary3EWF(json);
jsonEnd4.completedHtml = jsonEnd4.completedHtml +  
"<br>"+
json["pages"][4]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][4]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][4]["questions"][0]["correctAnswer"]
;  
return jsonEnd4;
};

function jsonSummary5EWF(json) {  
jsonEnd5 = jsonSummary4EWF(json);
jsonEnd5.completedHtml = jsonEnd5.completedHtml +  
"<br>"+
json["pages"][5]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][5]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][5]["questions"][0]["correctAnswer"]
;  
return jsonEnd5;
};

function jsonSummary6EWF(json) {  
jsonEnd6 = jsonSummary5EWF(json);
jsonEnd6.completedHtml = jsonEnd6.completedHtml +  
"<br>"+
json["pages"][6]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][6]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][6]["questions"][0]["correctAnswer"]
;  
return jsonEnd6;
};

function jsonSummary7EWF(json) {  
jsonEnd7 = jsonSummary6EWF(json);
jsonEnd7.completedHtml = jsonEnd7.completedHtml +  
"<br>"+
json["pages"][7]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][7]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][7]["questions"][0]["correctAnswer"]
;  
return jsonEnd7;
};

function jsonSummary8EWF(json) {  
jsonEnd8 = jsonSummary7EWF(json);
jsonEnd8.completedHtml = jsonEnd8.completedHtml +  
"<br>"+
json["pages"][8]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][8]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][8]["questions"][0]["correctAnswer"]
;  
return jsonEnd8;
};

function jsonSummary9EWF(json) {  
jsonEnd9 = jsonSummary8EWF(json);
jsonEnd9.completedHtml = jsonEnd9.completedHtml +  
"<br>"+
json["pages"][9]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][9]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][9]["questions"][0]["correctAnswer"]
;  
return jsonEnd9;
};


function jsonSummary10EWF(json) {  
jsonEnd10 = jsonSummary9EWF(json);
jsonEnd10.completedHtml = jsonEnd10.completedHtml +  
"<br>"+
json["pages"][10]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][10]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][10]["questions"][0]["correctAnswer"]
;  
return jsonEnd10;
};


function jsonSummary11EWF(json) {  
jsonEnd11 = jsonSummary10EWF(json);
jsonEnd11.completedHtml = jsonEnd11.completedHtml +  
"<br>"+
json["pages"][11]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][11]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][11]["questions"][0]["correctAnswer"]
;  
return jsonEnd11;
};

Survey.StylesManager.applyTheme("modern");

</script>  
<!-- This completes the code for the quizzes -->

<!-- Various toggle functions used throughout --> 
<script language="javascript">
function toggle(id1,id2) {
	var ele = document.getElementById(id1); var text = document.getElementById(id2);
	if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Solution";}
		else {ele.style.display = "block"; text.innerHTML = "Hide Solution";}}
function togglecode(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show R Code";}
      else {ele.style.display = "block"; text.innerHTML = "Hide R Code";}}
function toggleEX(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Example";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Example";}}
function toggleTheory(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Theory";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Theory";}}
function toggleQuiz(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Quiz Solution";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Quiz Solution";}}      
</script>

<!-- A few functions for revealing definitions -->
<script language="javascript">
<!--   $( function() {
    $("#tabs").tabs();
  } ); -->

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

<script language="javascript">
function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="Format/style.css" type="text/css" />
<link rel="stylesheet" href="includeWebex/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Loss Data Analytics Ed 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reviewers"><i class="fa fa-check"></i>Reviewers</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-collaborators"><i class="fa fa-check"></i>Other Collaborators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-number"><i class="fa fa-check"></i>Version Number</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-our-readers"><i class="fa fa-check"></i>For our Readers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ChapIntro.html"><a href="ChapIntro.html"><i class="fa fa-check"></i><b>1</b> Loss Data and Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Intro"><i class="fa fa-check"></i><b>1.1</b> Data Driven Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#nature-and-relevance-of-insurance"><i class="fa fa-check"></i><b>1.1.1</b> Nature and Relevance of Insurance</a></li>
<li class="chapter" data-level="1.1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:DataDriven"><i class="fa fa-check"></i><b>1.1.2</b> Why Data Driven?</a></li>
<li class="chapter" data-level="1.1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:InsProcesses"><i class="fa fa-check"></i><b>1.1.3</b> Insurance Processes</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:PredModApps"><i class="fa fa-check"></i><b>1.2</b> Insurance Company Operations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ChapIntro.html"><a href="ChapIntro.html#initiating-insurance"><i class="fa fa-check"></i><b>1.2.1</b> Initiating Insurance</a></li>
<li class="chapter" data-level="1.2.2" data-path="ChapIntro.html"><a href="ChapIntro.html#renewing-insurance"><i class="fa fa-check"></i><b>1.2.2</b> Renewing Insurance</a></li>
<li class="chapter" data-level="1.2.3" data-path="ChapIntro.html"><a href="ChapIntro.html#claims-and-product-management"><i class="fa fa-check"></i><b>1.2.3</b> Claims and Product Management</a></li>
<li class="chapter" data-level="1.2.4" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Reserving"><i class="fa fa-check"></i><b>1.2.4</b> Loss Reserving</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:LGPIF"><i class="fa fa-check"></i><b>1.3</b> Case Study: Wisconsin Property Fund</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:OutComes"><i class="fa fa-check"></i><b>1.3.1</b> Fund Claims Variables: Frequency and Severity</a></li>
<li class="chapter" data-level="1.3.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:FundVariables"><i class="fa fa-check"></i><b>1.3.2</b> Fund Rating Variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="ChapIntro.html"><a href="ChapIntro.html#fund-operations"><i class="fa fa-check"></i><b>1.3.3</b> Fund Operations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ChapIntro.html"><a href="ChapIntro.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
<li class="chapter" data-level="1.5" data-path="ChapIntro.html"><a href="ChapIntro.html#Intro-further-reading-and-resources"><i class="fa fa-check"></i><b>1.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec21"><i class="fa fa-check"></i><b>2.1</b> Elements of Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#key-data-analytic-concepts"><i class="fa fa-check"></i><b>2.1.1</b> Key Data Analytic Concepts</a></li>
<li class="chapter" data-level="2.1.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec212"><i class="fa fa-check"></i><b>2.1.2</b> Data versus Algorithmic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec22"><i class="fa fa-check"></i><b>2.2</b> Data Analysis Process</a></li>
<li class="chapter" data-level="2.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec23"><i class="fa fa-check"></i><b>2.3</b> Single Variable Analytics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec231"><i class="fa fa-check"></i><b>2.3.1</b> Variable Types</a></li>
<li class="chapter" data-level="2.3.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec232"><i class="fa fa-check"></i><b>2.3.2</b> Exploratory versus Confirmatory</a></li>
<li class="chapter" data-level="2.3.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec233"><i class="fa fa-check"></i><b>2.3.3</b> Model Construction</a></li>
<li class="chapter" data-level="2.3.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec234"><i class="fa fa-check"></i><b>2.3.4</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec24"><i class="fa fa-check"></i><b>2.4</b> Analytics with Many Variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#supervised-and-unsupervised-learning"><i class="fa fa-check"></i><b>2.4.1</b> Supervised and Unsupervised Learning</a></li>
<li class="chapter" data-level="2.4.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#algorithmic-modeling"><i class="fa fa-check"></i><b>2.4.2</b> Algorithmic Modeling</a></li>
<li class="chapter" data-level="2.4.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-modeling"><i class="fa fa-check"></i><b>2.4.3</b> Data Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec25"><i class="fa fa-check"></i><b>2.5</b> Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-structures-and-storage"><i class="fa fa-check"></i><b>2.5.2</b> Data Structures and Storage</a></li>
<li class="chapter" data-level="2.5.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> Data Cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec254"><i class="fa fa-check"></i><b>2.5.4</b> Big Data Analysis</a></li>
<li class="chapter" data-level="2.5.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#ethical-issues"><i class="fa fa-check"></i><b>2.5.5</b> Ethical Issues</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec26"><i class="fa fa-check"></i><b>2.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec261"><i class="fa fa-check"></i><b>2.6.1</b> Technical Supplement: Multivariate Exploratory Analysis</a></li>
<li class="chapter" data-level="2.6.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#tree-based-models"><i class="fa fa-check"></i><b>2.6.2</b> Tree-based Models</a></li>
<li class="chapter" data-level="2.6.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#technical-supplement-some-r-functions"><i class="fa fa-check"></i><b>2.6.3</b> Technical Supplement: Some R Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html"><i class="fa fa-check"></i><b>3</b> Frequency Modeling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec31"><i class="fa fa-check"></i><b>3.1</b> Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec311"><i class="fa fa-check"></i><b>3.1.1</b> How Frequency Augments Severity Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec32"><i class="fa fa-check"></i><b>3.2</b> Basic Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec321"><i class="fa fa-check"></i><b>3.2.1</b> Foundations</a></li>
<li class="chapter" data-level="3.2.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec322"><i class="fa fa-check"></i><b>3.2.2</b> Moment and Probability Generating Functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec323"><i class="fa fa-check"></i><b>3.2.3</b> Important Frequency Distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec33"><i class="fa fa-check"></i><b>3.3</b> The (<em>a</em>, <em>b</em>, 0) Class</a></li>
<li class="chapter" data-level="3.4" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec34"><i class="fa fa-check"></i><b>3.4</b> Estimating Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec341"><i class="fa fa-check"></i><b>3.4.1</b> Parameter Estimation</a></li>
<li class="chapter" data-level="3.4.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec342"><i class="fa fa-check"></i><b>3.4.2</b> Frequency Distributions MLE</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec35"><i class="fa fa-check"></i><b>3.5</b> Other Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec351"><i class="fa fa-check"></i><b>3.5.1</b> Zero Truncation or Modification</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec36"><i class="fa fa-check"></i><b>3.6</b> Mixture Distributions</a></li>
<li class="chapter" data-level="3.7" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec37"><i class="fa fa-check"></i><b>3.7</b> Real Data Example</a></li>
<li class="chapter" data-level="3.8" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec38"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec39"><i class="fa fa-check"></i><b>3.9</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:rcode"><i class="fa fa-check"></i><b>3.9.1</b> TS 3.A. R Code for Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ChapSeverity.html"><a href="ChapSeverity.html"><i class="fa fa-check"></i><b>4</b> Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec41"><i class="fa fa-check"></i><b>4.1</b> Basic Distributional Quantities</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec411"><i class="fa fa-check"></i><b>4.1.1</b> Moments and Moment Generating Functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec412"><i class="fa fa-check"></i><b>4.1.2</b> Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec42"><i class="fa fa-check"></i><b>4.2</b> Continuous Distributions for Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec421"><i class="fa fa-check"></i><b>4.2.1</b> Gamma Distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec422"><i class="fa fa-check"></i><b>4.2.2</b> Pareto Distribution</a></li>
<li class="chapter" data-level="4.2.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec423"><i class="fa fa-check"></i><b>4.2.3</b> Weibull Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec424"><i class="fa fa-check"></i><b>4.2.4</b> The Generalized Beta Distribution of the Second Kind</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec43"><i class="fa fa-check"></i><b>4.3</b> Methods of Creating New Distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec431"><i class="fa fa-check"></i><b>4.3.1</b> Functions of Random Variables and their Distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec432"><i class="fa fa-check"></i><b>4.3.2</b> Mixture Distributions for Severity</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec44"><i class="fa fa-check"></i><b>4.4</b> Estimating Loss Distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec441"><i class="fa fa-check"></i><b>4.4.1</b> Nonparametric Estimation</a></li>
<li class="chapter" data-level="4.4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec442"><i class="fa fa-check"></i><b>4.4.2</b> Parametric Estimation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec45"><i class="fa fa-check"></i><b>4.5</b> Exercises with a Practical Focus</a></li>
<li class="chapter" data-level="4.6" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec46"><i class="fa fa-check"></i><b>4.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html"><i class="fa fa-check"></i><b>5</b> Modeling Claim Severity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec51"><i class="fa fa-check"></i><b>5.1</b> Coverage Modifications</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec511"><i class="fa fa-check"></i><b>5.1.1</b> Policy Deductibles</a></li>
<li class="chapter" data-level="5.1.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec512"><i class="fa fa-check"></i><b>5.1.2</b> Policy Limits</a></li>
<li class="chapter" data-level="5.1.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec513"><i class="fa fa-check"></i><b>5.1.3</b> Coinsurance and Inflation</a></li>
<li class="chapter" data-level="5.1.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec514"><i class="fa fa-check"></i><b>5.1.4</b> Reinsurance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec52"><i class="fa fa-check"></i><b>5.2</b> Parametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec521"><i class="fa fa-check"></i><b>5.2.1</b> Parametric Estimation using Grouped Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec522"><i class="fa fa-check"></i><b>5.2.2</b> Censored Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec523"><i class="fa fa-check"></i><b>5.2.3</b> Truncated Data</a></li>
<li class="chapter" data-level="5.2.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec524"><i class="fa fa-check"></i><b>5.2.4</b> Parametric Estimation using Censored and Truncated Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec53"><i class="fa fa-check"></i><b>5.3</b> Nonparametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec531"><i class="fa fa-check"></i><b>5.3.1</b> Grouped Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec532"><i class="fa fa-check"></i><b>5.3.2</b> Plug-in Principle</a></li>
<li class="chapter" data-level="5.3.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec533"><i class="fa fa-check"></i><b>5.3.3</b> Right-Censored Empirical Distribution Function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec54"><i class="fa fa-check"></i><b>5.4</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html"><i class="fa fa-check"></i><b>6</b> Model Selection</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec61"><i class="fa fa-check"></i><b>6.1</b> Tools for Model Selection and Diagnostics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec611"><i class="fa fa-check"></i><b>6.1.1</b> Graphical Comparison of Distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec612"><i class="fa fa-check"></i><b>6.1.2</b> Statistical Comparison of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec62"><i class="fa fa-check"></i><b>6.2</b> Iterative Model Selection</a></li>
<li class="chapter" data-level="6.3" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec63"><i class="fa fa-check"></i><b>6.3</b> Model Selection Based on a Training Dataset</a></li>
<li class="chapter" data-level="6.4" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec64"><i class="fa fa-check"></i><b>6.4</b> Model Selection Based on a Test Dataset</a></li>
<li class="chapter" data-level="6.5" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec65"><i class="fa fa-check"></i><b>6.5</b> Model Selection Based on Cross-Validation</a></li>
<li class="chapter" data-level="6.6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec66"><i class="fa fa-check"></i><b>6.6</b> Model Selection for Modified Data</a></li>
<li class="chapter" data-level="6.7" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#further-resources-and-contributors"><i class="fa fa-check"></i><b>6.7</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html"><i class="fa fa-check"></i><b>7</b> Aggregate Loss Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec71"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec72"><i class="fa fa-check"></i><b>7.2</b> Individual Risk Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec721"><i class="fa fa-check"></i><b>7.2.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.2.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec722"><i class="fa fa-check"></i><b>7.2.2</b> Aggregate Loss Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec73"><i class="fa fa-check"></i><b>7.3</b> Collective Risk Model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec731"><i class="fa fa-check"></i><b>7.3.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.3.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec732"><i class="fa fa-check"></i><b>7.3.2</b> Stop-loss Insurance</a></li>
<li class="chapter" data-level="7.3.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec733"><i class="fa fa-check"></i><b>7.3.3</b> Closed-form Distributions</a></li>
<li class="chapter" data-level="7.3.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec734"><i class="fa fa-check"></i><b>7.3.4</b> Tweedie Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec74"><i class="fa fa-check"></i><b>7.4</b> Computing the Aggregate Claims Distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec741"><i class="fa fa-check"></i><b>7.4.1</b> Recursive Method</a></li>
<li class="chapter" data-level="7.4.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec742"><i class="fa fa-check"></i><b>7.4.2</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec75"><i class="fa fa-check"></i><b>7.5</b> Effects of Coverage Modifications</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec751"><i class="fa fa-check"></i><b>7.5.1</b> Impact of Exposure on Frequency</a></li>
<li class="chapter" data-level="7.5.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec752"><i class="fa fa-check"></i><b>7.5.2</b> Impact of Deductibles on Claim Frequency</a></li>
<li class="chapter" data-level="7.5.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec753"><i class="fa fa-check"></i><b>7.5.3</b> Impact of Policy Modifications on Aggregate Claims</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec76"><i class="fa fa-check"></i><b>7.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.1.-individual-risk-model-properties"><i class="fa fa-check"></i>TS 7.A.1. Individual Risk Model Properties</a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.2.-relationship-between-probability-generating-functions-of-x_i-and-x_it"><i class="fa fa-check"></i>TS 7.A.2. Relationship Between Probability Generating Functions of <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_i^T\)</span></a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.3.-moment-generating-function-of-aggregate-loss-s_n-in-example-7.3.9"><i class="fa fa-check"></i>TS 7.A.3. Moment Generating Function of Aggregate Loss <span class="math inline">\(S_N\)</span> in Example 7.3.9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ChapSimulation.html"><a href="ChapSimulation.html"><i class="fa fa-check"></i><b>8</b> Simulation and Resampling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec81"><i class="fa fa-check"></i><b>8.1</b> Random Number Generation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec811"><i class="fa fa-check"></i><b>8.1.1</b> Generating Independent Uniform Observations</a></li>
<li class="chapter" data-level="8.1.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec812"><i class="fa fa-check"></i><b>8.1.2</b> Inverse Transform Method</a></li>
<li class="chapter" data-level="8.1.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec813"><i class="fa fa-check"></i><b>8.1.3</b> Ready-made Random Number Generators</a></li>
<li class="chapter" data-level="8.1.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec814"><i class="fa fa-check"></i><b>8.1.4</b> Simulating from Complex Distributions</a></li>
<li class="chapter" data-level="8.1.5" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec815"><i class="fa fa-check"></i><b>8.1.5</b> Importance Sampling</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec82"><i class="fa fa-check"></i><b>8.2</b> Computing Distribution Parameters</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec821"><i class="fa fa-check"></i><b>8.2.1</b> Simulating Parameters</a></li>
<li class="chapter" data-level="8.2.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec822"><i class="fa fa-check"></i><b>8.2.2</b> Determining the Number of Simulations</a></li>
<li class="chapter" data-level="8.2.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec823"><i class="fa fa-check"></i><b>8.2.3</b> Simulation and Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec83"><i class="fa fa-check"></i><b>8.3</b> Bootstrapping and Resampling</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec831"><i class="fa fa-check"></i><b>8.3.1</b> Bootstrap Foundations</a></li>
<li class="chapter" data-level="8.3.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec832"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap Precision: Bias, Standard Deviation, and Mean Square Error</a></li>
<li class="chapter" data-level="8.3.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec833"><i class="fa fa-check"></i><b>8.3.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="8.3.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec834"><i class="fa fa-check"></i><b>8.3.4</b> Parametric Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec84"><i class="fa fa-check"></i><b>8.4</b> Model Selection and Cross-Validation</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec841"><i class="fa fa-check"></i><b>8.4.1</b> k-Fold Cross-Validation</a></li>
<li class="chapter" data-level="8.4.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec842"><i class="fa fa-check"></i><b>8.4.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="8.4.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec843"><i class="fa fa-check"></i><b>8.4.3</b> Cross-Validation and Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec85"><i class="fa fa-check"></i><b>8.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ChBayes.html"><a href="ChBayes.html"><i class="fa fa-check"></i><b>9</b> Bayesian Statistics and Modeling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec91"><i class="fa fa-check"></i><b>9.1</b> A Gentle Introduction to Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec911"><i class="fa fa-check"></i><b>9.1.1</b> Bayesian versus Frequentist Statistics</a></li>
<li class="chapter" data-level="9.1.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec912"><i class="fa fa-check"></i><b>9.1.2</b> A Brief History Lesson</a></li>
<li class="chapter" data-level="9.1.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec913"><i class="fa fa-check"></i><b>9.1.3</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="9.1.4" data-path="ChBayes.html"><a href="ChBayes.html#an-introductory-example-of-bayes-rule"><i class="fa fa-check"></i><b>9.1.4</b> An Introductory Example of Bayes’ Rule</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec92"><i class="fa fa-check"></i><b>9.2</b> Building Blocks of Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec921"><i class="fa fa-check"></i><b>9.2.1</b> Posterior Distribution</a></li>
<li class="chapter" data-level="9.2.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec922"><i class="fa fa-check"></i><b>9.2.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="9.2.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec923"><i class="fa fa-check"></i><b>9.2.3</b> Prior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec93"><i class="fa fa-check"></i><b>9.3</b> Conjugate Families</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec931"><i class="fa fa-check"></i><b>9.3.1</b> The Beta–Binomial Conjugate Family</a></li>
<li class="chapter" data-level="9.3.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec932"><i class="fa fa-check"></i><b>9.3.2</b> The Gamma–Poisson Conjugate Family</a></li>
<li class="chapter" data-level="9.3.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec933"><i class="fa fa-check"></i><b>9.3.3</b> The Normal–Normal Conjugate Family</a></li>
<li class="chapter" data-level="9.3.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec934"><i class="fa fa-check"></i><b>9.3.4</b> Criticism of Conjugate Family Models</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec94"><i class="fa fa-check"></i><b>9.4</b> Posterior Simulation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec941"><i class="fa fa-check"></i><b>9.4.1</b> Introduction to Markov Chain Monte Carlo Methods</a></li>
<li class="chapter" data-level="9.4.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec942"><i class="fa fa-check"></i><b>9.4.2</b> The Gibbs Sampler</a></li>
<li class="chapter" data-level="9.4.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec943"><i class="fa fa-check"></i><b>9.4.3</b> The Metropolis–Hastings Algorithm</a></li>
<li class="chapter" data-level="9.4.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec944"><i class="fa fa-check"></i><b>9.4.4</b> Markov Chain Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec95"><i class="fa fa-check"></i><b>9.5</b> Bayesian Statistics in Practice</a></li>
<li class="chapter" data-level="9.6" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec96"><i class="fa fa-check"></i><b>9.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChBayes.html"><a href="ChBayes.html#contributors-8"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html"><i class="fa fa-check"></i><b>10</b> Premium Foundations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec101"><i class="fa fa-check"></i><b>10.1</b> Introduction to Ratemaking</a></li>
<li class="chapter" data-level="10.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec102"><i class="fa fa-check"></i><b>10.2</b> Data Sources</a></li>
<li class="chapter" data-level="10.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec103"><i class="fa fa-check"></i><b>10.3</b> Claims</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1031"><i class="fa fa-check"></i><b>10.3.1</b> Estimated Ultimate Claims</a></li>
<li class="chapter" data-level="10.3.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1032"><i class="fa fa-check"></i><b>10.3.2</b> Adjustments to Claims and Allocated Claims Adjustment Expenses</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec104"><i class="fa fa-check"></i><b>10.4</b> Exposures</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1041"><i class="fa fa-check"></i><b>10.4.1</b> Criteria for Choosing an Exposure</a></li>
<li class="chapter" data-level="10.4.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1042"><i class="fa fa-check"></i><b>10.4.2</b> Written and Earned Exposures</a></li>
<li class="chapter" data-level="10.4.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1043"><i class="fa fa-check"></i><b>10.4.3</b> Adjustments to Exposures</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec105"><i class="fa fa-check"></i><b>10.5</b> Pure Premiums</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1051"><i class="fa fa-check"></i><b>10.5.1</b> Experience Period</a></li>
<li class="chapter" data-level="10.5.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1052"><i class="fa fa-check"></i><b>10.5.2</b> Expected Pure Premium</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec106"><i class="fa fa-check"></i><b>10.6</b> Non-Claim Expenses</a></li>
<li class="chapter" data-level="10.7" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec107"><i class="fa fa-check"></i><b>10.7</b> Investment Income</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1071"><i class="fa fa-check"></i><b>10.7.1</b> Investment Income on Policyholder Cash Flows</a></li>
<li class="chapter" data-level="10.7.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1072"><i class="fa fa-check"></i><b>10.7.2</b> Investment Income on Surplus</a></li>
<li class="chapter" data-level="10.7.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1073"><i class="fa fa-check"></i><b>10.7.3</b> The Underwriting Profit Provisions</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec108"><i class="fa fa-check"></i><b>10.8</b> The Premium Equation</a></li>
<li class="chapter" data-level="10.9" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec109"><i class="fa fa-check"></i><b>10.9</b> Pricing Principles</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1091"><i class="fa fa-check"></i><b>10.9.1</b> Premium Principles</a></li>
<li class="chapter" data-level="10.9.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1092"><i class="fa fa-check"></i><b>10.9.2</b> Properties of Premium Principles</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1010"><i class="fa fa-check"></i><b>10.10</b> Reviewing Rate Adequacy</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10101"><i class="fa fa-check"></i><b>10.10.1</b> The Loss Ratio Method</a></li>
<li class="chapter" data-level="10.10.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10102"><i class="fa fa-check"></i><b>10.10.2</b> Target Loss Ratio</a></li>
<li class="chapter" data-level="10.10.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10103"><i class="fa fa-check"></i><b>10.10.3</b> Experience Period Loss Ratios</a></li>
<li class="chapter" data-level="10.10.4" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10104"><i class="fa fa-check"></i><b>10.10.4</b> Adjustments to Loss</a></li>
<li class="chapter" data-level="10.10.5" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10105"><i class="fa fa-check"></i><b>10.10.5</b> Premium On-Level Adjustment</a></li>
<li class="chapter" data-level="10.10.6" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10106"><i class="fa fa-check"></i><b>10.10.6</b> Premium Trend</a></li>
<li class="chapter" data-level="10.10.7" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10107"><i class="fa fa-check"></i><b>10.10.7</b> Credibility</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1011"><i class="fa fa-check"></i><b>10.11</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#ts-10.a.-rate-regulation"><i class="fa fa-check"></i>TS 10.A. Rate Regulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html"><i class="fa fa-check"></i><b>11</b> Risk Classification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec111"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec112"><i class="fa fa-check"></i><b>11.2</b> Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1121"><i class="fa fa-check"></i><b>11.2.1</b> Need for Poisson Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1122"><i class="fa fa-check"></i><b>11.2.2</b> Poisson Regression</a></li>
<li class="chapter" data-level="11.2.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1123"><i class="fa fa-check"></i><b>11.2.3</b> Incorporating Exposure</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec113"><i class="fa fa-check"></i><b>11.3</b> Categorical Variables and Multiplicative Tariff</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1131"><i class="fa fa-check"></i><b>11.3.1</b> Rating Factors and Tariff</a></li>
<li class="chapter" data-level="11.3.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1132"><i class="fa fa-check"></i><b>11.3.2</b> Multiplicative Tariff Model</a></li>
<li class="chapter" data-level="11.3.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1133"><i class="fa fa-check"></i><b>11.3.3</b> Poisson Regression for Multiplicative Tariff</a></li>
<li class="chapter" data-level="11.3.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1134"><i class="fa fa-check"></i><b>11.3.4</b> Numerical Examples</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec114"><i class="fa fa-check"></i><b>11.4</b> Risk Classification vs Discrimination</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1141"><i class="fa fa-check"></i><b>11.4.1</b> Economic Commodity versus Social Good</a></li>
<li class="chapter" data-level="11.4.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1142"><i class="fa fa-check"></i><b>11.4.2</b> Information Asymmetry</a></li>
<li class="chapter" data-level="11.4.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1143"><i class="fa fa-check"></i><b>11.4.3</b> Sensitive Variables and Regulation</a></li>
<li class="chapter" data-level="11.4.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1144"><i class="fa fa-check"></i><b>11.4.4</b> Big Data Models and Proxy Discrimination</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec115"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
<li class="chapter" data-level="11.6" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec116"><i class="fa fa-check"></i><b>11.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-11.a.-estimating-poisson-regression-models"><i class="fa fa-check"></i>TS 11.A. Estimating Poisson Regression Models</a></li>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-11.b.-selecting-rating-factors"><i class="fa fa-check"></i>TS 11.B. Selecting Rating Factors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ChapCredibility.html"><a href="ChapCredibility.html"><i class="fa fa-check"></i><b>12</b> Experience Rating Using Credibility Theory</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#introduction-to-applications-of-credibility-theory"><i class="fa fa-check"></i><b>12.1</b> Introduction to Applications of Credibility Theory</a></li>
<li class="chapter" data-level="12.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec122"><i class="fa fa-check"></i><b>12.2</b> Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1221"><i class="fa fa-check"></i><b>12.2.1</b> Credibility-Weighted Estimate for the Expected Loss</a></li>
<li class="chapter" data-level="12.2.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1222"><i class="fa fa-check"></i><b>12.2.2</b> Credibility <em>Z</em>, <em>EPV</em>, and <em>VHM</em></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec123"><i class="fa fa-check"></i><b>12.3</b> Bayesian Inference and Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1231"><i class="fa fa-check"></i><b>12.3.1</b> Beta-Binomial Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1232"><i class="fa fa-check"></i><b>12.3.2</b> Gamma-Poisson Model</a></li>
<li class="chapter" data-level="12.3.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1233"><i class="fa fa-check"></i><b>12.3.3</b> Exact Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec124"><i class="fa fa-check"></i><b>12.4</b> Bühlmann-Straub Credibility</a></li>
<li class="chapter" data-level="12.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec125"><i class="fa fa-check"></i><b>12.5</b> Estimating Credibility Parameters</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#nonparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.1</b> Nonparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
<li class="chapter" data-level="12.5.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#semiparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.2</b> Semiparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec126"><i class="fa fa-check"></i><b>12.6</b> Limited Fluctuation Credibility</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1261"><i class="fa fa-check"></i><b>12.6.1</b> Full Credibility for Claim Frequency</a></li>
<li class="chapter" data-level="12.6.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-aggregate-losses-and-pure-premium"><i class="fa fa-check"></i><b>12.6.2</b> Full Credibility for Aggregate Losses and Pure Premium</a></li>
<li class="chapter" data-level="12.6.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-severity"><i class="fa fa-check"></i><b>12.6.3</b> Full Credibility for Severity</a></li>
<li class="chapter" data-level="12.6.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#partial-credibility"><i class="fa fa-check"></i><b>12.6.4</b> Partial Credibility</a></li>
<li class="chapter" data-level="12.6.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-standard-for-limited-fluctuation-credibility"><i class="fa fa-check"></i><b>12.6.5</b> Full Credibility Standard for Limited Fluctuation Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec127"><i class="fa fa-check"></i><b>12.7</b> Balancing Credibility Estimators</a></li>
<li class="chapter" data-level="12.8" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec128"><i class="fa fa-check"></i><b>12.8</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html"><i class="fa fa-check"></i><b>13</b> Insurance Portfolio Management including Reinsurance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#introduction-to-insurance-portfolios"><i class="fa fa-check"></i><b>13.1</b> Introduction to Insurance Portfolios</a></li>
<li class="chapter" data-level="13.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec132"><i class="fa fa-check"></i><b>13.2</b> Tails of Distributions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#classification-based-on-moments"><i class="fa fa-check"></i><b>13.2.1</b> Classification Based on Moments</a></li>
<li class="chapter" data-level="13.2.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#comparison-based-on-limiting-tail-behavior"><i class="fa fa-check"></i><b>13.2.2</b> Comparison Based on Limiting Tail Behavior</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec133"><i class="fa fa-check"></i><b>13.3</b> Risk Measures</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#value-at-risk"><i class="fa fa-check"></i><b>13.3.1</b> Value-at-Risk</a></li>
<li class="chapter" data-level="13.3.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#expected-shortfall"><i class="fa fa-check"></i><b>13.3.2</b> Expected Shortfall</a></li>
<li class="chapter" data-level="13.3.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1333"><i class="fa fa-check"></i><b>13.3.3</b> Coherent Risk Measures</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec134"><i class="fa fa-check"></i><b>13.4</b> Reinsurance</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1341"><i class="fa fa-check"></i><b>13.4.1</b> Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1342"><i class="fa fa-check"></i><b>13.4.2</b> Non-Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1343"><i class="fa fa-check"></i><b>13.4.3</b> Additional Reinsurance Treaties</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#exercises-2"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
<li class="chapter" data-level="13.6" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec136"><i class="fa fa-check"></i><b>13.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html"><i class="fa fa-check"></i><b>14</b> Loss Reserving</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec141"><i class="fa fa-check"></i><b>14.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1412"><i class="fa fa-check"></i><b>14.1.1</b> Closed, IBNR, and RBNS Claims</a></li>
<li class="chapter" data-level="14.1.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1411"><i class="fa fa-check"></i><b>14.1.2</b> Why Reserving?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec142"><i class="fa fa-check"></i><b>14.2</b> Loss Reserve Data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1421"><i class="fa fa-check"></i><b>14.2.1</b> From Micro to Macro</a></li>
<li class="chapter" data-level="14.2.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1422"><i class="fa fa-check"></i><b>14.2.2</b> Run-off Triangles</a></li>
<li class="chapter" data-level="14.2.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1423"><i class="fa fa-check"></i><b>14.2.3</b> Loss Reserve Notation</a></li>
<li class="chapter" data-level="14.2.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1424"><i class="fa fa-check"></i><b>14.2.4</b> R Code to Summarize Loss Reserve Data</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec143"><i class="fa fa-check"></i><b>14.3</b> The Chain-Ladder Method</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1431"><i class="fa fa-check"></i><b>14.3.1</b> The Deterministic Chain-Ladder</a></li>
<li class="chapter" data-level="14.3.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1432"><i class="fa fa-check"></i><b>14.3.2</b> Mack’s Distribution-Free Chain-Ladder Model</a></li>
<li class="chapter" data-level="14.3.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1433"><i class="fa fa-check"></i><b>14.3.3</b> R code for Chain-Ladder Predictions</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec144"><i class="fa fa-check"></i><b>14.4</b> GLMs and Bootstrap for Loss Reserves</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-specification"><i class="fa fa-check"></i><b>14.4.1</b> Model Specification</a></li>
<li class="chapter" data-level="14.4.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-estimation-and-prediction"><i class="fa fa-check"></i><b>14.4.2</b> Model Estimation and Prediction</a></li>
<li class="chapter" data-level="14.4.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#bootstrap"><i class="fa fa-check"></i><b>14.4.3</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec145"><i class="fa fa-check"></i><b>14.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html"><i class="fa fa-check"></i><b>15</b> Experience Rating using Bonus-Malus</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec151"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec152"><i class="fa fa-check"></i><b>15.2</b> <em>BMS</em> in Several Countries</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#bms-in-malaysia"><i class="fa fa-check"></i><b>15.2.1</b> <em>BMS</em> in Malaysia</a></li>
<li class="chapter" data-level="15.2.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#bms-in-other-countries"><i class="fa fa-check"></i><b>15.2.2</b> <em>BMS</em> in Other Countries</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec153"><i class="fa fa-check"></i><b>15.3</b> <em>BMS</em> and Markov Chain Model</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#transition-probability"><i class="fa fa-check"></i><b>15.3.1</b> Transition Probability</a></li>
<li class="chapter" data-level="15.3.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#some-applications"><i class="fa fa-check"></i><b>15.3.2</b> Some Applications</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec154"><i class="fa fa-check"></i><b>15.4</b> <em>BMS</em> and Stationary Distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution"><i class="fa fa-check"></i><b>15.4.1</b> Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-a-stationary-distribution"><i class="fa fa-check"></i><b>15.4.2</b> <code>R</code> Code for a Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-evolution"><i class="fa fa-check"></i><b>15.4.3</b> Premium Evolution</a></li>
<li class="chapter" data-level="15.4.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-premium-evolution"><i class="fa fa-check"></i><b>15.4.4</b> <code>R</code> Code for Premium Evolution</a></li>
<li class="chapter" data-level="15.4.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#convergence-rate"><i class="fa fa-check"></i><b>15.4.5</b> Convergence Rate</a></li>
<li class="chapter" data-level="15.4.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-convergence-rate"><i class="fa fa-check"></i><b>15.4.6</b> <code>R</code> Code for Convergence Rate</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec155"><i class="fa fa-check"></i><b>15.5</b> <em>BMS</em> and Premium Rating</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-rating"><i class="fa fa-check"></i><b>15.5.1</b> Premium Rating</a></li>
<li class="chapter" data-level="15.5.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#a-priori-risk-classification"><i class="fa fa-check"></i><b>15.5.2</b> A Priori Risk Classification</a></li>
<li class="chapter" data-level="15.5.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#modelling-of-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.3</b> Modelling of Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution-allowing-for-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.4</b> Stationary Distribution Allowing for Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#determination-of-optimal-relativities"><i class="fa fa-check"></i><b>15.5.5</b> Determination of Optimal Relativities</a></li>
<li class="chapter" data-level="15.5.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#numerical-illustrations"><i class="fa fa-check"></i><b>15.5.6</b> Numerical Illustrations</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec156"><i class="fa fa-check"></i><b>15.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html"><i class="fa fa-check"></i><b>16</b> Quantifying Dependence</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec161"><i class="fa fa-check"></i><b>16.1</b> Classic Measures of Scalar Associations</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#association-measures-for-quantitative-variables"><i class="fa fa-check"></i><b>16.1.1</b> Association Measures for Quantitative Variables</a></li>
<li class="chapter" data-level="16.1.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1612"><i class="fa fa-check"></i><b>16.1.2</b> Rank Based Measures</a></li>
<li class="chapter" data-level="16.1.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1613"><i class="fa fa-check"></i><b>16.1.3</b> Tail Dependence Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec162"><i class="fa fa-check"></i><b>16.2</b> Introduction to Copulas</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#definition-of-a-copula"><i class="fa fa-check"></i><b>16.2.1</b> Definition of a Copula</a></li>
<li class="chapter" data-level="16.2.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#sklars-theorem"><i class="fa fa-check"></i><b>16.2.2</b> Sklar’s Theorem</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec163"><i class="fa fa-check"></i><b>16.3</b> Application Using Copulas</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#marginal-models"><i class="fa fa-check"></i><b>16.3.1</b> Marginal Models</a></li>
<li class="chapter" data-level="16.3.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1632"><i class="fa fa-check"></i><b>16.3.2</b> Probability Integral Transformation</a></li>
<li class="chapter" data-level="16.3.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#joint-modeling-with-copula-function"><i class="fa fa-check"></i><b>16.3.3</b> Joint Modeling with Copula Function</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec164"><i class="fa fa-check"></i><b>16.4</b> Types of Copulas</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#normal-gaussian-copulas"><i class="fa fa-check"></i><b>16.4.1</b> Normal (Gaussian) Copulas</a></li>
<li class="chapter" data-level="16.4.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#t--and-elliptical-copulas"><i class="fa fa-check"></i><b>16.4.2</b> <em>t</em>- and Elliptical Copulas</a></li>
<li class="chapter" data-level="16.4.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#archimedean-copulas"><i class="fa fa-check"></i><b>16.4.3</b> Archimedean Copulas</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#properties-of-copulas"><i class="fa fa-check"></i><b>16.5</b> Properties of Copulas</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1651"><i class="fa fa-check"></i><b>16.5.1</b> Bounds on Association</a></li>
<li class="chapter" data-level="16.5.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1652"><i class="fa fa-check"></i><b>16.5.2</b> Measures of Association</a></li>
<li class="chapter" data-level="16.5.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#tail-dependency"><i class="fa fa-check"></i><b>16.5.3</b> Tail Dependency</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec166"><i class="fa fa-check"></i><b>16.6</b> Importance of Dependence Modeling</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#why-is-dependence-modeling-important"><i class="fa fa-check"></i><b>16.6.1</b> Why is Dependence Modeling Important?</a></li>
<li class="chapter" data-level="16.6.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#copula-regression"><i class="fa fa-check"></i><b>16.6.2</b> Copula Regression</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec167"><i class="fa fa-check"></i><b>16.7</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#ts-16.a.-other-classic-measures-of-scalar-associations"><i class="fa fa-check"></i>TS 16.A. Other Classic Measures of Scalar Associations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="CAppA.html"><a href="CAppA.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Review of Statistical Inference</a>
<ul>
<li class="chapter" data-level="17.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec171"><i class="fa fa-check"></i><b>17.1</b> Basic Concepts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1711"><i class="fa fa-check"></i><b>17.1.1</b> Random Sampling</a></li>
<li class="chapter" data-level="17.1.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1712"><i class="fa fa-check"></i><b>17.1.2</b> Sampling Distribution</a></li>
<li class="chapter" data-level="17.1.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec1713"><i class="fa fa-check"></i><b>17.1.3</b> Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec172"><i class="fa fa-check"></i><b>17.2</b> Point Estimation and Properties</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1721"><i class="fa fa-check"></i><b>17.2.1</b> Method of Moments Estimation</a></li>
<li class="chapter" data-level="17.2.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1722"><i class="fa fa-check"></i><b>17.2.2</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec173"><i class="fa fa-check"></i><b>17.3</b> Interval Estimation</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1731"><i class="fa fa-check"></i><b>17.3.1</b> Exact Distribution for Normal Sample Mean</a></li>
<li class="chapter" data-level="17.3.2" data-path="CAppA.html"><a href="CAppA.html#large-sample-properties-of-mle"><i class="fa fa-check"></i><b>17.3.2</b> Large-sample Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="17.3.3" data-path="CAppA.html"><a href="CAppA.html#confidence-interval"><i class="fa fa-check"></i><b>17.3.3</b> Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="CAppA.html"><a href="CAppA.html#S:Sec174"><i class="fa fa-check"></i><b>17.4</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1741"><i class="fa fa-check"></i><b>17.4.1</b> Basic Concepts</a></li>
<li class="chapter" data-level="17.4.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1742"><i class="fa fa-check"></i><b>17.4.2</b> Student-<em>t</em> test based on <em>mle</em></a></li>
<li class="chapter" data-level="17.4.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec1743"><i class="fa fa-check"></i><b>17.4.3</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="17.4.4" data-path="CAppA.html"><a href="CAppA.html#S:Sec1744"><i class="fa fa-check"></i><b>17.4.4</b> Information Criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="CAppB.html"><a href="CAppB.html"><i class="fa fa-check"></i><b>18</b> Appendix B: Iterated Expectations</a>
<ul>
<li class="chapter" data-level="18.1" data-path="CAppB.html"><a href="CAppB.html#S:Sec181"><i class="fa fa-check"></i><b>18.1</b> Conditional Distribution and Conditional Expectation</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="CAppB.html"><a href="CAppB.html#conditional-distribution"><i class="fa fa-check"></i><b>18.1.1</b> Conditional Distribution</a></li>
<li class="chapter" data-level="18.1.2" data-path="CAppB.html"><a href="CAppB.html#conditional-expectation-and-conditional-variance"><i class="fa fa-check"></i><b>18.1.2</b> Conditional Expectation and Conditional Variance</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="CAppB.html"><a href="CAppB.html#S:Sec182"><i class="fa fa-check"></i><b>18.2</b> Iterated Expectations and Total Variance</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="CAppB.html"><a href="CAppB.html#S:Sec1821"><i class="fa fa-check"></i><b>18.2.1</b> Law of Iterated Expectations</a></li>
<li class="chapter" data-level="18.2.2" data-path="CAppB.html"><a href="CAppB.html#law-of-total-variance"><i class="fa fa-check"></i><b>18.2.2</b> Law of Total Variance</a></li>
<li class="chapter" data-level="18.2.3" data-path="CAppB.html"><a href="CAppB.html#application"><i class="fa fa-check"></i><b>18.2.3</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="CAppB.html"><a href="CAppB.html#S:Sec183"><i class="fa fa-check"></i><b>18.3</b> Conjugate Distributions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="CAppB.html"><a href="CAppB.html#linear-exponential-family"><i class="fa fa-check"></i><b>18.3.1</b> Linear Exponential Family</a></li>
<li class="chapter" data-level="18.3.2" data-path="CAppB.html"><a href="CAppB.html#S:Sec1832"><i class="fa fa-check"></i><b>18.3.2</b> Conjugate Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="CAppC.html"><a href="CAppC.html"><i class="fa fa-check"></i><b>19</b> Appendix C: Maximum Likelihood Theory</a>
<ul>
<li class="chapter" data-level="19.1" data-path="CAppC.html"><a href="CAppC.html#S:Sec191"><i class="fa fa-check"></i><b>19.1</b> Likelihood Function</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="CAppC.html"><a href="CAppC.html#likelihood-and-log-likelihood-functions"><i class="fa fa-check"></i><b>19.1.1</b> Likelihood and Log-likelihood Functions</a></li>
<li class="chapter" data-level="19.1.2" data-path="CAppC.html"><a href="CAppC.html#properties-of-likelihood-functions"><i class="fa fa-check"></i><b>19.1.2</b> Properties of Likelihood Functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="CAppC.html"><a href="CAppC.html#S:Sec192"><i class="fa fa-check"></i><b>19.2</b> Maximum Likelihood Estimators</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="CAppC.html"><a href="CAppC.html#definition-and-derivation-of-mle"><i class="fa fa-check"></i><b>19.2.1</b> Definition and Derivation of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.2" data-path="CAppC.html"><a href="CAppC.html#asymptotic-properties-of-mle"><i class="fa fa-check"></i><b>19.2.2</b> Asymptotic Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.3" data-path="CAppC.html"><a href="CAppC.html#use-of-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>19.2.3</b> Use of Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="CAppC.html"><a href="CAppC.html#S:Sec193"><i class="fa fa-check"></i><b>19.3</b> Statistical Inference Based on Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="CAppC.html"><a href="CAppC.html#hypothesis-testing"><i class="fa fa-check"></i><b>19.3.1</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="19.3.2" data-path="CAppC.html"><a href="CAppC.html#S:Sec1932"><i class="fa fa-check"></i><b>19.3.2</b> <em>MLE</em> and Model Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html"><i class="fa fa-check"></i><b>20</b> Appendix D: Summary of Distributions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:DiscreteDistributions"><i class="fa fa-check"></i><b>20.1</b> Discrete Distributions</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab0-class"><i class="fa fa-check"></i><b>20.1.1</b> The <em>(a,b,0)</em> Class</a></li>
<li class="chapter" data-level="20.1.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab1-class"><i class="fa fa-check"></i><b>20.1.2</b> The <em>(a,b,1)</em> Class</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:ContinuousDistributions"><i class="fa fa-check"></i><b>20.2</b> Continuous Distributions</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#one-parameter-distributions"><i class="fa fa-check"></i><b>20.2.1</b> One Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#two-parameter-distributions"><i class="fa fa-check"></i><b>20.2.2</b> Two Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#three-parameter-distributions"><i class="fa fa-check"></i><b>20.2.3</b> Three Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.4" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#four-parameter-distribution"><i class="fa fa-check"></i><b>20.2.4</b> Four Parameter Distribution</a></li>
<li class="chapter" data-level="20.2.5" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#other-distributions"><i class="fa fa-check"></i><b>20.2.5</b> Other Distributions</a></li>
<li class="chapter" data-level="20.2.6" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#distributions-with-finite-support"><i class="fa fa-check"></i><b>20.2.6</b> Distributions with Finite Support</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#limited-expected-values"><i class="fa fa-check"></i><b>20.3</b> Limited Expected Values</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html"><i class="fa fa-check"></i><b>21</b> Appendix E: Conventions for Notation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:General"><i class="fa fa-check"></i><b>21.1</b> General Conventions</a></li>
<li class="chapter" data-level="21.2" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Abbreviations"><i class="fa fa-check"></i><b>21.2</b> Abbreviations</a></li>
<li class="chapter" data-level="21.3" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:StatSymbols"><i class="fa fa-check"></i><b>21.3</b> Common Statistical Symbols and Operators</a></li>
<li class="chapter" data-level="21.4" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Symbols"><i class="fa fa-check"></i><b>21.4</b> Common Mathematical Symbols and Functions</a></li>
<li class="chapter" data-level="21.5" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#further-readings"><i class="fa fa-check"></i><b>21.5</b> Further Readings</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="DataResources.html"><a href="DataResources.html"><i class="fa fa-check"></i><b>22</b> Appendix. Data Resources</a>
<ul>
<li class="chapter" data-level="22.1" data-path="DataResources.html"><a href="DataResources.html#S:WiscPropFundA"><i class="fa fa-check"></i><b>22.1</b> Wisconsin Property Fund</a></li>
<li class="chapter" data-level="22.2" data-path="DataResources.html"><a href="DataResources.html#Sec:DataTravel"><i class="fa fa-check"></i><b>22.2</b> ANU Corporate Travel Data</a></li>
<li class="chapter" data-level="22.3" data-path="DataResources.html"><a href="DataResources.html#Sec:DataGPA"><i class="fa fa-check"></i><b>22.3</b> ANU Group Personal Accident Data</a></li>
<li class="chapter" data-level="22.4" data-path="DataResources.html"><a href="DataResources.html#Sec:DataAuto"><i class="fa fa-check"></i><b>22.4</b> ANU Motor Vehicle Data</a></li>
<li class="chapter" data-level="22.5" data-path="DataResources.html"><a href="DataResources.html#spanish-personal-insurance-data"><i class="fa fa-check"></i><b>22.5</b> Spanish Personal Insurance Data</a></li>
<li class="chapter" data-level="22.6" data-path="DataResources.html"><a href="DataResources.html#S:CASDatasets"><i class="fa fa-check"></i><b>22.6</b> ‘R’ Package CASdatasets</a></li>
<li class="chapter" data-level="22.7" data-path="DataResources.html"><a href="DataResources.html#other-data-sources"><i class="fa fa-check"></i><b>22.7</b> Other Data Sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/OpenActTexts/LDAVer2" target="blank">Loss Data Analytics on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Loss Data Analytics <br> Second Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ChapSimulation" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Simulation and Resampling<a href="ChapSimulation.html#ChapSimulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Chapter Preview.</em> Simulation is a computationally intensive method used to solve difficult problems. Instead of creating physical processes and experimenting with them in order to understand their operational characteristics, a simulation study is based on a computer representation - it considers various hypothetical conditions as inputs and summarizes the results. Through simulation, a vast number of hypothetical conditions can be quickly and inexpensively examined. Section <a href="ChapSimulation.html#S:Sec81">8.1</a> introduces simulation as a valuable computational tool, particularly effective in complex, multivariate settings.</p>
<p>Analysts find simulation especially useful for computing measures that summarize intricate distributions, as discussed in Section <a href="ChapSimulation.html#S:Sec82">8.2</a>. This encompasses all the examples mentioned in the book thus far, such as measures that summarize the frequency and severity of losses, along with many additional cases. Simulation can also be used to compute complex distributions necessary for hypothesis testing. In addition, we can also use simulation to draw from an empirical distribution - this process is known as <em>resampling</em>. Resampling allows us to assess the uncertainty of estimates in complex models. Section <a href="ChapSimulation.html#S:Sec83">8.3</a> introduces resampling in the context of bootstrapping to determine the precision of estimators. Section <a href="ChapSimulation.html#S:Sec84">8.4</a> on cross-validation shows how to use it for model selection and validation.</p>
<div id="S:Sec81" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Random Number Generation<a href="ChapSimulation.html#S:Sec81" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Generate approximately independent realizations that are uniformly distributed</li>
<li>Transform the uniformly distributed realizations to observations
from a probability distribution of interest</li>
<li>Generate simulated values directly from common distributions using ready-made random number generators</li>
<li>Generate simulated values from complex distributions by combining simulated values from common distributions</li>
<li>Generate simulated values from distributions whose domain is restricted to specific regions of interest, such as with deductible and long-tailed actuarial applications.</li>
</ul>
<hr />
<div id="S:Sec811" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Generating Independent Uniform Observations<a href="ChapSimulation.html#S:Sec811" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="#" class="tooltip" style="color:green"><em>simulations</em><span style="font-size:8pt">A computer generation of various hypothetical conditions and outputs, based on the model structure provided</span></a> that we consider are generated by computers. A major strength of this approach is that they can be replicated, allowing us to check and improve our work. Naturally, this also means that they are not really random. Nonetheless, algorithms have been produced so that results appear to be random for all practical purposes. Specifically, they pass sophisticated tests of independence and can be designed so that they come from a single distribution - our <a href="#" class="tooltip" style="color:green"><em>iid</em><span style="font-size:8pt">Independent and identically distributed</span></a> assumption, identically and independently distributed.</p>
<p>To get a sense as to what these algorithms do, we consider a historically prominent method.</p>
<p><strong>Linear Congruential Generator.</strong> To generate a sequence of random numbers, start with <span class="math inline">\(B_0\)</span>, a starting value that is known as a <em>seed</em>. This value is updated using the recursive relationship
<span class="math display">\[
B_{n+1} = (a B_n + c)  \text{ modulo }m, ~~ n=0, 1, 2, \ldots .
\]</span>
This algorithm is called a <a href="#" class="tooltip" style="color:green"><em>linear congruential generator</em><span style="font-size:8pt">Algorithm that yields pseudo-randomized numbers calculated using a linear recursive relationship and a starting seed value</span></a>. The case of <span class="math inline">\(c=0\)</span> is called a <em>multiplicative</em> congruential generator; it is
particularly useful for really fast computations.</p>
<p>For illustrative values of <span class="math inline">\(a\)</span> and <span class="math inline">\(m\)</span>, Microsoft’s Visual Basic uses <span class="math inline">\(m=2^{24}\)</span>, <span class="math inline">\(a=1,140,671,485\)</span>, and <span class="math inline">\(c = 12,820,163\)</span> (see
<a href="https://en.wikipedia.org/wiki/Linear_congruential_generator" class="uri">https://en.wikipedia.org/wiki/Linear_congruential_generator</a>). This is the engine underlying the random number generation in Microsoft’s Excel program.</p>
<p>The sequence used by the analyst is defined as <span class="math inline">\(U_n=B_n/m.\)</span> The analyst
may interpret the sequence {<span class="math inline">\(U_{i}\)</span>} to be (approximately) identically
and independently uniformly distributed on the interval (0,1). To
illustrate the algorithm, consider the following.</p>
<p><strong>Example 8.1.1. Illustrative Sequence.</strong>
Take <span class="math inline">\(m=15\)</span>, <span class="math inline">\(a=3\)</span>, <span class="math inline">\(c=2\)</span> and <span class="math inline">\(B_0=1\)</span>. Then we have:</p>
<table>
<thead>
<tr class="header">
<th align="center">step <span class="math inline">\(n\)</span></th>
<th align="left"><span class="math inline">\(B_n\)</span></th>
<th align="center"><span class="math inline">\(U_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="left"><span class="math inline">\(B_0=1\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="left"><span class="math inline">\(B_1 =\mod(3 \times 1 +2) = 5\)</span></td>
<td align="center"><span class="math inline">\(U_1 = \frac{5}{15}\)</span></td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="left"><span class="math inline">\(B_2 =\mod(3 \times 5 +2) = 2\)</span></td>
<td align="center"><span class="math inline">\(U_2 = \frac{2}{15}\)</span></td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="left"><span class="math inline">\(B_3 =\mod(3 \times 2 +2) = 8\)</span></td>
<td align="center"><span class="math inline">\(U_3 = \frac{8}{15}\)</span></td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="left"><span class="math inline">\(B_4 =\mod(3 \times 8 +2) = 11\)</span></td>
<td align="center"><span class="math inline">\(U_4 = \frac{11}{15}\)</span></td>
</tr>
</tbody>
</table>
<p>The linear congruential generator is just one method of producing pseudo-random outcomes. It is easy to understand and is widely used. The linear congruential generator does have limitations, including the fact that it is possible to detect long-run patterns over time in the sequences generated (recall that we can interpret <em>independence</em> to mean a total lack of functional patterns). Not surprisingly, advanced techniques have been developed that address some of this method’s drawbacks. The random number generated by <code>R</code> utilizes such advanced techniques.</p>
<p>Sometimes computer generated random results are known as <a href="#" class="tooltip" style="color:green"><em>pseudo-random numbers</em><span style="font-size:8pt">Values that appear random but can be replicated by formula</span></a> to reflect the fact that they are machine generated and can be replicated. That is, despite the fact that {<span class="math inline">\(U_{i}\)</span>} appears to be
i.i.d, it can be reproduced by using the same seed number (and the same
algorithm).</p>
<p><a id=Ex:8.1.2></a></p>
<p><strong><span id="Ex:8.1.2">Example 8.1.2</span>. Generating Uniform Random Numbers in <code>R</code>.</strong>
The following code shows how to generate three uniform (0,1) numbers in <code>R</code> using the <code>runif</code> command. The <code>set.seed()</code> function sets the initial seed. In many computer packages, the initial seed is set using the system clock unless specified otherwise.</p>
<div id="three-uniform-random-variates" class="section level5 unnumbered hasAnchor">
<h5>Three Uniform Random Variates<a href="ChapSimulation.html#three-uniform-random-variates" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ChapSimulation.html#cb79-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb79-2"><a href="ChapSimulation.html#cb79-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb79-3"><a href="ChapSimulation.html#cb79-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(U, <span class="at">digits =</span> <span class="dv">5</span>, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">col.names =</span> <span class="st">&quot;Uniform&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="ChapSimulation.html#cb79-4" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="ChapSimulation.html#cb79-5" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>, <span class="at">font_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<table class=" lightable-classic table" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Uniform
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.92424
</td>
</tr>
<tr>
<td style="text-align:center;">
0.53718
</td>
</tr>
<tr>
<td style="text-align:center;">
0.46920
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="S:Sec812" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Inverse Transform Method<a href="ChapSimulation.html#S:Sec812" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the sequence of uniform random numbers, we next transform them to a distribution of interest, say <span class="math inline">\(F\)</span>. A prominent technique is the <a href="#" class="tooltip" style="color:green"><em>inverse transform method</em><span style="font-size:8pt">Samples a uniform number between 0 and 1 to represent the randomly selected percentile, then uses the inverse of the cumulative density function of the desired distribution to simulate from in order to find the simulated value from the desired distribution</span></a>, defined as
<span class="math display">\[
X_i=F^{-1}\left( U_i \right) .
\]</span>
Here, recall from Section 4.1.1 that we introduced the inverse of the distribution function, <span class="math inline">\(F^{-1}\)</span>, and referred to it also as the <a href="#" class="tooltip" style="color:green"><em>quantile function</em><span style="font-size:8pt">Inverse function for the cumulative density function which takes a percentile value in [0,1] as the input, and outputs the corresponding value in the distribution</span></a>. Specifically, it is defined to be
<span class="math display">\[
F^{-1}(y) = \inf_x ~ \{ F(x) \ge y \} .
\]</span>
Recall that <span class="math inline">\(\inf\)</span> stands for <em>infimum</em> or the <a href="#" class="tooltip" style="color:green"><em>greatest lower bound</em><span style="font-size:8pt">Largest value that is less than or equal to a specified subset of values/elements</span></a>. It is essentially the smallest value of <em>x</em> that satisfies the inequality <span class="math inline">\(\{F(x) \ge y\}\)</span>. The result is that the sequence {<span class="math inline">\(X_{i}\)</span>} is <em>iid</em> with distribution function <span class="math inline">\(F\)</span> if the {<span class="math inline">\(U_i\)</span>} are <em>iid</em> with uniform on <span class="math inline">\((0,1)\)</span> distribution function.</p>
<p>The inverse transform result is available when the underlying random variable is continuous, discrete or a hybrid combination of the two. We now present a series of examples to illustrate its scope of applications.</p>
<p><a id=Ex:8.1.3></a></p>
<p><strong><span id="Ex:8.1.3">Example 8.1.3</span>. Generating Exponential Random Numbers.</strong>
Suppose that we would like to generate observations from an exponential distribution with scale
parameter <span class="math inline">\(\theta\)</span> so that <span class="math inline">\(F(x) = 1 - e^{-x/\theta}\)</span>. To compute the
inverse transform, we can use the following steps:
<span class="math display">\[
\begin{aligned}
y = F(x) &amp;\Leftrightarrow  y = 1-e^{-x/\theta} \\
  &amp;\Leftrightarrow -\theta \ln(1-y) = x = F^{-1}(y) .
\end{aligned}
\]</span>
Thus, if <span class="math inline">\(U\)</span> has a uniform (0,1) distribution, then <span class="math inline">\(X = -\theta \ln(1-U)\)</span> has an exponential distribution with parameter <span class="math inline">\(\theta\)</span>.</p>
<p>The following <code>R</code> code shows how we can start with the same three uniform random numbers as in <a href="ChapSimulation.html#Ex:8.1.2">Example 8.1.2</a> and transform them to independent exponentially distributed random variables with a mean of 10. Alternatively, you can directly use the <code>rexp</code> function in <code>R</code> to generate random numbers from the exponential distribution. The algorithm built into this routine is different so even with the same starting seed number, individual realizations will differ.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="ChapSimulation.html#cb80-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb80-2"><a href="ChapSimulation.html#cb80-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb80-3"><a href="ChapSimulation.html#cb80-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U)</span>
<span id="cb80-4"><a href="ChapSimulation.html#cb80-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb80-5"><a href="ChapSimulation.html#cb80-5" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<div id="three-uniform-random-variates-1" class="section level5 unnumbered hasAnchor">
<h5>Three Uniform Random Variates<a href="ChapSimulation.html#three-uniform-random-variates-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<table class=" lightable-classic table" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Uniform
</th>
<th style="text-align:center;">
Exponential 1
</th>
<th style="text-align:center;">
Exponential 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.92424
</td>
<td style="text-align:center;">
25.80219
</td>
<td style="text-align:center;">
3.25222
</td>
</tr>
<tr>
<td style="text-align:center;">
0.53718
</td>
<td style="text-align:center;">
7.70409
</td>
<td style="text-align:center;">
8.47652
</td>
</tr>
<tr>
<td style="text-align:center;">
0.46920
</td>
<td style="text-align:center;">
6.33362
</td>
<td style="text-align:center;">
5.40176
</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Example 8.1.4. Generating Pareto Random Numbers.</strong>
Suppose that we would like to generate observations from a Pareto distribution with parameters <span class="math inline">\(\alpha\)</span> and
<span class="math inline">\(\theta\)</span> so that <span class="math inline">\(F(x) = 1 - \left(\frac{\theta}{x+\theta} \right)^{\alpha}\)</span>. To compute
the inverse transform, we can use the following steps:
<span class="math display">\[
\begin{aligned}
y = F(x) &amp;\Leftrightarrow 1-y = \left(\frac{\theta}{x+\theta} \right)^{\alpha} \\
  &amp;\Leftrightarrow \left(1-y\right)^{-1/\alpha} = \frac{x+\theta}{\theta} = \frac{x}{\theta} +1 \\
    &amp;\Leftrightarrow \theta \left((1-y)^{-1/\alpha} - 1\right) = x = F^{-1}(y) .\end{aligned}
\]</span>
Thus, <span class="math inline">\(X = \theta \left((1-U)^{-1/\alpha} - 1\right)\)</span> has a Pareto distribution with parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\theta\)</span>.</p>
<hr />
<p><strong>Inverse Transform Justification.</strong> Why does the random variable <span class="math inline">\(X = F^{-1}(U)\)</span> have a distribution function <span class="math inline">\(F\)</span>?</p>
<h5 style="text-align: center;">
<a id="displayExample.Snippet.Hide" href="javascript:toggleEX('toggleExample.Snippet.Hide','displayExample.Snippet.Hide');"><i><strong>Show A Snippet of Theory</strong></i></a>
</h5>
<div id="toggleExample.Snippet.Hide" style="display: none">
<hr />
<p>This is easy to establish when <span class="math inline">\(F\)</span> is strictly increasing, where the distribution is continuous. Because <span class="math inline">\(U\)</span> is a uniform random variable on (0,1), we know that <span class="math inline">\(\Pr(U \le y) = y\)</span>, for <span class="math inline">\(0 \le y \le 1\)</span>. Thus,
<span class="math display">\[
\begin{aligned}
\Pr[X \le x] &amp;= \Pr[F^{-1}(U) \le x] \\
&amp;= \Pr[F(F^{-1}(U)) \le F(x)] \\
&amp;= \Pr[U \le F(x)] = F(x),
\end{aligned}
\]</span>
as required. The key step is that <span class="math inline">\(F[F^{-1}(u)] = u\)</span> for each <span class="math inline">\(u\)</span>, which is true when <span class="math inline">\(F\)</span> is strictly increasing.</p>
<hr />
</div>
<p>We now consider some discrete examples.</p>
<p><strong>Example 8.1.5. Generating Bernoulli Random Numbers.</strong>
Suppose that we wish to simulate random variables from a Bernoulli distribution with parameter <span class="math inline">\(q=0.85\)</span>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig81"></span>
<img src="LDAEd2_files/figure-html/Fig81-1.png" alt="Distribution Function of a Binary Random Variable" width="50%" />
<p class="caption">
Figure 8.1: <strong>Distribution Function of a Binary Random Variable</strong>
</p>
</div>
<p>A graph of the cumulative distribution function in Figure <a href="ChapSimulation.html#fig:Fig81">8.1</a> shows that the quantile function can be written as
<span class="math display">\[
\begin{aligned}
F^{-1}(y) = \left\{ \begin{array}{cc}
              0 &amp; 0&lt;y \leq 0.85 \\
              1 &amp; 0.85 &lt; y  \leq  1.0 .
            \end{array} \right.
\end{aligned}
\]</span>
Thus, with the inverse transform we may define
<span class="math display">\[
\begin{aligned}
X = \left\{ \begin{array}{cc}
              0 &amp; 0&lt;U \leq 0.85  \\
              1 &amp;  0.85 &lt; U  \leq  1.0
            \end{array} \right.
\end{aligned}
\]</span>
For illustration, we generate three random numbers to get</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="ChapSimulation.html#cb81-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb81-2"><a href="ChapSimulation.html#cb81-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>)</span>
<span id="cb81-3"><a href="ChapSimulation.html#cb81-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (U <span class="sc">&gt;</span> <span class="fl">0.85</span>)</span></code></pre></div>
</div>
<div id="three-random-variates" class="section level5 unnumbered hasAnchor">
<h5>Three Random Variates<a href="ChapSimulation.html#three-random-variates" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<table class=" lightable-classic table" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Uniform
</th>
<th style="text-align:center;">
Binary X
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.92424
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
0.53718
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.46920
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Example 8.1.6. Generating Random Numbers from a Discrete Distribution.</strong>
Consider the time of a machine failure in the first five years. The distribution of failure times is
given as:</p>
</div>
<div id="discrete-distribution" class="section level5 unnumbered hasAnchor">
<h5>Discrete Distribution<a href="ChapSimulation.html#discrete-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<table class=" lightable-classic table" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Time
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
2.0
</td>
<td style="text-align:center;">
3.0
</td>
<td style="text-align:center;">
4.0
</td>
<td style="text-align:center;">
5.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Probability
</td>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Distribution Function
</td>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.8
</td>
<td style="text-align:center;">
1.0
</td>
</tr>
</tbody>
</table>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig82"></span>
<img src="LDAEd2_files/figure-html/Fig82-1.png" alt="Distribution Function of a Discrete Random Variable" width="60%" />
<p class="caption">
Figure 8.2: <strong>Distribution Function of a Discrete Random Variable</strong>
</p>
</div>
<p>Using the graph of the distribution function in Figure <a href="ChapSimulation.html#fig:Fig82">8.2</a>, with the inverse transform we may define
<span class="math display">\[
\small{
\begin{aligned}
X = \left\{ \begin{array}{cc}
              1 &amp;   0&lt;U  \leq 0.1  \\
              2 &amp;  0.1 &lt; U  \leq  0.3\\
              3 &amp;  0.3 &lt; U  \leq  0.4\\
              4 &amp;  0.4 &lt; U  \leq  0.8  \\
              5 &amp;  0.8 &lt; U  \leq  1.0     .
            \end{array} \right.
\end{aligned}
}
\]</span></p>
<hr />
<p>For general discrete random variables there may not be an ordering of
outcomes. For example, a person could own one of five types of life
insurance products and we might use the following algorithm to generate
random outcomes:
<span class="math display">\[
{\small
\begin{aligned}
X = \left\{ \begin{array}{cc}
  \textrm{whole life} &amp;   0&lt;U  \leq 0.1  \\
\textrm{endowment} &amp;  0.1 &lt; U  \leq  0.3\\
\textrm{term life} &amp;  0.3 &lt; U  \leq  0.4\\
  \textrm{universal life} &amp;  0.4 &lt; U  \leq  0.8  \\
  \textrm{variable life} &amp;  0.8 &lt; U  \leq  1.0 .
            \end{array} \right.
\end{aligned}
}
\]</span>
Another analyst may use an alternative procedure such as:
<span class="math display">\[
{\small
\begin{aligned}
X = \left\{ \begin{array}{cc}
  \textrm{whole life} &amp;   0.9&lt;U&lt;1.0  \\
\textrm{endowment} &amp;  0.7 \leq U &lt; 0.9\\
\textrm{term life} &amp;  0.6 \leq U &lt; 0.7\\
  \textrm{universal life} &amp;  0.2 \leq U &lt; 0.6  \\
  \textrm{variable life} &amp;  0 \leq U &lt; 0.2 .
            \end{array} \right.
\end{aligned}
}
\]</span>
Both algorithms produce (in the long-run) the same probabilities, e.g., <span class="math inline">\(\Pr(\textrm{whole life})=0.1\)</span>, and so forth. So, neither is incorrect. You should be aware that there is more than one way to accomplish a goal. Similarly, you could use an alternative algorithm for ordered outcomes (such as failure times 1, 2, 3, 4, or 5, above).</p>
</div>
</div>
<div id="S:Sec813" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Ready-made Random Number Generators<a href="ChapSimulation.html#S:Sec813" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sections <a href="ChapSimulation.html#S:Sec811">8.1.1</a> and <a href="ChapSimulation.html#S:Sec812">8.1.2</a> showed how one can generate simulated values from the foundations. This approach is important so that analyst can appreciate why the simulation works so well. However, because simulation is used so widely, it is not surprising that packages have been developed as time-saving devices.</p>
<p>For example, we have already seen in <a href="ChapSimulation.html#Ex:8.1.3">Example 8.1.3</a> that one can generate exponentially distributed random variates through the <code>rexp</code> function. This function means that analyst need not generate uniform random variates and then transform them using the inverse exponential distribution function. Instead, this is done in a single step using the <code>rexp</code> function.</p>
<p><a href="ChapSimulation.html#tab:8.2">Table 8.2</a> summarizes a few of the standard random number generators in <code>R</code>; the <strong>r</strong> at the beginning of each function refers to a <strong>r</strong>andom number generator. Additional documentation for these functions are in Appendix Chapter <a href="ChapSummaryDistributions.html#ChapSummaryDistributions">20</a>. Note that the Pareto distribution requires the package <code>actuar</code>.</p>
<p><a id=tab:8.2></a></p>
<p><span id="tab:8.2">Table 8.2</span>. <strong>Random Number Generators (RNGs)</strong></p>
<p><span class="math display">\[
{\small
\begin{array}{ll|ll}
\hline
\textbf{Discrete Distributions} &amp;
&amp;\textbf{Continuous  Distributions} &amp; \\
\textit{Distribution}&amp; \textit{RNG Function}&amp;
\textit{Distribution}&amp; \textit{RNG Function}\\
\hline
\text{Binomial}&amp; \text{rbinom}  &amp;\text{Exponential}&amp; \text{rexp}\\
\text{Poisson} &amp; \text{rpoisson}&amp;\text{Gamma}      &amp; \text{rgamma}\\
\text{Negative Binomial}&amp; \text{rnbinom} &amp; \text{Pareto}&amp; \text{actuar::rpareto}\\
&amp; &amp;\text{Normal}&amp; \text{rnorm}\\
&amp; &amp;\text{Weibull}&amp; \text{rweibull}\\
\hline
\end{array}
}
\]</span></p>
</div>
<div id="S:Sec814" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Simulating from Complex Distributions<a href="ChapSimulation.html#S:Sec814" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In statistical software programs such as <code>R</code>, analysts will find several ready-made random number generators. However, for many complex actuarial applications, it is likely that ready-made generators will not be available and so one must return to the foundations.</p>
<p>To illustrate, consider the aggregate claims distributions introduced in Chapter <a href="ChapAggLossModels.html#ChapAggLossModels">7</a>. There, in Section <a href="ChapAggLossModels.html#S:Sec742">7.4.2</a>, we have already seen how to simulate aggregate loss distributions. As we saw in [Example 7.4.2], the process is to first simulate the number of losses and then simulate individual losses.</p>
<p>As another example of a complex distribution, consider the following example.</p>
<p><strong>Example 8.1.7. Generating Random Numbers from a Hybrid Distribution.</strong>
Consider a random variable that is 0 with probability 70% and is exponentially distributed with parameter <span class="math inline">\(\theta= 10,000\)</span> with probability 30%. In an insurance application, this might correspond to a 70% chance of having no insurance claims and a 30% chance of a claim - if a claim occurs, then it is exponentially distributed. The distribution function, depicted in Figure <a href="ChapSimulation.html#fig:Fig83">8.3</a>, is given as
<span class="math display">\[
\begin{aligned}
F(y) = \left\{ \begin{array}{cc}
              0                      &amp;  x&lt;0  \\
              1 - 0.3 \exp(-x/10000) &amp; x \ge 0 .
            \end{array} \right.
\end{aligned}
\]</span></p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig83"></span>
<img src="LDAEd2_files/figure-html/Fig83-1.png" alt="Distribution Function of a Hybrid Random Variable" width="60%" />
<p class="caption">
Figure 8.3: <strong>Distribution Function of a Hybrid Random Variable</strong>
</p>
</div>
<p>From Figure <a href="ChapSimulation.html#fig:Fig83">8.3</a>, we can see that the inverse transform for generating random variables with this distribution function is
<span class="math display">\[
\begin{aligned}
X = F^{-1}(U) = \left\{ \begin{array}{cc}
              0 &amp;  0&lt; U  \leq  0.7  \\
              -1000 \ln (\frac{1-U}{0.3}) &amp; 0.7 &lt; U &lt; 1 .
            \end{array} \right.
\end{aligned}
\]</span>
For discrete and hybrid random variables, the key is to draw a graph of the distribution function that allows you to visualize potential values of the inverse function.</p>
<hr />
<p>You can think of this hybrid distribution as a special case of a mixture model that was introduced in Sections <a href="ChapFrequency-Modeling.html#S:Sec36">3.6</a> and <a href="ChapSeverity.html#S:Sec432">4.3.2</a>. Mixture models are straight-forward to evaluate using simulation. In the first stage, one simulates a variable indicating the subpopulation. In the second stage, one simulates from that subpopulation. The resulting variate is a realization from the mixture model. To illustrate, let’s revisit <a href="./ChapSeverity.html#Ex:4.3.5">Example 4.3.5</a>.</p>
<p><strong>Example 4.3.5. Continued.</strong> In this problem, we can label draws from the Type 1 subpopulation as <span class="math inline">\(X_1\)</span> from an exponential distribution with mean 200, and those from the Type 2 subpopulation as <span class="math inline">\(X_2\)</span> from a Pareto distribution with parameters <span class="math inline">\(\alpha=3\)</span> and <span class="math inline">\(\theta=200\)</span>. Here, 25% of policies are Type 1 and 75% of policies are Type 2.</p>
<p>We can use simulation to find the probability that the annual loss will be less than 100, and find the average loss. The illustrative code uses the ready-made random number generator functions <code>rbinom</code>, <code>rexp</code>, and <code>actuar::pareto</code>.</p>
<h5 style="text-align: center;">
<a id="displayCode.Example4.3.5.Continued" href="javascript:togglecode('toggleCode.Example4.3.5.Continued','displayCode.Example4.3.5.Continued');"><i><strong>Show R Code for Example 4.3.5 Continued</strong></i></a>
</h5>
<div id="toggleCode.Example4.3.5.Continued" style="display: none">
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="ChapSimulation.html#cb82-1" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb82-2"><a href="ChapSimulation.html#cb82-2" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(nsim, <span class="at">prob =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb82-3"><a href="ChapSimulation.html#cb82-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(nsim, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>)</span>
<span id="cb82-4"><a href="ChapSimulation.html#cb82-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> actuar<span class="sc">::</span><span class="fu">rpareto</span>(nsim, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">200</span>)</span>
<span id="cb82-5"><a href="ChapSimulation.html#cb82-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">*</span> X1 <span class="sc">+</span> Z <span class="sc">*</span> X2</span>
<span id="cb82-6"><a href="ChapSimulation.html#cb82-6" tabindex="-1"></a><span class="co"># sum(X&lt;100)/nsim mean(X)</span></span></code></pre></div>
</div>
</div>
<div id="S:Sec815" class="section level3 hasAnchor" number="8.1.5">
<h3><span class="header-section-number">8.1.5</span> Importance Sampling<a href="ChapSimulation.html#S:Sec815" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another class of important problems utilize distributions that are from a limited region. For example, when a loss has a deductible, the resulting claim represents the payment by an insurer that is not observed for amounts less than the deductible. This type of problem was considered extensively in Chapter <a href="ChapClaimSeverity.html#ChapClaimSeverity">5</a>. As another example, for claims that are extremely large, one may wish to restrict an analysis to only extremely large outcomes - discussions of <em>tails</em> of distributions will be taken up in Section <a href="ChapPortMgt.html#S:Sec132">13.2</a>. To address both types of problems, we now suppose that we wish to draw according to <span class="math inline">\(X\)</span>, conditional on <span class="math inline">\(X\in[a,b]\)</span>.</p>
<p>To this end, one can use an <a href="#" class="tooltip" style="color:green"><em>accept-reject mechanism</em><span style="font-size:8pt">A sampling method that is used where the random sample is discarded if not within a certain pre-specified range [a, b] and is commonly used when the traditional inverse transform method cannot be easily used</span></a> : draw <span class="math inline">\(x\)</span> from distribution <span class="math inline">\(F\)</span></p>
<ul>
<li>if <span class="math inline">\(x\in[a,b]\)</span> : keep it (“<em>accept</em>”)</li>
<li>if <span class="math inline">\(x\notin[a,b]\)</span> : draw another one (“<em>reject</em>”)</li>
</ul>
<p>Observe that from <span class="math inline">\(n\)</span> values initially generated, we keep here only <span class="math inline">\([F(b)-F(a)]\cdot n\)</span> draws, on average.</p>
<p><strong>Example 8.1.8. Draws from a Normal Distribution.</strong> Suppose that we draw from a normal distribution with mean 2.5 and variance 1, <span class="math inline">\(N(2.5,1)\)</span>, but are only interested in draws greater that <span class="math inline">\(a = 2\)</span> and less than <span class="math inline">\(b = 4\)</span>. That is, we can only use <span class="math inline">\(F(4)-F(2) = \Phi(4-2.5)-\Phi(2-2.5)\)</span> = 0.9332 - 0.3085 = 0.6247 proportion of the draws. Figure <a href="ChapSimulation.html#fig:Fig84">8.4</a> demonstrates that some draws lie with the interval <span class="math inline">\((2,4)\)</span> and some are outside.</p>
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.1" href="javascript:togglecode('toggleCode.ImportanceSampling.1','displayCode.ImportanceSampling.1');"><i><strong>Show R Code for Accept-Reject Mechanism</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.1" style="display: none">
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="ChapSimulation.html#cb83-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb83-2"><a href="ChapSimulation.html#cb83-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3"><a href="ChapSimulation.html#cb83-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-4"><a href="ChapSimulation.html#cb83-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb83-5"><a href="ChapSimulation.html#cb83-5" tabindex="-1"></a>Fa <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(a, mu, sigma)</span>
<span id="cb83-6"><a href="ChapSimulation.html#cb83-6" tabindex="-1"></a>Fb <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(b, mu, sigma)</span>
<span id="cb83-7"><a href="ChapSimulation.html#cb83-7" tabindex="-1"></a>pic_ani <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb83-8"><a href="ChapSimulation.html#cb83-8" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb83-9"><a href="ChapSimulation.html#cb83-9" tabindex="-1"></a>    <span class="fu">plot</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb83-10"><a href="ChapSimulation.html#cb83-10" tabindex="-1"></a>    <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb83-11"><a href="ChapSimulation.html#cb83-11" tabindex="-1"></a>    <span class="fu">rect</span>(a, Fa, b, Fb, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb83-12"><a href="ChapSimulation.html#cb83-12" tabindex="-1"></a>    <span class="fu">lines</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb83-13"><a href="ChapSimulation.html#cb83-13" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(a, b), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb83-14"><a href="ChapSimulation.html#cb83-14" tabindex="-1"></a>    ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb83-15"><a href="ChapSimulation.html#cb83-15" tabindex="-1"></a>    clr <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb83-16"><a href="ChapSimulation.html#cb83-16" tabindex="-1"></a>    <span class="cf">if</span> ((<span class="fu">qnorm</span>(ru, mu, sigma) <span class="sc">&gt;=</span> a) <span class="sc">&amp;</span> (<span class="fu">qnorm</span>(ru, mu, sigma) <span class="sc">&lt;=</span> b)) {</span>
<span id="cb83-17"><a href="ChapSimulation.html#cb83-17" tabindex="-1"></a>        clr <span class="ot">&lt;-</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb83-18"><a href="ChapSimulation.html#cb83-18" tabindex="-1"></a>    }</span>
<span id="cb83-19"><a href="ChapSimulation.html#cb83-19" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>, ru, <span class="fu">qnorm</span>(ru, mu, sigma), ru, <span class="at">col =</span> clr, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb83-20"><a href="ChapSimulation.html#cb83-20" tabindex="-1"></a>    <span class="fu">arrows</span>(<span class="fu">qnorm</span>(ru, mu, sigma), ru, <span class="fu">qnorm</span>(ru, mu, sigma), <span class="dv">0</span>, <span class="at">col =</span> clr, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb83-21"><a href="ChapSimulation.html#cb83-21" tabindex="-1"></a>        <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb83-22"><a href="ChapSimulation.html#cb83-22" tabindex="-1"></a>}</span></code></pre></div>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig84"></span>
<img src="LDAEd2_files/figure-html/Fig84-.gif" alt="Demonstration of Draws In and Outside of (2,4)" width="50%" />
<p class="caption">
Figure 8.4: <strong>Demonstration of Draws In and Outside of (2,4)</strong>
</p>
</div>
<hr />
<p>Instead, one can draw according to the conditional distribution <span class="math inline">\(F^{\star}\)</span> defined as
<span class="math display">\[
F^{\star}(x) = \Pr(X \le x | a &lt; X \le b) =\frac{F(x)-F(a)}{F(b)-F(a)}, \ \  \ \text{for } a &lt; x \le b .
\]</span>
Using the inverse transform method in Section <a href="ChapSimulation.html#S:Sec812">8.1.2</a>, we have that the draw
<span class="math display">\[
X^\star=F^{\star-1}\left( U \right) = F^{-1}\left(F(a)+U\cdot[F(b)-F(a)]\right)
\]</span>
has distribution <span class="math inline">\(F^{\star}\)</span>. Expressed another way, define
<span class="math display">\[
\tilde{U} = (1-U)\cdot F(a)+U\cdot F(b)
\]</span>
and then use <span class="math inline">\(F^{-1}(\tilde{U})\)</span>. With this approach, each draw counts.</p>
<p>This can be related to the <a href="#" class="tooltip" style="color:green"><em>importance sampling mechanism</em><span style="font-size:8pt">Type of sampling method where values in the region of interest can be over-sampled or values outside the region of interest can be under-sampled</span></a> : we draw more frequently in regions where we expect to have quantities that have some interest. This transform can be considered as a “a change of measure.”</p>
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.2" href="javascript:togglecode('toggleCode.ImportanceSampling.2','displayCode.ImportanceSampling.2');"><i><strong>Show R Code for Importance Sampling by the Inverse Transform Method</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.2" style="display: none">
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="ChapSimulation.html#cb84-1" tabindex="-1"></a>pic_ani <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb84-2"><a href="ChapSimulation.html#cb84-2" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb84-3"><a href="ChapSimulation.html#cb84-3" tabindex="-1"></a>    <span class="fu">plot</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb84-4"><a href="ChapSimulation.html#cb84-4" tabindex="-1"></a>    <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb84-5"><a href="ChapSimulation.html#cb84-5" tabindex="-1"></a>    <span class="fu">rect</span>(a, Fa, b, Fb, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb84-6"><a href="ChapSimulation.html#cb84-6" tabindex="-1"></a>    <span class="fu">lines</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb84-7"><a href="ChapSimulation.html#cb84-7" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">pnorm</span>(<span class="fu">c</span>(a, b), mu, sigma), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb84-8"><a href="ChapSimulation.html#cb84-8" tabindex="-1"></a>    ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb84-9"><a href="ChapSimulation.html#cb84-9" tabindex="-1"></a>    rutilde <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> ru) <span class="sc">*</span> Fa <span class="sc">+</span> ru <span class="sc">*</span> Fb</span>
<span id="cb84-10"><a href="ChapSimulation.html#cb84-10" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>, rutilde, <span class="fu">qnorm</span>(rutilde, mu, sigma), rutilde, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb84-11"><a href="ChapSimulation.html#cb84-11" tabindex="-1"></a>    <span class="fu">arrows</span>(<span class="fu">qnorm</span>(rutilde, mu, sigma), rutilde, <span class="fu">qnorm</span>(rutilde, mu, sigma), <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb84-12"><a href="ChapSimulation.html#cb84-12" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb84-13"><a href="ChapSimulation.html#cb84-13" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><img src="LDAEd2_files/figure-html/unnamed-chunk-116-.gif" width="50%" style="display: block; margin: auto;" /></p>
In Example 8.1.8, the inverse of the normal distribution is readily available (in <code>R</code>, the function is <code>qnorm</code>). However, for other applications, this is not always the case. Then, one simply uses numerical methods to determine <span class="math inline">\(X^\star\)</span> as the solution of the equation <span class="math inline">\(F(X^\star) =\tilde{U}\)</span> where <span class="math inline">\(\tilde{U}=(1-U)\cdot F(a)+U\cdot F(b)\)</span>.
<h5 style="text-align: center;">
<a id="displayCode.ImportanceSampling.3" href="javascript:togglecode('toggleCode.ImportanceSampling.3','displayCode.ImportanceSampling.3');"><i><strong>Show R Code for Importance Sampling via Numerical Solutions</strong></i></a>
</h5>
<div id="toggleCode.ImportanceSampling.3" style="display: none">
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="ChapSimulation.html#cb85-1" tabindex="-1"></a>pic_ani <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb85-2"><a href="ChapSimulation.html#cb85-2" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb85-3"><a href="ChapSimulation.html#cb85-3" tabindex="-1"></a>    <span class="fu">plot</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb85-4"><a href="ChapSimulation.html#cb85-4" tabindex="-1"></a>    <span class="fu">rect</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb85-5"><a href="ChapSimulation.html#cb85-5" tabindex="-1"></a>    <span class="fu">rect</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb85-6"><a href="ChapSimulation.html#cb85-6" tabindex="-1"></a>    <span class="fu">lines</span>(u, <span class="fu">pnorm</span>(u, mu, sigma), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb85-7"><a href="ChapSimulation.html#cb85-7" tabindex="-1"></a>    pnormstar <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x) {</span>
<span id="cb85-8"><a href="ChapSimulation.html#cb85-8" tabindex="-1"></a>        y <span class="ot">&lt;-</span> (<span class="fu">pnorm</span>(x, mu, sigma) <span class="sc">-</span> Fa)<span class="sc">/</span>(Fb <span class="sc">-</span> Fa)</span>
<span id="cb85-9"><a href="ChapSimulation.html#cb85-9" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="sc">&lt;=</span> a) {</span>
<span id="cb85-10"><a href="ChapSimulation.html#cb85-10" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-11"><a href="ChapSimulation.html#cb85-11" tabindex="-1"></a>        }</span>
<span id="cb85-12"><a href="ChapSimulation.html#cb85-12" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="sc">&gt;=</span> b) {</span>
<span id="cb85-13"><a href="ChapSimulation.html#cb85-13" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-14"><a href="ChapSimulation.html#cb85-14" tabindex="-1"></a>        }</span>
<span id="cb85-15"><a href="ChapSimulation.html#cb85-15" tabindex="-1"></a>        <span class="fu">return</span>(y)</span>
<span id="cb85-16"><a href="ChapSimulation.html#cb85-16" tabindex="-1"></a>    })</span>
<span id="cb85-17"><a href="ChapSimulation.html#cb85-17" tabindex="-1"></a>    qnormstar <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb85-18"><a href="ChapSimulation.html#cb85-18" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">uniroot</span>((<span class="cf">function</span>(x) <span class="fu">pnormstar</span>(x) <span class="sc">-</span> u), <span class="at">lower =</span> <span class="dv">2</span>, <span class="at">upper =</span> <span class="dv">4</span>)[<span class="dv">1</span>])</span>
<span id="cb85-19"><a href="ChapSimulation.html#cb85-19" tabindex="-1"></a>    }</span>
<span id="cb85-20"><a href="ChapSimulation.html#cb85-20" tabindex="-1"></a>    <span class="fu">lines</span>(u, <span class="fu">pnormstar</span>(u), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-21"><a href="ChapSimulation.html#cb85-21" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb85-22"><a href="ChapSimulation.html#cb85-22" tabindex="-1"></a>    ru <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb85-23"><a href="ChapSimulation.html#cb85-23" tabindex="-1"></a>    <span class="fu">segments</span>(<span class="sc">-</span><span class="dv">1</span>, ru, <span class="fu">qnormstar</span>(ru), ru, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb85-24"><a href="ChapSimulation.html#cb85-24" tabindex="-1"></a>    <span class="fu">arrows</span>(<span class="fu">qnormstar</span>(ru), ru, <span class="fu">qnormstar</span>(ru), <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb85-25"><a href="ChapSimulation.html#cb85-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><img src="LDAEd2_files/figure-html/unnamed-chunk-118-.gif" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="S:Sec82" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Computing Distribution Parameters<a href="ChapSimulation.html#S:Sec82" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Calculate quantities of interest and determine the precision of the calculated quantities</li>
<li>Determine the appropriate number of replications for a simulation study</li>
<li>Calculate complex distributions needed for hypothesis testing.</li>
</ul>
<hr />
<div id="S:Sec821" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Simulating Parameters<a href="ChapSimulation.html#S:Sec821" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One use of the term <strong>parameter</strong> is as a quantity that serves as an index for a known parametric family. For example, one usually thinks of a mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> as parameters of a normal distribution. Statisticians also use the term <em>parameter</em> to mean any quantity that summarizes a distribution. In this sense, a parameter can be written as <span class="math inline">\(\theta(F)\)</span>, that is, if one knows the distribution function <span class="math inline">\(F(\cdot)\)</span>, then one can compute the summary measure <span class="math inline">\(\theta\)</span>.</p>
<p>In the previous subsection, we learned how to generate independent simulated realizations from a distribution of interest. With these realizations, we can construct an empirical distribution and approximate the underlying distribution as precisely as needed. As we introduce more actuarial applications in this book, you will see that simulation can be applied in a wide variety of contexts.</p>
<p>Many of these applications can be reduced to the problem of approximating a parameter <span class="math inline">\(\mathrm{E~}[h(X)]\)</span>, where <span class="math inline">\(h(\cdot)\)</span> is some known function. Based on <span class="math inline">\(R\)</span> simulations (replications), we get <span class="math inline">\(X_1,\ldots,X_R\)</span>. From this simulated sample, we calculate an average
<span class="math display">\[
\overline{h}_R=\frac{1}{R}\sum_{i=1}^{R} h(X_i)
\]</span>
that we use as our simulated approximate (estimate) of <span class="math inline">\(\mathrm{E~}[h(X)]\)</span>. To estimate the precision of this approximation, we use the simulation variance
<span class="math display">\[
s_{h,R}^2 = \frac{1}{R-1} \sum_{i=1}^{R}\left( h(X_i) -\overline{h}_R
\right) ^2.
\]</span>
From the independence, the standard error of the estimate is <span class="math inline">\(s_{h,R}/\sqrt{R}\)</span>. This can be made as small as we like by increasing the number of replications <span class="math inline">\(R\)</span>.</p>
<p><strong>Example 8.2.1. Portfolio Management.</strong> In Section <a href="ChapClaimSeverity.html#S:Sec51">5.1</a>, we learned how to calculate the expected value of policies with deductibles. For an example of something that cannot be done with closed form expressions, we now consider two risks. This is a variation of a more complex example that will be covered as <a href="#Ex13.4.6">Example 13.4.6</a>.</p>
<p>We consider two property risks of a telecommunications firm:</p>
<ul>
<li><span class="math inline">\(X_1\)</span> - buildings, modeled using a gamma distribution with mean 200 and scale parameter 100.</li>
<li><span class="math inline">\(X_2\)</span> - motor vehicles, modeled using a gamma distribution with mean 400 and scale parameter 200.</li>
</ul>
<p>Denote the total risk as <span class="math inline">\(X = X_1 + X_2.\)</span> For simplicity, you assume that these risks are independent.</p>
<p>To manage the risk, you seek some insurance protection. You are willing to retain internally small building and motor vehicles amounts, up to <span class="math inline">\(M\)</span>, say. Random amounts in excess of <span class="math inline">\(M\)</span> will have an unpredictable affect on your budget and so for these amounts you seek insurance protection. Stated mathematically, your retained risk is <span class="math inline">\(Y_{retained}=\)</span> <span class="math inline">\(\min(X_1 + X_2,M)\)</span> and the insurer’s portion is <span class="math inline">\(Y_{insurer} = X- Y_{retained}\)</span>.</p>
<p>To be specific, we use <span class="math inline">\(M=\)</span> 400 as well as <span class="math inline">\(R=\)</span> 1000000 simulations.</p>
<p><strong>a.</strong> With these settings, we wish to determine the expected claim amount and the associated standard deviation of (i) that retained by you, (ii) that accepted by the insurer, and (iii) the total overall amount.
<strong>b.</strong> For insured claims, the standard error of the simulation approximation is <span class="math inline">\(s_{h,R}/\sqrt{1000000} =\)</span> 280.86 <span class="math inline">\(/\sqrt{1000000} =\)</span> 0.281. For this example, simulation is quick and so a large value such as 1000000 is an easy choice. However, for more complex problems, the simulation size may be an issue.</p>
<p><strong>Example Solution</strong>. For part (a), the results of these calculations are:</p>
<pre><code>                   Retained Insurer  Total
Mean                 365.17  235.01 600.18
Standard Deviation    69.51  280.86 316.36</code></pre>
<p>For part (b), Figure <a href="ChapSimulation.html#fig:Fig85">8.5</a> allows us to visualize the development of the approximation as the number of simulations increases.</p>
<hr />

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig85"></span>
<img src="LDAEd2_files/figure-html/Fig85-1.png" alt="Estimated Expected Insurer Claims versus Number of Simulations" width="768" />
<p class="caption">
Figure 8.5: <strong>Estimated Expected Insurer Claims versus Number of Simulations</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Example821.Hide" href="javascript:togglecode('toggleCode.Example821.Hide','displayCode.Example821.Hide');"><i><strong>Show R Code for Example 8.2.1</strong></i></a>
</h5>
<div id="toggleCode.Example821.Hide" style="display: none">
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="ChapSimulation.html#cb87-1" tabindex="-1"></a><span class="co"># For the gamma distributions, use</span></span>
<span id="cb87-2"><a href="ChapSimulation.html#cb87-2" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb87-3"><a href="ChapSimulation.html#cb87-3" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb87-4"><a href="ChapSimulation.html#cb87-4" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb87-5"><a href="ChapSimulation.html#cb87-5" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb87-6"><a href="ChapSimulation.html#cb87-6" tabindex="-1"></a><span class="co"># Deductibles</span></span>
<span id="cb87-7"><a href="ChapSimulation.html#cb87-7" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb87-8"><a href="ChapSimulation.html#cb87-8" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000000</span>  <span class="co">#number of simulations</span></span>
<span id="cb87-9"><a href="ChapSimulation.html#cb87-9" tabindex="-1"></a></span>
<span id="cb87-10"><a href="ChapSimulation.html#cb87-10" tabindex="-1"></a><span class="co"># For the gamma distributions, use</span></span>
<span id="cb87-11"><a href="ChapSimulation.html#cb87-11" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb87-12"><a href="ChapSimulation.html#cb87-12" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb87-13"><a href="ChapSimulation.html#cb87-13" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb87-14"><a href="ChapSimulation.html#cb87-14" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb87-15"><a href="ChapSimulation.html#cb87-15" tabindex="-1"></a><span class="co"># Deductibles</span></span>
<span id="cb87-16"><a href="ChapSimulation.html#cb87-16" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb87-17"><a href="ChapSimulation.html#cb87-17" tabindex="-1"></a><span class="co"># Simulate the risks</span></span>
<span id="cb87-18"><a href="ChapSimulation.html#cb87-18" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000000</span>  <span class="co">#number of simulations</span></span>
<span id="cb87-19"><a href="ChapSimulation.html#cb87-19" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)  <span class="co">#set seed to reproduce work </span></span>
<span id="cb87-20"><a href="ChapSimulation.html#cb87-20" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha1, <span class="at">scale =</span> theta1)</span>
<span id="cb87-21"><a href="ChapSimulation.html#cb87-21" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha2, <span class="at">scale =</span> theta2)</span>
<span id="cb87-22"><a href="ChapSimulation.html#cb87-22" tabindex="-1"></a></span>
<span id="cb87-23"><a href="ChapSimulation.html#cb87-23" tabindex="-1"></a><span class="co"># Portfolio Risks</span></span>
<span id="cb87-24"><a href="ChapSimulation.html#cb87-24" tabindex="-1"></a>X <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2</span>
<span id="cb87-25"><a href="ChapSimulation.html#cb87-25" tabindex="-1"></a>Yretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X, M)</span>
<span id="cb87-26"><a href="ChapSimulation.html#cb87-26" tabindex="-1"></a>Yinsurer <span class="ot">&lt;-</span> X <span class="sc">-</span> Yretained</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="ChapSimulation.html#cb88-1" tabindex="-1"></a><span class="co"># a. Expected Claim Amounts</span></span>
<span id="cb88-2"><a href="ChapSimulation.html#cb88-2" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Yretained), <span class="fu">mean</span>(Yinsurer), <span class="fu">mean</span>(X))))</span>
<span id="cb88-3"><a href="ChapSimulation.html#cb88-3" tabindex="-1"></a>sdVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">sd</span>(Yretained), <span class="fu">sd</span>(Yinsurer), <span class="fu">sd</span>(X))))</span>
<span id="cb88-4"><a href="ChapSimulation.html#cb88-4" tabindex="-1"></a>outMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ExpVec, sdVec)</span>
<span id="cb88-5"><a href="ChapSimulation.html#cb88-5" tabindex="-1"></a><span class="fu">colnames</span>(outMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb88-6"><a href="ChapSimulation.html#cb88-6" tabindex="-1"></a><span class="fu">row.names</span>(outMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Standard Deviation&quot;</span>)</span>
<span id="cb88-7"><a href="ChapSimulation.html#cb88-7" tabindex="-1"></a><span class="co"># round(outMat,digits=2)</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="ChapSimulation.html#cb89-1" tabindex="-1"></a><span class="co"># b. Figure Set Up</span></span>
<span id="cb89-2"><a href="ChapSimulation.html#cb89-2" tabindex="-1"></a>Yinsurefct <span class="ot">&lt;-</span> <span class="cf">function</span>(numSim) {</span>
<span id="cb89-3"><a href="ChapSimulation.html#cb89-3" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(numSim, alpha1, <span class="at">scale =</span> theta1)</span>
<span id="cb89-4"><a href="ChapSimulation.html#cb89-4" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(numSim, alpha2, <span class="at">scale =</span> theta2)</span>
<span id="cb89-5"><a href="ChapSimulation.html#cb89-5" tabindex="-1"></a>    <span class="co"># Portfolio Risks</span></span>
<span id="cb89-6"><a href="ChapSimulation.html#cb89-6" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2</span>
<span id="cb89-7"><a href="ChapSimulation.html#cb89-7" tabindex="-1"></a>    Yinsurer <span class="ot">&lt;-</span> X <span class="sc">-</span> <span class="fu">pmin</span>(X, M)</span>
<span id="cb89-8"><a href="ChapSimulation.html#cb89-8" tabindex="-1"></a>    <span class="fu">return</span>(Yinsurer)</span>
<span id="cb89-9"><a href="ChapSimulation.html#cb89-9" tabindex="-1"></a>}</span>
<span id="cb89-10"><a href="ChapSimulation.html#cb89-10" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb89-11"><a href="ChapSimulation.html#cb89-11" tabindex="-1"></a>nPath <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb89-12"><a href="ChapSimulation.html#cb89-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb89-13"><a href="ChapSimulation.html#cb89-13" tabindex="-1"></a>simU <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">Yinsurefct</span>(R <span class="sc">*</span> nPath), R, nPath)</span>
<span id="cb89-14"><a href="ChapSimulation.html#cb89-14" tabindex="-1"></a>sumP2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(simU, <span class="dv">2</span>, cumsum)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="ChapSimulation.html#cb90-1" tabindex="-1"></a><span class="fu">matplot</span>(<span class="dv">1</span><span class="sc">:</span>R, sumP2[, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">400</span>),</span>
<span id="cb90-2"><a href="ChapSimulation.html#cb90-2" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of Simulations (&quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;R&quot;</span>), <span class="st">&quot;)&quot;</span>)), <span class="at">ylab =</span> <span class="st">&quot;Expected Insurer Claims&quot;</span>)</span>
<span id="cb90-3"><a href="ChapSimulation.html#cb90-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(Yinsurer), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb90-4"><a href="ChapSimulation.html#cb90-4" tabindex="-1"></a>bonds <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Yinsurer) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)), <span class="sc">-</span><span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(Yinsurer) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>R)))</span>
<span id="cb90-5"><a href="ChapSimulation.html#cb90-5" tabindex="-1"></a><span class="fu">matlines</span>(<span class="dv">1</span><span class="sc">:</span>R, bonds <span class="sc">+</span> <span class="fu">mean</span>(Yinsurer), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="S:Sec822" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Determining the Number of Simulations<a href="ChapSimulation.html#S:Sec822" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How many simulated values are recommended? 100? 1,000,000? We can use the <a href="#" class="tooltip" style="color:green"><em>central limit theorem</em><span style="font-size:8pt">The sample mean and sample sum of a random sample of n from a population will converge to a normal curve as the sample size n grows</span></a> to respond to this question.</p>
<p>As one criterion for your confidence in the result, suppose that you wish to be within 1% of the mean with 95% certainty. That is, you want <span class="math inline">\(\Pr \left( |\overline{h}_R - \mathrm{E~}[h(X)]| \le 0.01 \mathrm{E~}[h(X)] \right) \ge 0.95\)</span>. According to the central limit theorem, your estimate should be approximately normally distributed and so we want to have <span class="math inline">\(R\)</span> large enough to satisfy <span class="math inline">\(0.01 \mathrm{E~}[h(X)]/\sqrt{\mathrm{Var~}[h(X)]/R}) \ge 1.96\)</span>. (Recall that 1.96 is the 97.5th percentile from the standard normal distribution.) Replacing <span class="math inline">\(\mathrm{E~}[h(X)]\)</span> and <span class="math inline">\(\mathrm{Var~}[h(X)]\)</span> with estimates, you continue your simulation until
<span class="math display">\[
\frac{0.01~\overline{h}_R}{s_{h,R}/\sqrt{R}}\geq 1.96
\]</span>
or equivalently
<span class="math display" id="eq:NumSimulations">\[\begin{equation}
R \geq 38,416\frac{s_{h,R}^2}{\overline{h}_R^2}.
\tag{8.1}
\end{equation}\]</span>
This criterion is a direct application of the approximate normality. Note that <span class="math inline">\(\overline{h}_R\)</span> and <span class="math inline">\(s_{h,R}\)</span> are not known in advance, so you will have to come up with estimates, either by doing a small pilot study in advance or by interrupting your procedure intermittently to see if the criterion is satisfied.</p>
<p><strong>Example 8.2.1. Portfolio Management - continued</strong>. For this example, the average insurance claim is 235.011 and the corresponding standard deviation is 280.862. Using equation <a href="ChapSimulation.html#eq:NumSimulations">(8.1)</a>, to be within 1% of the mean, we would only require at least 54.87 thousand simulations. In addition, to be within 0.1% we would want at least 5.49 million simulations.</p>
<hr />
<p><strong>Example 8.2.2. Approximation Choices.</strong>
An important application of simulation is the approximation of <span class="math inline">\(\mathrm{E~}[h(X)]\)</span>. In this example, we show that the choice of the <span class="math inline">\(h(\cdot)\)</span> function and the distribution of <span class="math inline">\(X\)</span> can play a role.</p>
<p>Consider the following question : what is <span class="math inline">\(\Pr[X&gt;2]\)</span> when <span class="math inline">\(X\)</span> has a <a href="#" class="tooltip" style="color:green"><em>Cauchy distribution</em><span style="font-size:8pt">A continuous distribution that represents the distribution of the ratio of two independent normally random variables, where the denominator distribution has mean zero</span></a>, with density <span class="math inline">\(f(x) =\left[\pi(1+x^2)\right]^{-1}\)</span>, on the real line? The true value is
<span class="math display">\[
\Pr\left[X&gt;2\right] = \int_2^\infty \frac{dx}{\pi(1+x^2)} .
\]</span>
One can use an <code>R</code> numerical integration function (which usually works well on improper integrals)</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="ChapSimulation.html#cb91-1" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">lower =</span> <span class="dv">2</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<p>which is equal to 0.14758.</p>
<p><strong>Approximation 1.</strong> Alternatively, one can use simulation techniques to approximate that quantity. From calculus, you can check that the quantile function of the Cauchy distribution is <span class="math inline">\(F^{-1}(y) = \tan \left[\pi(y-0.5) \right]\)</span>. Then, with simulated uniform (0,1) variates, <span class="math inline">\(U_1, \ldots, U_R\)</span>, we can construct the estimator
<span class="math display">\[
p_1 = \frac{1}{R}\sum_{i=1}^R \mathrm{I}(F^{-1}(U_i)&gt;2)
= \frac{1}{R}\sum_{i=1}^R \mathrm{I}(\tan \left[ \pi(U_i-0.5) \right]&gt;2) .
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.Approximationchoices.1.9.1" href="javascript:togglecode('toggleCode.Approximationchoices.1.9.1','displayCode.Approximationchoices.1.9.1');"><i><strong>Show the R Code</strong></i></a>
</h5>
<div id="toggleCode.Approximationchoices.1.9.1" style="display: none">
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="ChapSimulation.html#cb92-1" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb92-2"><a href="ChapSimulation.html#cb92-2" tabindex="-1"></a>    <span class="fu">tan</span>(pi <span class="sc">*</span> (u <span class="sc">-</span> <span class="fl">0.5</span>))</span>
<span id="cb92-3"><a href="ChapSimulation.html#cb92-3" tabindex="-1"></a>}</span>
<span id="cb92-4"><a href="ChapSimulation.html#cb92-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb92-5"><a href="ChapSimulation.html#cb92-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb92-6"><a href="ChapSimulation.html#cb92-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">Q</span>(<span class="fu">runif</span>(R))</span>
<span id="cb92-7"><a href="ChapSimulation.html#cb92-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(X <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb92-8"><a href="ChapSimulation.html#cb92-8" tabindex="-1"></a>se.p1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(X <span class="sc">&gt;</span> <span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(R)</span>
<span id="cb92-9"><a href="ChapSimulation.html#cb92-9" tabindex="-1"></a><span class="co"># p1 se.p1</span></span></code></pre></div>
</div>
<p>With one million simulations, we obtain an estimate of 0.14744 with standard error 0.355 (divided by 1000). The estimated variance of <span class="math inline">\(p_1\)</span> can be written as <span class="math inline">\(0.127/R\)</span>.</p>
<!--It can be visualized below -->
<p><strong>Approximation 2.</strong> With other choices of <span class="math inline">\(h(\cdot)\)</span> and <span class="math inline">\(F(\cdot)\)</span> it is possible to reduce uncertainty even using the same number of simulations <span class="math inline">\(R\)</span>. To begin, one can use the symmetry of the Cauchy distribution to write <span class="math inline">\(\Pr[X&gt;2]=0.5\cdot\Pr[|X|&gt;2]\)</span>. With this, can construct a new estimator,
<span class="math display">\[
p_2 = \frac{1}{2R}\sum_{i=1}^R \mathrm{I}(|F^{-1}(U_i)|&gt;2) .
\]</span></p>
<p>With one million simulations, we obtain an estimate of 0.14748 with standard error 0.228 (divided by 1000). The estimated variance of <span class="math inline">\(p_2\)</span> can be written as <span class="math inline">\(0.052/R\)</span>.</p>
<!--It can be visualized below -->
<p><strong>Approximation 3.</strong> But one can go one step further. The improper integral can be written as a proper one by a simple symmetry property (since the function is symmetric and the integral on the real line is equal to <span class="math inline">\(1\)</span>)
<span class="math display">\[
\int_2^\infty \frac{dx}{\pi(1+x^2)}=\frac{1}{2}-\int_0^2\frac{dx}{\pi(1+x^2)} .
\]</span>
From this expression, a natural approximation would be
<span class="math display">\[
p_3 = \frac{1}{2}-\frac{1}{R}\sum_{i=1}^R h_3(2U_i), ~~~~~~\text{where}~h_3(x)=\frac{2}{\pi(1+x^2)} .
\]</span></p>
<p>With one million simulations, we obtain an estimate of 0.14756
with standard error 0.169 (divided by 1000). The estimated variance of <span class="math inline">\(p_3\)</span> can be written as <span class="math inline">\(0.0285/R\)</span>.</p>
<!--It can be visualized below -->
<p><strong>Approximation 4.</strong> Finally, one can also consider some change of variable in the integral
<span class="math display">\[
\int_2^\infty \frac{dx}{\pi(1+x^2)}=\int_0^{1/2}\frac{y^{-2}dy}{\pi(1-y^{-2})} .
\]</span>
From this expression, a natural approximation would be
<span class="math display">\[
p_4 = \frac{1}{R}\sum_{i=1}^R h_4(U_i/2),~~~~~\text{where}~h_4(x)=\frac{1}{2\pi(1+x^2)} .
\]</span>
The expression seems rather similar to the previous one.</p>
<p>With one million simulations, we obtain an estimate of 0.14759 with standard error 0.01 (divided by 1000). The estimated variance of <span class="math inline">\(p_4\)</span> can be written as <span class="math inline">\(0.00009/R\)</span>, which is much smaller than what we had so far!</p>
<!--It can be visualized below -->
<p><a href="ChapSimulation.html#tab:8.1">Table 8.1</a> summarizes the four choices of <span class="math inline">\(h(\cdot)\)</span> and <span class="math inline">\(F(\cdot)\)</span> to approximate <span class="math inline">\(\Pr[X&gt;2] =\)</span> 0.14758. The standard error varies dramatically. Thus, if we have a desired degree of accuracy, then the <em>number of simulations</em> depends strongly on how we write the integrals we try to approximate.</p>
<p><a id=tab:8.1></a></p>
<p><span id="tab:8.1">Table 8.1</span>. <strong>Summary of Four Choices to Approximate</strong> <span class="math inline">\(\Pr[X&gt;2]\)</span></p>
<div align="center">
<table>
<thead>
<tr>
<th style="text-align:center;">
Estimator
</th>
<th style="text-align:center;">
Definition
</th>
<th style="text-align:center;">
Support
Function
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Standard
Error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(p_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{1}{R}\sum_{i=1}^R \mathrm{I}(F^{-1}(U_i)&gt;2)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(~~~~~~F^{-1}(u)=\tan \left( \pi(u-0.5) \right)~~~~~~~\)</span>
</td>
<td style="text-align:right;">
0.147439
</td>
<td style="text-align:right;">
0.000355
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(p_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{1}{2R}\sum_{i=1}^R \mathrm{I}(|F^{-1}(U_i)|&gt;2)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(F^{-1}(u)=\tan \left( \pi(u-0.5) \right)\)</span>
</td>
<td style="text-align:right;">
0.147477
</td>
<td style="text-align:right;">
0.000228
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(p_3\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{1}{2}-\frac{1}{R}\sum_{i=1}^R h_3(2U_i)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(h_3(x)=\frac{2}{\pi(1+x^2)}\)</span>
</td>
<td style="text-align:right;">
0.147558
</td>
<td style="text-align:right;">
0.000169
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(p_4\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{1}{R}\sum_{i=1}^R h_4(U_i/2)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(h_4(x)=\frac{1}{2\pi(1+x^2)}\)</span>
</td>
<td style="text-align:right;">
0.147587
</td>
<td style="text-align:right;">
0.000010
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="S:Sec823" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Simulation and Statistical Inference<a href="ChapSimulation.html#S:Sec823" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulations not only help us approximate expected values but are also useful in calculating other aspects of distribution functions. As described in Section <a href="ChapSimulation.html#S:Sec821">8.2.1</a>, the logic is that one wishes to calculate a parameter <span class="math inline">\(\theta(F)\)</span>, use the same rule for calculating the parameter but replace the distribution function <span class="math inline">\(F(\cdot)\)</span> with an empirical one from a simulated sample. For example, in addition to expected values, analysts can use simulation to compute quantiles from complex distributions.</p>
<p>In addition, simulation is very useful when distributions of test statistics are too complicated to derive; in this case, one can use simulations to approximate the reference distribution. We now illustrate this with the <a href="#" class="tooltip" style="color:green"><em>Kolmogorov-Smirnov test</em><span style="font-size:8pt">A nonparametric statistical test used to determine if a data sample could come from a hypothesized continuous probability distribution</span></a> which we learned about in Section <a href="ChapModelSelection.html#S:Sec612">6.1.2</a>.</p>
<p><strong>Example 8.2.3. Kolmogorov-Smirnov Test of Distribution.</strong>
Suppose that we have available <span class="math inline">\(n=100\)</span> observations <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span> that, unknown to the analyst, were generated from a gamma distribution with parameters <span class="math inline">\(\alpha = 6\)</span> and <span class="math inline">\(\theta=2\)</span>. The analyst believes that the data come from a lognormal distribution with parameters 1 and 0.4 and would like to test this assumption.</p>
<p>The first step is to visualize the data.</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.1" href="javascript:togglecode('toggleCode.KSTest.1.10.1','displayCode.KSTest.1.10.1');"><i><strong>Show R Code To Set up The Visualization</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.1" style="display: none">
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="ChapSimulation.html#cb93-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb93-2"><a href="ChapSimulation.html#cb93-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb93-3"><a href="ChapSimulation.html#cb93-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb93-4"><a href="ChapSimulation.html#cb93-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb93-5"><a href="ChapSimulation.html#cb93-5" tabindex="-1"></a>vx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sort</span>(x))</span>
<span id="cb93-6"><a href="ChapSimulation.html#cb93-6" tabindex="-1"></a>vy <span class="ot">&lt;-</span> (<span class="dv">0</span><span class="sc">:</span>n)<span class="sc">/</span>n</span></code></pre></div>
</div>
<p>With this set-up, Figure <a href="ChapSimulation.html#fig:Fig86">8.6</a> provides a graph of a histogram and empirical distribution. For reference, superimposed are red dashed lines from the lognormal distribution.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig86"></span>
<img src="LDAEd2_files/figure-html/Fig86-1.png" alt="Histogram and Empirical Distribution Function of Data used in Kolmogorov-Smirnov Test. The red dashed lines are fits based on (incorrectly) hypothesized lognormal distribution." width="672" />
<p class="caption">
Figure 8.6: <strong>Histogram and Empirical Distribution Function of Data used in Kolmogorov-Smirnov Test</strong>. The red dashed lines are fits based on (incorrectly) hypothesized lognormal distribution.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Example823.Hide" href="javascript:togglecode('toggleCode.Example823.Hide','displayCode.Example823.Hide');"><i><strong>Show R Code for Plotting Figure 8.6</strong></i></a>
</h5>
<div id="toggleCode.Example823.Hide" style="display: none">
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="ChapSimulation.html#cb94-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb94-2"><a href="ChapSimulation.html#cb94-2" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Histogram&quot;</span>, <span class="at">col =</span> <span class="st">&quot;light blue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb94-3"><a href="ChapSimulation.html#cb94-3" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))</span>
<span id="cb94-4"><a href="ChapSimulation.html#cb94-4" tabindex="-1"></a><span class="fu">lines</span>(u, <span class="fu">dlnorm</span>(u, <span class="dv">1</span>, <span class="fl">0.4</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb94-5"><a href="ChapSimulation.html#cb94-5" tabindex="-1"></a><span class="fu">plot</span>(vx, vy, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative Distribution&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Empirical cdf&quot;</span>)</span>
<span id="cb94-6"><a href="ChapSimulation.html#cb94-6" tabindex="-1"></a><span class="fu">lines</span>(u, <span class="fu">plnorm</span>(u, <span class="dv">1</span>, <span class="fl">0.4</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<p>Recall that the Kolmogorov-Smirnov statistic equals the largest discrepancy between the empirical and the hypothesized distribution. This is <span class="math inline">\(\max_x |F_n(x)-F_0(x)|\)</span>, where <span class="math inline">\(F_0\)</span> is the hypothesized lognormal distribution. We can calculate this directly.</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.2" href="javascript:togglecode('toggleCode.KSTest.1.10.2','displayCode.KSTest.1.10.2');"><i><strong>Show R Code for a Direct Calculation of the KS Statistic</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.2" style="display: none">
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="ChapSimulation.html#cb95-1" tabindex="-1"></a><span class="co"># test statistic</span></span>
<span id="cb95-2"><a href="ChapSimulation.html#cb95-2" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="cf">function</span>(data, F0) {</span>
<span id="cb95-3"><a href="ChapSimulation.html#cb95-3" tabindex="-1"></a>    F <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x) <span class="fu">mean</span>((data <span class="sc">&lt;=</span> x)))</span>
<span id="cb95-4"><a href="ChapSimulation.html#cb95-4" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb95-5"><a href="ChapSimulation.html#cb95-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> data</span>
<span id="cb95-6"><a href="ChapSimulation.html#cb95-6" tabindex="-1"></a>    d1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">F</span>(x) <span class="sc">-</span> <span class="fu">F0</span>(x))</span>
<span id="cb95-7"><a href="ChapSimulation.html#cb95-7" tabindex="-1"></a>    d2 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">F</span>(x) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">-</span> <span class="fu">F0</span>(x))</span>
<span id="cb95-8"><a href="ChapSimulation.html#cb95-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(d1, d2)))</span>
<span id="cb95-9"><a href="ChapSimulation.html#cb95-9" tabindex="-1"></a>}</span>
<span id="cb95-10"><a href="ChapSimulation.html#cb95-10" tabindex="-1"></a><span class="co"># D(x,function(x) plnorm(x,1,.4))</span></span></code></pre></div>
</div>
<p>Fortunately, for the lognormal distribution, <code>R</code> has built-in tests that allow us to determine this without complex programming:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="ChapSimulation.html#cb96-1" tabindex="-1"></a><span class="fu">ks.test</span>(x, plnorm, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  x
D = 0.09703666, p-value = 0.303148
alternative hypothesis: two-sided</code></pre>
<p>However, for many distributions of actuarial interest, pre-built programs are not available. We can use simulation to test the relevance of the test statistic. Specifically, to compute the <span class="math inline">\(p\)</span>-value, let us generate thousands of random samples from a <span class="math inline">\(LN(1,0.4)\)</span> distribution (with the same size), and compute empirically the distribution of the statistic,</p>
<h5 style="text-align: center;">
<a id="displayCode.KSTest.1.10.3" href="javascript:togglecode('toggleCode.KSTest.1.10.3','displayCode.KSTest.1.10.3');"><i><strong>Show R Code for the Simulation Distribution of the KS Statistic</strong></i></a>
</h5>
<div id="toggleCode.KSTest.1.10.3" style="display: none">
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="ChapSimulation.html#cb98-1" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb98-2"><a href="ChapSimulation.html#cb98-2" tabindex="-1"></a>d_KS <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, ns)</span>
<span id="cb98-3"><a href="ChapSimulation.html#cb98-3" tabindex="-1"></a><span class="co"># compute the test statistics for a large (ns) number of simulated samples</span></span>
<span id="cb98-4"><a href="ChapSimulation.html#cb98-4" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ns) d_KS[s] <span class="ot">&lt;-</span> <span class="fu">D</span>(<span class="fu">rlnorm</span>(n, <span class="dv">1</span>, <span class="fl">0.4</span>), <span class="cf">function</span>(x) <span class="fu">plnorm</span>(x, <span class="dv">1</span>, <span class="fl">0.4</span>))</span>
<span id="cb98-5"><a href="ChapSimulation.html#cb98-5" tabindex="-1"></a><span class="fu">mean</span>(d_KS <span class="sc">&gt;</span> <span class="fu">D</span>(x, <span class="cf">function</span>(x) <span class="fu">plnorm</span>(x, <span class="dv">1</span>, <span class="fl">0.4</span>)))</span></code></pre></div>
<pre><code>[1] 0.2843</code></pre>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig87"></span>
<img src="LDAEd2_files/figure-html/Fig87-1.png" alt="Simulated Distribution of the Kolmogorov-Smirnov Test Statistic. The vertical red dashed line marks the test statistic for the sample of 100." width="672" />
<p class="caption">
Figure 8.7: <strong>Simulated Distribution of the Kolmogorov-Smirnov Test Statistic</strong>. The vertical red dashed line marks the test statistic for the sample of 100.
</p>
</div>
<p>The simulated distribution based on 10,000 random samples is summarized in Figure <a href="ChapSimulation.html#fig:Fig87">8.7</a>. Here, the statistic exceeded the empirical value (0.09704) in 28.43% of the scenarios, while the <em>theoretical</em> <span class="math inline">\(p\)</span>-value is 0.3031. For both the simulation and the theoretical <span class="math inline">\(p\)</span>-values, the conclusions are the same; the data do not provide sufficient evidence to reject the hypothesis of a lognormal distribution.</p>
<p>Although only an approximation, the simulation approach works in a variety of distributions and test statistics without needing to develop the nuances of the underpinning theory for each situation. We summarize the procedure for developing simulated distributions and <em>p</em>-values as follows:</p>
<ol style="list-style-type: decimal">
<li>Draw a sample of size <em>n</em>, say, <span class="math inline">\(X_1, \ldots, X_n\)</span>, from a known distribution function <span class="math inline">\(F\)</span>. Compute a statistic of interest, denoted as <span class="math inline">\(\hat{\theta}(X_1, \ldots, X_n)\)</span>. Call this <span class="math inline">\(\hat{\theta}^r\)</span> for the <em>r</em>th replication.</li>
<li>Repeat this <span class="math inline">\(r=1, \ldots, R\)</span> times to get a sample of statistics, <span class="math inline">\(\hat{\theta}^1, \ldots,\hat{\theta}^R\)</span>.</li>
<li>From the sample of statistics in Step 2, <span class="math inline">\(\{\hat{\theta}^1, \ldots,\hat{\theta}^R\}\)</span>, compute a summary measure of interest, such as a <em>p</em>-value.</li>
</ol>
</div>
</div>
<div id="S:Sec83" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Bootstrapping and Resampling<a href="ChapSimulation.html#S:Sec83" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Generate a nonparametric bootstrap distribution for a statistic of interest</li>
<li>Use the bootstrap distribution to generate estimates of precision for the statistic of interest, including bias, standard deviations, and confidence intervals</li>
<li>Perform bootstrap analyses for parametric distributions</li>
</ul>
<hr />
<div id="S:Sec831" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Bootstrap Foundations<a href="ChapSimulation.html#S:Sec831" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulation presented up to now is based on sampling from a <strong>known</strong> distribution. Section <a href="ChapSimulation.html#S:Sec81">8.1</a> showed how to use simulation techniques to sample and compute quantities from known distributions. However, statistical science is dedicated to providing inferences about distributions that are <em>unknown</em>. We gather summary statistics based on this unknown population distribution. But how do we sample from an unknown distribution?</p>
<p>Naturally, we cannot simulate draws from an unknown distribution but we can draw from a sample of observations. If the sample is a good representation from the population, then our simulated draws from the sample should well approximate the simulated draws from a population. The process of sampling from a sample is called <em>resampling</em> or <em>bootstrapping</em>. The term <a href="#" class="tooltip" style="color:green"><em>bootstrap</em><span style="font-size:8pt">A method of sampling with replacement from the original dataset to create additional simulated datasets of the same size as the original</span></a> comes from the phrase “pulling oneself up by one’s bootstraps” <span class="citation">Efron (<a href="bibliography.html#ref-efron1979bootstrap">1979</a>)</span>. With resampling, the original sample plays the role of the population and estimates from the sample play the role of true population parameters.</p>
<p>The resampling algorithm is the same as introduced in Section <a href="ChapSimulation.html#S:Sec823">8.2.3</a> except that now we use simulated draws from a sample. It is common to use <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span> to denote the original sample and let <span class="math inline">\(\{X_1^*, \ldots, X_n^*\}\)</span> denote the simulated draws. We draw them with replacement so that the simulated draws will be independent from one another, the same assumption as with the original sample. For each sample, we also use <em>n</em> simulated draws, the same number as the original sample size. To distinguish this procedure from the simulation, it is common to use <em>B</em> (for bootstrap) to be the number of simulated samples. We could also write <span class="math inline">\(\{X_1^{(b)}, \ldots, X_n^{(b)}\}\)</span>, <span class="math inline">\(b=1,\ldots, B\)</span> to clarify this.</p>
<p>There are two basic resampling methods, <em>model-free</em> and <em>model-based</em>, which are, respectively, as <em>nonparametric</em> and <em>parametric</em>. In the <a href="#" class="tooltip" style="color:green"><em>nonparametric approach</em><span style="font-size:8pt">A statistical method where no assumption is made about the distribution of the population</span></a>, no assumption is made about the distribution of the parent population. The simulated draws come from the empirical distribution function <span class="math inline">\(F_n(\cdot)\)</span>, so each draw comes from <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span> with probability 1/<em>n</em>.</p>
<p>In contrast, for the <a href="#" class="tooltip" style="color:green"><em>parametric approach</em><span style="font-size:8pt">A statistical method where a prior assumption is made about the distribution or model form</span></a>, we assume that we have knowledge of the distribution family <em>F</em>. The original sample <span class="math inline">\(X_1, \ldots, X_n\)</span> is used to estimate parameters of that family, say, <span class="math inline">\(\hat{\theta}\)</span>. Then, simulated draws are taken from the <span class="math inline">\(F(\hat{\theta})\)</span>. Section <a href="ChapSimulation.html#S:Sec834">8.3.4</a> discusses this approach in further detail.</p>
<div id="nonparametric-bootstrap" class="section level4 unnumbered hasAnchor">
<h4>Nonparametric Bootstrap<a href="ChapSimulation.html#nonparametric-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The idea of the nonparametric bootstrap is to use the inverse transform method on <span class="math inline">\(F_n\)</span>, the empirical cumulative distribution function, depicted in Figure <a href="ChapSimulation.html#fig:Fig88">8.8</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig88"></span>
<img src="LDAEd2_files/figure-html/Fig88-1.png" alt="Inverse of an Empirical Distribution Function" width="60%" />
<p class="caption">
Figure 8.8: <strong>Inverse of an Empirical Distribution Function</strong>
</p>
</div>
<p>Because <span class="math inline">\(F_n\)</span> is a step-function, <span class="math inline">\(F_n^{-1}\)</span> takes values in <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>. More precisely, as illustrated in Figure <a href="ChapSimulation.html#fig:Fig89">8.9</a>.</p>
<ul>
<li>if <span class="math inline">\(y\in(0,1/n)\)</span> (with probability <span class="math inline">\(1/n\)</span>) we draw the smallest value (<span class="math inline">\(\min\{x_i\}\)</span>)</li>
<li>if <span class="math inline">\(y\in(1/n,2/n)\)</span> (with probability <span class="math inline">\(1/n\)</span>) we draw the second smallest value,</li>
<li><span class="math inline">\(\vdots \ \ \vdots \ \ \vdots\)</span></li>
<li>if <span class="math inline">\(y\in((n-1)/n,1)\)</span> (with probability <span class="math inline">\(1/n\)</span>) we draw the largest value (<span class="math inline">\(\max\{x_i\}\)</span>).</li>
</ul>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig89"></span>
<img src="LDAEd2_files/figure-html/Fig89-1.png" alt="Inverse of an Empirical Distribution Function" width="60%" />
<p class="caption">
Figure 8.9: <strong>Inverse of an Empirical Distribution Function</strong>
</p>
</div>
<p>Using the inverse transform method with <span class="math inline">\(F_n\)</span> means sampling from <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>, with probability <span class="math inline">\(1/n\)</span>. Generating a bootstrap sample of size <span class="math inline">\(B\)</span> means sampling from <span class="math inline">\(\{x_1,\cdots,x_n\}\)</span>, with probability <span class="math inline">\(1/n\)</span>, with replacement. See the following illustrative <code>R</code> code.</p>
<h5 style="text-align: center;">
<a id="displayCode.BootStrap.A" href="javascript:togglecode('toggleCode.BootStrap.A','displayCode.BootStrap.A');"><i><strong>Show R Code For Creating a Bootstrap Sample</strong></i></a>
</h5>
<div id="toggleCode.BootStrap.A" style="display: none">
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="ChapSimulation.html#cb100-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb100-2"><a href="ChapSimulation.html#cb100-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb100-3"><a href="ChapSimulation.html#cb100-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb100-4"><a href="ChapSimulation.html#cb100-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb100-5"><a href="ChapSimulation.html#cb100-5" tabindex="-1"></a>bootvalues <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<pre><code> [1] 2.6164 5.7394 5.7394 2.6164 2.6164 7.0899 0.8823 5.7394 4.5311 0.8388</code></pre>
<p>Observe that value 5.7394 was obtained three times.</p>
</div>
</div>
<div id="S:Sec832" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Bootstrap Precision: Bias, Standard Deviation, and Mean Square Error<a href="ChapSimulation.html#S:Sec832" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We summarize the nonparametric bootstrap procedure as follows:</p>
<ol style="list-style-type: decimal">
<li>From the sample <span class="math inline">\(\{X_1, \ldots, X_n\}\)</span>, draw a sample of size <em>n</em> (with replacement), say, <span class="math inline">\(X_1^*, \ldots, X_n^*\)</span>. From the simulated draws compute a statistic of interest, denoted as <span class="math inline">\(\hat{\theta}(X_1^*, \ldots, X_n^*)\)</span>. Call this <span class="math inline">\(\hat{\theta}_b^*\)</span> for the <em>b</em>th replicate.</li>
<li>Repeat this <span class="math inline">\(b=1, \ldots, B\)</span> times to get a sample of statistics, <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>.</li>
<li>From the sample of statistics in Step 2, <span class="math inline">\(\{\hat{\theta}_1^*, \ldots, \hat{\theta}_B^*\}\)</span>, compute a summary measure of interest.</li>
</ol>
<p>In this section, we focus on three summary measures, the <a href="#" class="tooltip" style="color:green"><em>bias</em><span style="font-size:8pt">The difference between the expected value of an estimator and the parameter being estimated. bias is an estimation error that does not become smaller as one observes larger sample sizes.</span></a>, the standard deviation, and the mean square error (<em>MSE</em>). <a href="ChapSimulation.html#tab:8.3">Table 8.3</a> summarizes these three measures. Here, <span class="math inline">\(\overline{\hat{\theta^*}}\)</span> is the average of <span class="math inline">\(\{\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\}\)</span>.</p>
<p><a id=tab:8.3></a></p>
<p><span id="tab:8.3">Table 8.3</span>. <strong>Bootstrap Summary Measures</strong></p>
<p><span class="math display">\[
{\small
\begin{matrix}
\begin{array}{l|c|c|c}
\hline
\textit{Population Measure}&amp; \textit{Population Definition}&amp;\textit{Bootstrap Approximation}&amp;\textit{Bootstrap Symbol}\\
\hline
\text{Bias} &amp; \mathrm{E}(\hat{\theta})-\theta&amp;\overline{\hat{\theta^*}}-\hat{\theta}&amp; Bias_{boot}(\hat{\theta})  \\\hline
\text{Standard Deviation} &amp;   \sqrt{\mathrm{Var}(\hat{\theta})}
&amp; \sqrt{\frac{1}{B-1} \sum_{b=1}^{B}\left(\hat{\theta}_b^* -\overline{\hat{\theta^*}} \right) ^2}&amp;s_{boot}(\hat{\theta})  \\\hline
\text{Mean Square Error} &amp;\mathrm{E}(\hat{\theta}-\theta)^2 &amp; \frac{1}{B} \sum_{b=1}^{B}\left(\hat{\theta}_b^* -\hat{\theta}
\right)^2&amp;MSE_{boot}(\hat{\theta})\\
\hline
\end{array}\end{matrix}
}
\]</span></p>
<hr />
<p><a id=Ex:8.3.1></a></p>
<p><strong><span id="Ex:8.3.1">Example 8.3.1</span>. Bodily Injury Claims and Loss Elimination Ratios.</strong> To show how the bootstrap can be used to quantify the precision of estimators, we return to the <a href="../docs/ChapClaimSeverity.html#Ex:53.2">Example 5.3.2</a> bodily injury claims data where we introduced a nonparametric estimator of the loss elimination ratio.</p>
<p><a href="ChapSimulation.html#tab:8.4">Table 8.4</a> summarizes the results of the bootstrap estimation. For example, at <span class="math inline">\(d=14000\)</span>, the nonparametric estimate of <em>LER</em> is 0.97678. This has an estimated bias of 0.00016 with a standard deviation of 0.00687. For some applications, you may wish to apply the estimated bias to the original estimate to give a <a href="#" class="tooltip" style="color:green"><em>bias-corrected estimator</em><span style="font-size:8pt">If an estimator is known to be consistently biased in a manner, it can be corrected using a factor to be come less biased or unbiased</span></a>. This is the focus of the next example. For this illustration, the bias is small and so such a correction is not relevant.</p>
<h5 style="text-align: center;">
<a id="displayCode.LER8.2.1" href="javascript:togglecode('toggleCode.LER8.2.1','displayCode.LER8.2.1');"><i><strong>Show R Code For Bootstrap Estimates of LER</strong></i></a>
</h5>
<div id="toggleCode.LER8.2.1" style="display: none">
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="ChapSimulation.html#cb102-1" tabindex="-1"></a><span class="fu">library</span>(boot)  <span class="co"># for boot(), boot.ci()</span></span>
<span id="cb102-2"><a href="ChapSimulation.html#cb102-2" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb102-3"><a href="ChapSimulation.html#cb102-3" tabindex="-1"></a>BIData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data/DerrigResampling.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb102-4"><a href="ChapSimulation.html#cb102-4" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb102-5"><a href="ChapSimulation.html#cb102-5" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb102-6"><a href="ChapSimulation.html#cb102-6" tabindex="-1"></a>LER.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(ded, data, indices) {</span>
<span id="cb102-7"><a href="ChapSimulation.html#cb102-7" tabindex="-1"></a>    resample.data <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb102-8"><a href="ChapSimulation.html#cb102-8" tabindex="-1"></a>    sumClaims <span class="ot">&lt;-</span> <span class="fu">sum</span>(resample.data<span class="sc">$</span>AmountPaid)</span>
<span id="cb102-9"><a href="ChapSimulation.html#cb102-9" tabindex="-1"></a>    sumClaims_d <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">pmin</span>(resample.data<span class="sc">$</span>AmountPaid, ded))</span>
<span id="cb102-10"><a href="ChapSimulation.html#cb102-10" tabindex="-1"></a>    LER <span class="ot">&lt;-</span> sumClaims_d<span class="sc">/</span>sumClaims</span>
<span id="cb102-11"><a href="ChapSimulation.html#cb102-11" tabindex="-1"></a>    <span class="fu">return</span>(LER)</span>
<span id="cb102-12"><a href="ChapSimulation.html#cb102-12" tabindex="-1"></a>}</span>
<span id="cb102-13"><a href="ChapSimulation.html#cb102-13" tabindex="-1"></a></span>
<span id="cb102-14"><a href="ChapSimulation.html#cb102-14" tabindex="-1"></a><span class="do">## Derrig et al</span></span>
<span id="cb102-15"><a href="ChapSimulation.html#cb102-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb102-16"><a href="ChapSimulation.html#cb102-16" tabindex="-1"></a>dVec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>, <span class="dv">10500</span>, <span class="dv">11500</span>, <span class="dv">14000</span>, <span class="dv">18500</span>)</span>
<span id="cb102-17"><a href="ChapSimulation.html#cb102-17" tabindex="-1"></a>OutBoot <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(dVec2), <span class="dv">6</span>)</span>
<span id="cb102-18"><a href="ChapSimulation.html#cb102-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dVec2)) {</span>
<span id="cb102-19"><a href="ChapSimulation.html#cb102-19" tabindex="-1"></a>    OutBoot[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> dVec2[i]</span>
<span id="cb102-20"><a href="ChapSimulation.html#cb102-20" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> BIDataUncensored, <span class="at">statistic =</span> LER.boot, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">ded =</span> dVec2[i])</span>
<span id="cb102-21"><a href="ChapSimulation.html#cb102-21" tabindex="-1"></a>    OutBoot[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb102-22"><a href="ChapSimulation.html#cb102-22" tabindex="-1"></a>    biasboot <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t) <span class="sc">-</span> results<span class="sc">$</span>t0 <span class="ot">-&gt;</span> OutBoot[i, <span class="dv">3</span>]</span>
<span id="cb102-23"><a href="ChapSimulation.html#cb102-23" tabindex="-1"></a>    sdboot <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) <span class="ot">-&gt;</span> OutBoot[i, <span class="dv">4</span>]</span>
<span id="cb102-24"><a href="ChapSimulation.html#cb102-24" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb102-25"><a href="ChapSimulation.html#cb102-25" tabindex="-1"></a>    OutBoot[i, <span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb102-26"><a href="ChapSimulation.html#cb102-26" tabindex="-1"></a>    OutBoot[i, <span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb102-27"><a href="ChapSimulation.html#cb102-27" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:8.4></a></p>
<p><span id="tab:8.4">Table 8.4</span>. <strong>Bootstrap Estimates of LER at Selected Deductibles</strong></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
d
</th>
<th style="text-align:right;">
NP Estimate
</th>
<th style="text-align:right;">
Bootstrap Bias
</th>
<th style="text-align:right;">
Bootstrap SD
</th>
<th style="text-align:right;">
Lower Normal 95% CI
</th>
<th style="text-align:right;">
Upper Normal 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
0.54113
</td>
<td style="text-align:right;">
0.00011
</td>
<td style="text-align:right;">
0.01237
</td>
<td style="text-align:right;">
0.51678
</td>
<td style="text-align:right;">
0.56527
</td>
</tr>
<tr>
<td style="text-align:right;">
5000
</td>
<td style="text-align:right;">
0.64960
</td>
<td style="text-align:right;">
0.00027
</td>
<td style="text-align:right;">
0.01412
</td>
<td style="text-align:right;">
0.62166
</td>
<td style="text-align:right;">
0.67700
</td>
</tr>
<tr>
<td style="text-align:right;">
10500
</td>
<td style="text-align:right;">
0.93563
</td>
<td style="text-align:right;">
0.00004
</td>
<td style="text-align:right;">
0.01017
</td>
<td style="text-align:right;">
0.91567
</td>
<td style="text-align:right;">
0.95553
</td>
</tr>
<tr>
<td style="text-align:right;">
11500
</td>
<td style="text-align:right;">
0.95281
</td>
<td style="text-align:right;">
-0.00003
</td>
<td style="text-align:right;">
0.00941
</td>
<td style="text-align:right;">
0.93439
</td>
<td style="text-align:right;">
0.97128
</td>
</tr>
<tr>
<td style="text-align:right;">
14000
</td>
<td style="text-align:right;">
0.97678
</td>
<td style="text-align:right;">
0.00016
</td>
<td style="text-align:right;">
0.00687
</td>
<td style="text-align:right;">
0.96316
</td>
<td style="text-align:right;">
0.99008
</td>
</tr>
<tr>
<td style="text-align:right;">
18500
</td>
<td style="text-align:right;">
0.99382
</td>
<td style="text-align:right;">
0.00014
</td>
<td style="text-align:right;">
0.00331
</td>
<td style="text-align:right;">
0.98719
</td>
<td style="text-align:right;">
1.00017
</td>
</tr>
</tbody>
</table>
<p>The bootstrap standard deviation gives a measure of precision. For one application of standard deviations, we can use the normal approximation to create a confidence interval. For example, the <code>R</code> function <code>boot.ci</code> produces the normal confidence intervals at 95%. These are produced by creating an interval of twice the length of 1.95994 bootstrap standard deviations, centered about the bias-corrected estimator (1.95994 is the 97.5th quantile of the standard normal distribution). For example, the lower normal 95% CI at <span class="math inline">\(d=14000\)</span> is <span class="math inline">\((0.97678-0.00016)- 1.95994 \times 0.00687\)</span> <span class="math inline">\(= 0.96316\)</span>. We further discuss bootstrap confidence intervals in the next section.</p>
<hr />
<p><strong>Example 8.3.2. Estimating <span class="math inline">\(\log(\mu)\)</span>.</strong> The bootstrap can be used to quantify the bias of an estimator, for instance. Consider here a sample <span class="math inline">\(\mathbf{x}=\{x_1,\cdots,x_n\}\)</span> that is <a href="#" class="tooltip" style="color:green"><em>iid</em><span style="font-size:8pt">Independent and identically distributed</span></a> with mean <span class="math inline">\(\mu\)</span>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="ChapSimulation.html#cb103-1" tabindex="-1"></a>sample_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.46</span>, <span class="fl">2.8</span>, <span class="fl">3.28</span>, <span class="fl">3.86</span>, <span class="fl">2.85</span>, <span class="fl">3.67</span>, <span class="fl">3.37</span>, <span class="fl">3.4</span>, <span class="fl">5.22</span>, <span class="fl">2.55</span>, <span class="fl">2.79</span>, <span class="fl">4.5</span>,</span>
<span id="cb103-2"><a href="ChapSimulation.html#cb103-2" tabindex="-1"></a>    <span class="fl">3.37</span>, <span class="fl">2.88</span>, <span class="fl">1.44</span>, <span class="fl">2.56</span>, <span class="dv">2</span>, <span class="fl">2.07</span>, <span class="fl">2.19</span>, <span class="fl">1.77</span>)</span></code></pre></div>
<p>Suppose that the quantity of interest is <span class="math inline">\(\theta=\log(\mu)\)</span>. A natural estimator would be <span class="math inline">\(\widehat{\theta}_1=\log(\overline{x})\)</span>. This estimator is biased (due to the <a href="#" class="tooltip" style="color:green"><em>Jensen inequality</em><span style="font-size:8pt">For a convex function f(x), f(expected value of x) &lt;= expected value of f(x)</span></a>) but is asymptotically unbiased. For our sample, the estimate is as follows.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="ChapSimulation.html#cb104-1" tabindex="-1"></a>(theta_1 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(sample_x)))</span></code></pre></div>
<pre><code>[1] 1.08231352</code></pre>
<p>One can use a bootstrap strategy to get a correction: given a bootstrap sample, <span class="math inline">\(\mathbf{x}^{\ast}_{b}\)</span>, let <span class="math inline">\(\overline{x}^{\ast}_{b}\)</span> denote its mean, and set</p>
<p><span class="math display">\[
\widehat{\theta}_2=\frac{1}{B}\sum_{b=1}^B\log(\overline{x}^{\ast}_{b}) .
\]</span></p>
<p>To implement this, we have the following code where we now use the function <code>boot</code> from the <code>R</code> package <code>boot</code>.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapdisn.1" href="javascript:togglecode('toggleCode.bootstrapdisn.1','displayCode.bootstrapdisn.1');"><i><strong>Show R Code for Creating Bootstrap Samples</strong></i></a>
</h5>
<div id="toggleCode.bootstrapdisn.1" style="display: none">
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="ChapSimulation.html#cb106-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb106-2"><a href="ChapSimulation.html#cb106-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> sample_x, <span class="at">statistic =</span> <span class="cf">function</span>(y, indices) {</span>
<span id="cb106-3"><a href="ChapSimulation.html#cb106-3" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">mean</span>(y[indices]))</span>
<span id="cb106-4"><a href="ChapSimulation.html#cb106-4" tabindex="-1"></a>}, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb106-5"><a href="ChapSimulation.html#cb106-5" tabindex="-1"></a>theta_2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> theta_1 <span class="sc">-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p>Then, you can <code>plot(results)</code> and <code>print(results)</code> to see the following.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig810"></span>
<img src="LDAEd2_files/figure-html/Fig810-1.png" alt="Distribution of Bootstrap Replicates. The left-hand panel is a histogram of replicates. The right-hand panel is a quantile-quantile plot, comparing the bootstrap distribution to the standard normal distribution." width="672" />
<p class="caption">
Figure 8.10: <strong>Distribution of Bootstrap Replicates</strong>. The left-hand panel is a histogram of replicates. The right-hand panel is a quantile-quantile plot, comparing the bootstrap distribution to the standard normal distribution.
</p>
</div>
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = sample_x, statistic = function(y, indices) {
    log(mean(y[indices]))
}, R = 1000)


Bootstrap Statistics :
      original         bias     std. error
t1* 1.08231352 -0.00438957075 0.0669312212</code></pre>
<p>This results in two estimators, the raw estimator <span class="math inline">\(\widehat{\theta}_1=\)</span> 1.082 and the bootstrap estimator <span class="math inline">\(\widehat{\theta}_2=\)</span> 1.087.</p>
<p>How does this work with differing sample sizes? We now suppose that the <span class="math inline">\(x_i\)</span>’s are generated from a gamma distribution with shape parameter <span class="math inline">\(\alpha = 0.25\)</span> and scale parameter <span class="math inline">\(\theta = 12\)</span>. We use simulation to draw the sample sizes but then act as if they were a realized set of observations. See the following illustrative code.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapdisn.2" href="javascript:togglecode('toggleCode.bootstrapdisn.2','displayCode.bootstrapdisn.2');"><i><strong>Show R Code for Creating Bootstrap Samples</strong></i></a>
</h5>
<div id="toggleCode.bootstrapdisn.2" style="display: none">
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="ChapSimulation.html#cb108-1" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb108-2"><a href="ChapSimulation.html#cb108-2" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb108-3"><a href="ChapSimulation.html#cb108-3" tabindex="-1"></a>    theta_1 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(x))</span>
<span id="cb108-4"><a href="ChapSimulation.html#cb108-4" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> <span class="cf">function</span>(y, indices) {</span>
<span id="cb108-5"><a href="ChapSimulation.html#cb108-5" tabindex="-1"></a>        <span class="fu">log</span>(<span class="fu">mean</span>(y[indices]))</span>
<span id="cb108-6"><a href="ChapSimulation.html#cb108-6" tabindex="-1"></a>    }, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb108-7"><a href="ChapSimulation.html#cb108-7" tabindex="-1"></a>    theta_2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> theta_1 <span class="sc">-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t)</span>
<span id="cb108-8"><a href="ChapSimulation.html#cb108-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(theta_1, theta_2))</span>
<span id="cb108-9"><a href="ChapSimulation.html#cb108-9" tabindex="-1"></a>}</span>
<span id="cb108-10"><a href="ChapSimulation.html#cb108-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2074</span>)</span>
<span id="cb108-11"><a href="ChapSimulation.html#cb108-11" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb108-12"><a href="ChapSimulation.html#cb108-12" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb108-13"><a href="ChapSimulation.html#cb108-13" tabindex="-1"></a>    call_param <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb108-14"><a href="ChapSimulation.html#cb108-14" tabindex="-1"></a>        <span class="fu">param</span>(<span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="fl">0.25</span>, <span class="at">scale =</span> <span class="dv">12</span>))</span>
<span id="cb108-15"><a href="ChapSimulation.html#cb108-15" tabindex="-1"></a>    }</span>
<span id="cb108-16"><a href="ChapSimulation.html#cb108-16" tabindex="-1"></a>    V <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(call_param)(<span class="dv">1</span><span class="sc">:</span>ns)</span>
<span id="cb108-17"><a href="ChapSimulation.html#cb108-17" tabindex="-1"></a>    <span class="fu">apply</span>(V, <span class="dv">1</span>, median)</span>
<span id="cb108-18"><a href="ChapSimulation.html#cb108-18" tabindex="-1"></a>}</span>
<span id="cb108-19"><a href="ChapSimulation.html#cb108-19" tabindex="-1"></a>VN <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb108-20"><a href="ChapSimulation.html#cb108-20" tabindex="-1"></a>Est <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(est)(VN)</span>
<span id="cb108-21"><a href="ChapSimulation.html#cb108-21" tabindex="-1"></a></span>
<span id="cb108-22"><a href="ChapSimulation.html#cb108-22" tabindex="-1"></a><span class="fu">save</span>(VN, Est, <span class="at">file =</span> <span class="st">&quot;../IntermediateCalcs/SimulationChapter/Section832Bootstrap.Rdata&quot;</span>)</span></code></pre></div>
</div>
<p>The results of the comparison are summarized in Figure <a href="ChapSimulation.html#fig:Fig811">8.11</a>. This figure shows that the bootstrap estimator is closer to the true parameter value for many of the sample sizes. The bias of both estimators decreases as the sample size increases.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig811"></span>
<img src="LDAEd2_files/figure-html/Fig811-1.png" alt="Comparison of Estimates. True value of the parameter is given by the solid horizontal line at \(\log(3) \approx 1.099\)." width="70%" />
<p class="caption">
Figure 8.11: <strong>Comparison of Estimates.</strong> True value of the parameter is given by the solid horizontal line at <span class="math inline">\(\log(3) \approx 1.099\)</span>.
</p>
</div>
<hr />
<p>Although successful in this example, we remark that the bootstrap bias adjusted estimator is generally not used in practice because the bias adjustment introduces extra variability into the estimator. Instead, the bias estimate provides information as to whether or not the estimate contains bias; this information gives additional information about the reliability of the estimate.</p>
</div>
<div id="S:Sec833" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Confidence Intervals<a href="ChapSimulation.html#S:Sec833" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The bootstrap procedure generates <em>B</em> replicates <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span> of the estimator <span class="math inline">\(\hat{\theta}\)</span>. In <a href="ChapSimulation.html#Ex:8.3.1">Example 8.3.1</a>, we saw how to use standard normal approximations to create a confidence interval for parameters of interest. However, given that a major point is to use bootstrapping to avoid relying on assumptions of approximate normality, it is not surprising that there are alternative confidence intervals available.</p>
<p>For an estimator <span class="math inline">\(\hat{\theta}\)</span>, the <em>basic</em> bootstrap confidence interval is
<span class="math display" id="eq:basicBootCI">\[\begin{equation}
  \left(2 \hat{\theta} - q_U, 2 \hat{\theta} - q_L \right) ,
\tag{8.2}
\end{equation}\]</span>
where <span class="math inline">\(q_L\)</span> and <span class="math inline">\(q_U\)</span> are lower and upper 2.5% quantiles from the bootstrap sample <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>.</p>
<p>To see where this comes from, start with the idea that <span class="math inline">\((q_L, q_U)\)</span> provides a 95% interval for <span class="math inline">\(\hat{\theta}_1^*, \ldots,\hat{\theta}_B^*\)</span>. So, for a random <span class="math inline">\(\hat{\theta}_b^*\)</span>, there is a 95% chance that <span class="math inline">\(q_L \le \hat{\theta}_b^* \le q_U\)</span>. Reversing the inequalities and adding <span class="math inline">\(\hat{\theta}\)</span> to each side gives a 95% interval
<span class="math display">\[
\hat{\theta} -q_U \le \hat{\theta} - \hat{\theta}_b^* \le  \hat{\theta} -q_L .
\]</span>
So, <span class="math inline">\(\left( \hat{\theta}-q_U, \hat{\theta} -q_L\right)\)</span> is an 95% interval for <span class="math inline">\(\hat{\theta} - \hat{\theta}_b^*\)</span>. The bootstrap approximation idea says that this is also a 95% interval for <span class="math inline">\(\theta - \hat{\theta}\)</span>. Adding <span class="math inline">\(\hat{\theta}\)</span> to each side gives the 95% interval in equation <a href="ChapSimulation.html#eq:basicBootCI">(8.2)</a>.</p>
<p>Many alternative bootstrap intervals are available. The easiest to explain is the <a href="#" class="tooltip" style="color:green"><em>percentile bootstrap interval</em><span style="font-size:8pt">Confidence interval for the parameter estimates determined using the actual percentile results from the bootstrap sampling approach, as every bootstrap sample has an associated parameter estimate(s) that can be ranked against the others</span></a> which is defined as <span class="math inline">\(\left(q_L, q_U\right)\)</span>. However, this has the drawback of potentially poor behavior in the tails which can be of concern in some actuarial problems of interest.</p>
<p><a id=8.3.3></a></p>
<p><strong><span id="Ex:8.3.3">Example 8.3.3</span>. Bodily Injury Claims and Risk Measures.</strong> To see how the bootstrap confidence intervals work, we return to the bodily injury auto claims considered in <a href="ChapSimulation.html#Ex:8.3.1">Example 8.3.1</a>. Instead of the loss elimination ratio, suppose we wish to estimate the 95th percentile <span class="math inline">\(F^{-1}(0.95)\)</span> and a measure defined as
<span class="math display">\[
ES_{0.95}[X] = \mathrm{E}[X | X &gt; F^{-1}(0.95)] .
\]</span>
This measure is called the <a href="#" class="tooltip" style="color:green"><em>expected shortfall</em><span style="font-size:8pt">The average value at risk</span></a>. In this formulation, it is the expected value of <span class="math inline">\(X\)</span> conditional on <span class="math inline">\(X\)</span> exceeding the 95th percentile which is also sometimes known as the <em>conditional value at risk</em>. Section <a href="ChapPortMgt.html#S:Sec132">13.2</a> explains how quantiles and the expected shortfall are the two most important examples of so-called <em>risk measures</em>. For now, we will simply think of these as measures that we wish to estimate. For the percentile, we use the nonparametric estimator <span class="math inline">\(F^{-1}_n(0.95)\)</span> defined in Section <a href="ChapSeverity.html#S:MS:QuantileEstimator">4.4.1.2</a>. For the expected shortfall, we use the plug-in principle to define the nonparametric estimator
<span class="math display">\[
ES_{n,0.95}[X] = \frac{\sum_{i=1}^n X_i I[X_i &gt; F^{-1}_n(0.95)]}{\sum_{i=1}^n I[X_i &gt; F^{-1}_n(0.95)]} ~.
\]</span>
In this expression, the denominator counts the number of observations that exceed the 95th percentile <span class="math inline">\(F^{-1}_n(0.95)\)</span>. The numerator adds up losses for those observations that exceed <span class="math inline">\(F^{-1}_n(0.95)\)</span>. <a href="ChapSimulation.html#tab:8.5">Table 8.5</a> summarizes the estimator for selected fractions.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapquantiles.1" href="javascript:togglecode('toggleCode.bootstrapquantiles.1','displayCode.bootstrapquantiles.1');"><i><strong>Show R Code for Creating Quantile Bootstrap Samples</strong></i></a>
</h5>
<div id="toggleCode.bootstrapquantiles.1" style="display: none">
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="ChapSimulation.html#cb109-1" tabindex="-1"></a><span class="co"># Example from Derrig et al BIData &lt;- read.csv(&#39;./Data/DerrigResampling.csv&#39;,</span></span>
<span id="cb109-2"><a href="ChapSimulation.html#cb109-2" tabindex="-1"></a><span class="co"># header =T)</span></span>
<span id="cb109-3"><a href="ChapSimulation.html#cb109-3" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb109-4"><a href="ChapSimulation.html#cb109-4" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb109-5"><a href="ChapSimulation.html#cb109-5" tabindex="-1"></a></span>
<span id="cb109-6"><a href="ChapSimulation.html#cb109-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb109-7"><a href="ChapSimulation.html#cb109-7" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb109-8"><a href="ChapSimulation.html#cb109-8" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb109-9"><a href="ChapSimulation.html#cb109-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb109-10"><a href="ChapSimulation.html#cb109-10" tabindex="-1"></a>    OutBoot1[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb109-11"><a href="ChapSimulation.html#cb109-11" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> BIDataUncensored<span class="sc">$</span>AmountPaid, <span class="at">statistic =</span> <span class="cf">function</span>(X, indices) <span class="fu">quantile</span>(X[indices],</span>
<span id="cb109-12"><a href="ChapSimulation.html#cb109-12" tabindex="-1"></a>        PercentVec[i]), <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb109-13"><a href="ChapSimulation.html#cb109-13" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb109-14"><a href="ChapSimulation.html#cb109-14" tabindex="-1"></a>        bootreal <span class="ot">&lt;-</span> results<span class="sc">$</span>t</span>
<span id="cb109-15"><a href="ChapSimulation.html#cb109-15" tabindex="-1"></a>    }</span>
<span id="cb109-16"><a href="ChapSimulation.html#cb109-16" tabindex="-1"></a>    OutBoot1[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb109-17"><a href="ChapSimulation.html#cb109-17" tabindex="-1"></a>    OutBoot1[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t) <span class="sc">-</span> results<span class="sc">$</span>t0</span>
<span id="cb109-18"><a href="ChapSimulation.html#cb109-18" tabindex="-1"></a>    OutBoot1[i, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t)</span>
<span id="cb109-19"><a href="ChapSimulation.html#cb109-19" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb109-20"><a href="ChapSimulation.html#cb109-20" tabindex="-1"></a>    OutBoot1[i, <span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb109-21"><a href="ChapSimulation.html#cb109-21" tabindex="-1"></a>    OutBoot1[i, <span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb109-22"><a href="ChapSimulation.html#cb109-22" tabindex="-1"></a>    OutBoot1[i, <span class="dv">7</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb109-23"><a href="ChapSimulation.html#cb109-23" tabindex="-1"></a>    OutBoot1[i, <span class="dv">8</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb109-24"><a href="ChapSimulation.html#cb109-24" tabindex="-1"></a>    OutBoot1[i, <span class="dv">9</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb109-25"><a href="ChapSimulation.html#cb109-25" tabindex="-1"></a>    OutBoot1[i, <span class="dv">10</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb109-26"><a href="ChapSimulation.html#cb109-26" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:8.5></a></p>
<p><span id="tab:8.5">Table 8.5</span>. <strong>Bootstrap Estimates of Quantiles at Selected Fractions</strong></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Fraction
</th>
<th style="text-align:right;">
NP Estimate
</th>
<th style="text-align:right;">
Bootstrap Bias
</th>
<th style="text-align:right;">
Bootstrap SD
</th>
<th style="text-align:right;">
Lower Normal 95% CI
</th>
<th style="text-align:right;">
Upper Normal 95% CI
</th>
<th style="text-align:right;">
Lower Basic 95% CI
</th>
<th style="text-align:right;">
Upper Basic 95% CI
</th>
<th style="text-align:right;">
Lower Percentile 95% CI
</th>
<th style="text-align:right;">
Upper Percentile 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
6500.00
</td>
<td style="text-align:right;">
-128.02
</td>
<td style="text-align:right;">
200.36
</td>
<td style="text-align:right;">
6235.32
</td>
<td style="text-align:right;">
7020.72
</td>
<td style="text-align:right;">
6300.00
</td>
<td style="text-align:right;">
7000.00
</td>
<td style="text-align:right;">
6000.00
</td>
<td style="text-align:right;">
6700.00
</td>
</tr>
<tr>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
9078.40
</td>
<td style="text-align:right;">
89.51
</td>
<td style="text-align:right;">
200.27
</td>
<td style="text-align:right;">
8596.38
</td>
<td style="text-align:right;">
9381.41
</td>
<td style="text-align:right;">
8533.20
</td>
<td style="text-align:right;">
9230.40
</td>
<td style="text-align:right;">
8926.40
</td>
<td style="text-align:right;">
9623.60
</td>
</tr>
<tr>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
11454.00
</td>
<td style="text-align:right;">
55.95
</td>
<td style="text-align:right;">
480.66
</td>
<td style="text-align:right;">
10455.96
</td>
<td style="text-align:right;">
12340.13
</td>
<td style="text-align:right;">
10530.49
</td>
<td style="text-align:right;">
12415.00
</td>
<td style="text-align:right;">
10493.00
</td>
<td style="text-align:right;">
12377.51
</td>
</tr>
<tr>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
13313.40
</td>
<td style="text-align:right;">
13.59
</td>
<td style="text-align:right;">
667.74
</td>
<td style="text-align:right;">
11991.07
</td>
<td style="text-align:right;">
14608.55
</td>
<td style="text-align:right;">
11509.70
</td>
<td style="text-align:right;">
14321.00
</td>
<td style="text-align:right;">
12305.80
</td>
<td style="text-align:right;">
15117.10
</td>
</tr>
<tr>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
16758.72
</td>
<td style="text-align:right;">
101.46
</td>
<td style="text-align:right;">
1273.45
</td>
<td style="text-align:right;">
14161.34
</td>
<td style="text-align:right;">
19153.19
</td>
<td style="text-align:right;">
14517.44
</td>
<td style="text-align:right;">
19326.95
</td>
<td style="text-align:right;">
14190.49
</td>
<td style="text-align:right;">
19000.00
</td>
</tr>
</tbody>
</table>
<p>For example, when the fraction is 0.50, we see that lower and upper 2.5th quantiles of the bootstrap simulations are <span class="math inline">\(q_L=\)</span> 6000 and <span class="math inline">\(q_u=\)</span> 6700, respectively. These form the percentile bootstrap confidence interval. With the nonparametric estimator 6500, these yield the lower and upper bounds of the basic confidence interval 6300
and 7000, respectively. <a href="ChapSimulation.html#tab:8.5">Table 8.5</a> also shows bootstrap estimates of the bias, standard deviation, and a normal confidence interval, concepts introduced in Section <a href="ChapSimulation.html#S:Sec832">8.3.2</a>.</p>
<p><a href="ChapSimulation.html#tab:8.6">Table 8.6</a> shows similar calculations for the expected shortfall. In each case, we see that the bootstrap standard deviation increases as the fraction increases. This is because there are fewer observations to estimate quantiles as the fraction increases, leading to greater imprecision. Confidence intervals also become wider. Interestingly, there does not seem to be the same pattern in the estimates of the bias.</p>
<h5 style="text-align: center;">
<a id="displayCode.bootstrapquantiles.2" href="javascript:togglecode('toggleCode.bootstrapquantiles.2','displayCode.bootstrapquantiles.2');"><i><strong>Show R Code for Creating ES Bootstrap Samples</strong></i></a>
</h5>
<div id="toggleCode.bootstrapquantiles.2" style="display: none">
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="ChapSimulation.html#cb110-1" tabindex="-1"></a>ES.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices, RiskLevel) {</span>
<span id="cb110-2"><a href="ChapSimulation.html#cb110-2" tabindex="-1"></a>    resample.data <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb110-3"><a href="ChapSimulation.html#cb110-3" tabindex="-1"></a>    X <span class="ot">&lt;-</span> resample.data<span class="sc">$</span>AmountPaid</span>
<span id="cb110-4"><a href="ChapSimulation.html#cb110-4" tabindex="-1"></a>    cutoff <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X, RiskLevel)</span>
<span id="cb110-5"><a href="ChapSimulation.html#cb110-5" tabindex="-1"></a>    ES <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">*</span> (X <span class="sc">&gt;</span> cutoff))<span class="sc">/</span><span class="fu">sum</span>(X <span class="sc">&gt;</span> cutoff)</span>
<span id="cb110-6"><a href="ChapSimulation.html#cb110-6" tabindex="-1"></a>    <span class="fu">return</span>(ES)</span>
<span id="cb110-7"><a href="ChapSimulation.html#cb110-7" tabindex="-1"></a>}</span>
<span id="cb110-8"><a href="ChapSimulation.html#cb110-8" tabindex="-1"></a></span>
<span id="cb110-9"><a href="ChapSimulation.html#cb110-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb110-10"><a href="ChapSimulation.html#cb110-10" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb110-11"><a href="ChapSimulation.html#cb110-11" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb110-12"><a href="ChapSimulation.html#cb110-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb110-13"><a href="ChapSimulation.html#cb110-13" tabindex="-1"></a>    OutBoot1[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb110-14"><a href="ChapSimulation.html#cb110-14" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> BIDataUncensored, <span class="at">statistic =</span> ES.boot, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">RiskLevel =</span> PercentVec[i])</span>
<span id="cb110-15"><a href="ChapSimulation.html#cb110-15" tabindex="-1"></a>    OutBoot1[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb110-16"><a href="ChapSimulation.html#cb110-16" tabindex="-1"></a>    OutBoot1[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t) <span class="sc">-</span> results<span class="sc">$</span>t0</span>
<span id="cb110-17"><a href="ChapSimulation.html#cb110-17" tabindex="-1"></a>    OutBoot1[i, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t)</span>
<span id="cb110-18"><a href="ChapSimulation.html#cb110-18" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb110-19"><a href="ChapSimulation.html#cb110-19" tabindex="-1"></a>    OutBoot1[i, <span class="dv">5</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb110-20"><a href="ChapSimulation.html#cb110-20" tabindex="-1"></a>    OutBoot1[i, <span class="dv">6</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb110-21"><a href="ChapSimulation.html#cb110-21" tabindex="-1"></a>    OutBoot1[i, <span class="dv">7</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb110-22"><a href="ChapSimulation.html#cb110-22" tabindex="-1"></a>    OutBoot1[i, <span class="dv">8</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb110-23"><a href="ChapSimulation.html#cb110-23" tabindex="-1"></a>    OutBoot1[i, <span class="dv">9</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb110-24"><a href="ChapSimulation.html#cb110-24" tabindex="-1"></a>    OutBoot1[i, <span class="dv">10</span>] <span class="ot">&lt;-</span> temp<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb110-25"><a href="ChapSimulation.html#cb110-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p><a id=tab:8.6></a></p>
<p><span id="tab:8.6">Table 8.6</span>. <strong>Bootstrap Estimates of ES at Selected Risk Levels</strong></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Fraction
</th>
<th style="text-align:right;">
NP Estimate
</th>
<th style="text-align:right;">
Bootstrap Bias
</th>
<th style="text-align:right;">
Bootstrap SD
</th>
<th style="text-align:right;">
Lower Normal 95% CI
</th>
<th style="text-align:right;">
Upper Normal 95% CI
</th>
<th style="text-align:right;">
Lower Basic 95% CI
</th>
<th style="text-align:right;">
Upper Basic 95% CI
</th>
<th style="text-align:right;">
Lower Percentile 95% CI
</th>
<th style="text-align:right;">
Upper Percentile 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
9794.69
</td>
<td style="text-align:right;">
-120.82
</td>
<td style="text-align:right;">
273.35
</td>
<td style="text-align:right;">
9379.74
</td>
<td style="text-align:right;">
10451.27
</td>
<td style="text-align:right;">
9355.14
</td>
<td style="text-align:right;">
10448.87
</td>
<td style="text-align:right;">
9140.51
</td>
<td style="text-align:right;">
10234.24
</td>
</tr>
<tr>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
12454.18
</td>
<td style="text-align:right;">
30.68
</td>
<td style="text-align:right;">
481.88
</td>
<td style="text-align:right;">
11479.03
</td>
<td style="text-align:right;">
13367.96
</td>
<td style="text-align:right;">
11490.62
</td>
<td style="text-align:right;">
13378.52
</td>
<td style="text-align:right;">
11529.84
</td>
<td style="text-align:right;">
13417.74
</td>
</tr>
<tr>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
14720.05
</td>
<td style="text-align:right;">
17.51
</td>
<td style="text-align:right;">
718.23
</td>
<td style="text-align:right;">
13294.82
</td>
<td style="text-align:right;">
16110.25
</td>
<td style="text-align:right;">
13255.45
</td>
<td style="text-align:right;">
16040.72
</td>
<td style="text-align:right;">
13399.38
</td>
<td style="text-align:right;">
16184.65
</td>
</tr>
<tr>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
17072.43
</td>
<td style="text-align:right;">
5.99
</td>
<td style="text-align:right;">
1103.14
</td>
<td style="text-align:right;">
14904.31
</td>
<td style="text-align:right;">
19228.56
</td>
<td style="text-align:right;">
14924.50
</td>
<td style="text-align:right;">
19100.88
</td>
<td style="text-align:right;">
15043.97
</td>
<td style="text-align:right;">
19220.36
</td>
</tr>
<tr>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
20140.56
</td>
<td style="text-align:right;">
73.43
</td>
<td style="text-align:right;">
1587.64
</td>
<td style="text-align:right;">
16955.40
</td>
<td style="text-align:right;">
23178.85
</td>
<td style="text-align:right;">
16942.36
</td>
<td style="text-align:right;">
22984.40
</td>
<td style="text-align:right;">
17296.71
</td>
<td style="text-align:right;">
23338.75
</td>
</tr>
</tbody>
</table>
</div>
<div id="S:Sec834" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Parametric Bootstrap<a href="ChapSimulation.html#S:Sec834" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The idea of the nonparametric bootstrap is to resample by drawing independent variables from the empirical cumulative distribution function <span class="math inline">\(F_n\)</span>. In contrast, with parametric bootstrap, we draw independent variables from <span class="math inline">\(F_{\widehat{\theta}}\)</span> where the underlying distribution is assumed to be in a parametric family such as a gamma or lognormal distribution. Typically, parameters from this distribution are estimated based on a sample and denoted as <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Example 8.3.4. Lognormal distribution.</strong> Consider again the dataset</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ChapSimulation.html#cb111-1" tabindex="-1"></a>sample_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.46</span>, <span class="fl">2.8</span>, <span class="fl">3.28</span>, <span class="fl">3.86</span>, <span class="fl">2.85</span>, <span class="fl">3.67</span>, <span class="fl">3.37</span>, <span class="fl">3.4</span>, <span class="fl">5.22</span>, <span class="fl">2.55</span>, <span class="fl">2.79</span>, <span class="fl">4.5</span>,</span>
<span id="cb111-2"><a href="ChapSimulation.html#cb111-2" tabindex="-1"></a>    <span class="fl">3.37</span>, <span class="fl">2.88</span>, <span class="fl">1.44</span>, <span class="fl">2.56</span>, <span class="dv">2</span>, <span class="fl">2.07</span>, <span class="fl">2.19</span>, <span class="fl">1.77</span>)</span></code></pre></div>
<p>The classical (nonparametric) bootstrap was based on the following samples.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="ChapSimulation.html#cb112-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_x, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Instead, for the parametric bootstrap, we have to assume that the distribution of <span class="math inline">\(x_i\)</span>’s is from a specific family. As an example, the following code utilizes a lognormal distribution.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="ChapSimulation.html#cb113-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb113-2"><a href="ChapSimulation.html#cb113-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(sample_x, dlnorm, <span class="fu">list</span>(<span class="at">meanlog =</span> <span class="dv">1</span>, <span class="at">sdlog =</span> <span class="dv">1</span>))</span>
<span id="cb113-3"><a href="ChapSimulation.html#cb113-3" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>     meanlog         sdlog    
  1.0363069735   0.3059343996 
 (0.0684090114) (0.0483702729)</code></pre>
<p>Then we draw from that distribution.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ChapSimulation.html#cb115-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fu">length</span>(sample_x), <span class="at">meanlog =</span> fit<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">sdlog =</span> fit<span class="sc">$</span>estimate[<span class="dv">2</span>])</span></code></pre></div>
<h5 style="text-align: center;">
<a id="displayCode.BootES.1" href="javascript:togglecode('toggleCode.BootES.1','displayCode.BootES.1');"><i><strong>Show R Code for Parametric Bootstrap Samples</strong></i></a>
</h5>
<div id="toggleCode.BootES.1" style="display: none">
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="ChapSimulation.html#cb116-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2074</span>)</span>
<span id="cb116-2"><a href="ChapSimulation.html#cb116-2" tabindex="-1"></a>CV <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">100000</span>, <span class="dv">2</span>)</span>
<span id="cb116-3"><a href="ChapSimulation.html#cb116-3" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(CV)) {</span>
<span id="cb116-4"><a href="ChapSimulation.html#cb116-4" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_x, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-5"><a href="ChapSimulation.html#cb116-5" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="fu">length</span>(sample_x), <span class="at">meanlog =</span> fit<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">sdlog =</span> fit<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb116-6"><a href="ChapSimulation.html#cb116-6" tabindex="-1"></a>    CV[s, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sd</span>(x1)<span class="sc">/</span><span class="fu">mean</span>(x1), <span class="fu">sd</span>(x2)<span class="sc">/</span><span class="fu">mean</span>(x2))</span>
<span id="cb116-7"><a href="ChapSimulation.html#cb116-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>Figure <a href="ChapSimulation.html#fig:Fig812">8.12</a> compares the bootstrap distributions for the coefficient of variation, one based on the nonparametric approach and the other based on a parametric approach, assuming a lognormal distribution.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig812"></span>
<img src="LDAEd2_files/figure-html/Fig812-1.png" alt="Comparison of Nonparametric and Parametric Bootstrap Distributions for the Coefficient of Variation" width="70%" />
<p class="caption">
Figure 8.12: <strong>Comparison of Nonparametric and Parametric Bootstrap Distributions for the Coefficient of Variation</strong>
</p>
</div>
<hr />
<p><strong>Example 8.3.5. Bootstrapping Censored Observations.</strong> The parametric bootstrap draws simulated realizations from a parametric estimate of the distribution function. In the same way, we can draw simulated realizations from estimates of a distribution function. As one example, we might draw from smoothed estimates of a distribution function introduced in Section <a href="ChapSeverity.html#S:MS:Density">4.4.1.3</a>. Another special case, considered here, is to draw an estimate from the Kaplan-Meier estimator introduced in Section <a href="ChapClaimSeverity.html#S:Sec533">5.3.3</a>. In this way, we can handle observations that are censored.</p>
<p>Specifically, return to the bodily injury data in Examples 8.2.1 and 8.2.3 but now we include the 17 claims that were censored by policy limits. In Example 4.3.6, we used this full dataset to estimate the Kaplan-Meier estimator of the survival function introduced in Section <a href="ChapClaimSeverity.html#S:Sec533">5.3.3</a>. <a href="ChapSimulation.html#tab:8.7">Table 8.7</a> presents bootstrap estimates of the quantiles from the Kaplan-Meier survival function estimator. These include the bootstrap precision estimates, bias and standard deviation, as well as the basic 95% confidence interval.</p>
<h5 style="text-align: center;">
<a id="displayCode.KMCode.1" href="javascript:togglecode('toggleCode.KMCode.1','displayCode.KMCode.1');"><i><strong>Show R Code For Bootstrap Kaplan-Meier Estimates</strong></i></a>
</h5>
<div id="toggleCode.KMCode.1" style="display: none">
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ChapSimulation.html#cb117-1" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb117-2"><a href="ChapSimulation.html#cb117-2" tabindex="-1"></a><span class="fu">library</span>(survival)  <span class="co"># for Surv(), survfit()</span></span>
<span id="cb117-3"><a href="ChapSimulation.html#cb117-3" tabindex="-1"></a><span class="fu">library</span>(Hmisc)  <span class="co"># for bootkm()</span></span>
<span id="cb117-4"><a href="ChapSimulation.html#cb117-4" tabindex="-1"></a>BIData<span class="sc">$</span>UnCensored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (BIData<span class="sc">$</span>AmountPaid <span class="sc">&lt;</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb117-5"><a href="ChapSimulation.html#cb117-5" tabindex="-1"></a><span class="do">## KM estimate</span></span>
<span id="cb117-6"><a href="ChapSimulation.html#cb117-6" tabindex="-1"></a>KM0 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(AmountPaid, UnCensored) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;kaplan-meier&quot;</span>, <span class="at">data =</span> BIData)</span>
<span id="cb117-7"><a href="ChapSimulation.html#cb117-7" tabindex="-1"></a></span>
<span id="cb117-8"><a href="ChapSimulation.html#cb117-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb117-9"><a href="ChapSimulation.html#cb117-9" tabindex="-1"></a>PercentVec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>)</span>
<span id="cb117-10"><a href="ChapSimulation.html#cb117-10" tabindex="-1"></a>OutBoot1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb117-11"><a href="ChapSimulation.html#cb117-11" tabindex="-1"></a>KM.survobj <span class="ot">&lt;-</span> <span class="fu">Surv</span>(BIData<span class="sc">$</span>AmountPaid, BIData<span class="sc">$</span>UnCensored)</span>
<span id="cb117-12"><a href="ChapSimulation.html#cb117-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(PercentVec)) {</span>
<span id="cb117-13"><a href="ChapSimulation.html#cb117-13" tabindex="-1"></a>    OutBoot1[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> PercentVec[i]</span>
<span id="cb117-14"><a href="ChapSimulation.html#cb117-14" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">bootkm</span>(KM.survobj, <span class="at">q =</span> <span class="dv">1</span> <span class="sc">-</span> PercentVec[i], <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">pr =</span> <span class="cn">FALSE</span>)</span>
<span id="cb117-15"><a href="ChapSimulation.html#cb117-15" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb117-16"><a href="ChapSimulation.html#cb117-16" tabindex="-1"></a>        bootreal <span class="ot">&lt;-</span> results</span>
<span id="cb117-17"><a href="ChapSimulation.html#cb117-17" tabindex="-1"></a>    }</span>
<span id="cb117-18"><a href="ChapSimulation.html#cb117-18" tabindex="-1"></a>    OutBoot1[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(KM0, PercentVec[i])<span class="sc">$</span>quantile</span>
<span id="cb117-19"><a href="ChapSimulation.html#cb117-19" tabindex="-1"></a>    OutBoot1[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(results) <span class="sc">-</span> OutBoot1[i, <span class="dv">2</span>]</span>
<span id="cb117-20"><a href="ChapSimulation.html#cb117-20" tabindex="-1"></a>    OutBoot1[i, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(results)</span>
<span id="cb117-21"><a href="ChapSimulation.html#cb117-21" tabindex="-1"></a>    <span class="co"># temp &lt;- boot.ci(results, type = c(&#39;norm&#39;, &#39;basic&#39;,&#39;perc&#39;))</span></span>
<span id="cb117-22"><a href="ChapSimulation.html#cb117-22" tabindex="-1"></a>    OutBoot1[i, <span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> OutBoot1[i, <span class="dv">2</span>] <span class="sc">-</span> <span class="fu">quantile</span>(results, <span class="fl">0.975</span>, <span class="at">type =</span> <span class="dv">6</span>)</span>
<span id="cb117-23"><a href="ChapSimulation.html#cb117-23" tabindex="-1"></a>    OutBoot1[i, <span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> OutBoot1[i, <span class="dv">2</span>] <span class="sc">-</span> <span class="fu">quantile</span>(results, <span class="fl">0.025</span>, <span class="at">type =</span> <span class="dv">6</span>)</span>
<span id="cb117-24"><a href="ChapSimulation.html#cb117-24" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div style="page-break-after: always;"></div>
<p><a id=tab:8.7></a></p>
<p><span id="tab:8.7">Table 8.7</span>. <strong>Bootstrap Kaplan-Meier Estimates of Quantiles at Selected Fractions</strong></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Fraction
</th>
<th style="text-align:right;">
KM NP Estimate
</th>
<th style="text-align:right;">
Bootstrap Bias
</th>
<th style="text-align:right;">
Bootstrap SD
</th>
<th style="text-align:right;">
Lower Basic 95% CI
</th>
<th style="text-align:right;">
Upper Basic 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
6500
</td>
<td style="text-align:right;">
18.77
</td>
<td style="text-align:right;">
177.38
</td>
<td style="text-align:right;">
6067
</td>
<td style="text-align:right;">
6869
</td>
</tr>
<tr>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
9500
</td>
<td style="text-align:right;">
167.08
</td>
<td style="text-align:right;">
429.59
</td>
<td style="text-align:right;">
8355
</td>
<td style="text-align:right;">
9949
</td>
</tr>
<tr>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
12756
</td>
<td style="text-align:right;">
37.73
</td>
<td style="text-align:right;">
675.21
</td>
<td style="text-align:right;">
10812
</td>
<td style="text-align:right;">
13677
</td>
</tr>
<tr>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
18500
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
12500
</td>
<td style="text-align:right;">
22300
</td>
</tr>
<tr>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
25000
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
-Inf
</td>
<td style="text-align:right;">
27308
</td>
</tr>
</tbody>
</table>
<p>Results in <a href="ChapSimulation.html#tab:8.7">Table 8.7</a> are consistent with the results for the uncensored subsample in <a href="ChapSimulation.html#tab:8.5">Table 8.5</a>. In <a href="ChapSimulation.html#tab:8.7">Table 8.7</a>, we note the difficulty in estimating quantiles at large fractions due to the censoring. However, for moderate size fractions (0.50, 0.80, and 0.90), the Kaplan-Meier nonparametric (KM NP) estimates of the quantile are consistent with those <a href="ChapSimulation.html#tab:8.5">Table 8.5</a>. The bootstrap standard deviation is smaller at the 0.50 (corresponding to the median) but larger at the 0.80 and 0.90 levels. The censored data analysis summarized in <a href="ChapSimulation.html#tab:8.7">Table 8.7</a> uses more data than the uncensored subsample analysis in <a href="ChapSimulation.html#tab:8.5">Table 8.5</a> but also has difficulty extracting information for large quantiles.</p>
</div>
</div>
<div id="S:Sec84" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Model Selection and Cross-Validation<a href="ChapSimulation.html#S:Sec84" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Compare and contrast cross-validation to simulation techniques and bootstrap methods.</li>
<li>Use cross-validation techniques for model selection</li>
<li>Explain the jackknife method as a special case of cross-validation and calculate jackknife estimates of bias and standard errors</li>
</ul>
<hr />
<p>Cross-validation, briefly introduced in Chapter <a href="ChapDataAnalytics.html#ChapDataAnalytics">2</a> and Section <a href="ChapModelSelection.html#S:Sec65">6.5</a>, is a technique based on simulated outcomes that is especially useful for selecting an appropriate model. We now compare and contrast cross-validation to other simulation techniques already introduced in this chapter.</p>
<ul>
<li>Simulation, or Monte-Carlo, introduced in Section <a href="ChapSimulation.html#S:Sec81">8.1</a>, allows us to compute expected values and other summaries of statistical distributions, such as <span class="math inline">\(p\)</span>-values, readily.</li>
<li>Bootstrap, and other resampling methods introduced in Section <a href="ChapSimulation.html#S:Sec83">8.3</a>, provides estimators of the precision, or variability, of statistics.</li>
<li>Cross-validation is important when assessing how accurately a predictive model will perform in practice.</li>
</ul>
<p>Overlap exists but nonetheless it is helpful to think about the broad goals associated with each statistical method.</p>
<p>To discuss cross-validation, let us recall from Chapter <a href="ChapDataAnalytics.html#ChapDataAnalytics">2</a> some of the key ideas of model validation. When assessing, or validating, a model, we look to performance measured on <em>new</em> data, or at least not those that were used to fit the model. A classical approach is to split the sample in two: a subpart (the <em>training</em> dataset) is used to fit the model and the other one (the <em>testing</em> dataset) is used to validate. However, a limitation of this approach is that results depend on the split; even though the overall sample is fixed, the split between training and test subsamples varies randomly. A different training sample means that model estimated parameters will differ. Different model parameters and a different test sample means that validation statistics will differ. Two analysts may use the same data and same models yet reach different conclusions about the viability of a model (based on different random splits), a frustrating situation.</p>
<div id="S:Sec841" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> k-Fold Cross-Validation<a href="ChapSimulation.html#S:Sec841" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To mitigate this difficulty, it is common to use a cross-validation approach as introduced in Section 4.2.4. The key idea is to emulate the basic test/training approach to model validation by repeating it many times through averaging over different splits of the data. A key advantage is that the validation statistic is not tied to a specific parametric (or nonparametric) model - one can use a nonparametric statistic or a statistic that has economic interpretations - and so this can be used to compare models that are not nested (unlike likelihood ratio procedures).</p>
<p><strong>Example 8.4.1. Wisconsin Property Fund.</strong> For the 2010 property fund data introduced in Section <a href="ChapIntro.html#S:LGPIF">1.3</a>, we fit gamma and Pareto distributions to the 1,377 claims data. For details of the related goodness of fit, see Appendix Section 15.4.4. We now consider the Kolmogorov-Smirnov statistic introduced in Section <a href="ChapModelSelection.html#S:Sec612">6.1.2</a>. When the entire dataset was fit, the Kolmogorov-Smirnov goodness of fit statistic for the gamma distribution turns out to be 0.2639 and for the Pareto distribution is 0.0478. The lower value for the Pareto distribution indicates that this distribution is a better fit than the gamma.</p>
<p>To see how <a href="#" class="tooltip" style="color:green"><em>k-fold cross-validation</em><span style="font-size:8pt">A type of validation method where the data is randomly split into k groups, and each of the k groups is held out as a test dataset in turn, while the other k-1 gropus are used for distribution or model fitting, with the process repeated k times in total</span></a> works, we randomly split the data into <span class="math inline">\(k=8\)</span> groups, or folds, each having about <span class="math inline">\(1377/8 \approx 172\)</span> observations. Then, we fit gamma and Pareto models to a data set with the first seven folds (about <span class="math inline">\(172 \times 7 = 1,204\)</span> observations), determine estimated parameters, and then used these fitted models with the held-out data to determine the Kolmogorov-Smirnov statistic.</p>
<h5 style="text-align: center;">
<a id="displayCode.KFoldCV.1" href="javascript:togglecode('toggleCode.KFoldCV.1','displayCode.KFoldCV.1');"><i><strong>Show R Code for Kolmogorov-Smirnov Cross-Validation</strong></i></a>
</h5>
<div id="toggleCode.KFoldCV.1" style="display: none">
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ChapSimulation.html#cb118-1" tabindex="-1"></a><span class="co"># Randomly re-order the data - &#39;shuffle it&#39;</span></span>
<span id="cb118-2"><a href="ChapSimulation.html#cb118-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(claim_data)</span>
<span id="cb118-3"><a href="ChapSimulation.html#cb118-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12347</span>)</span>
<span id="cb118-4"><a href="ChapSimulation.html#cb118-4" tabindex="-1"></a>cvdata <span class="ot">&lt;-</span> claim_data[<span class="fu">sample</span>(n), ]</span>
<span id="cb118-5"><a href="ChapSimulation.html#cb118-5" tabindex="-1"></a><span class="co"># Number of folds</span></span>
<span id="cb118-6"><a href="ChapSimulation.html#cb118-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb118-7"><a href="ChapSimulation.html#cb118-7" tabindex="-1"></a>cvalvec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, k)</span>
<span id="cb118-8"><a href="ChapSimulation.html#cb118-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb118-9"><a href="ChapSimulation.html#cb118-9" tabindex="-1"></a>    indices <span class="ot">&lt;-</span> (((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">round</span>((<span class="dv">1</span><span class="sc">/</span>k) <span class="sc">*</span> <span class="fu">nrow</span>(cvdata))) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>((i <span class="sc">*</span> <span class="fu">round</span>((<span class="dv">1</span><span class="sc">/</span>k) <span class="sc">*</span></span>
<span id="cb118-10"><a href="ChapSimulation.html#cb118-10" tabindex="-1"></a>        <span class="fu">nrow</span>(cvdata))))</span>
<span id="cb118-11"><a href="ChapSimulation.html#cb118-11" tabindex="-1"></a>    <span class="co"># Pareto</span></span>
<span id="cb118-12"><a href="ChapSimulation.html#cb118-12" tabindex="-1"></a>    fit.pareto <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">data =</span> cvdata[<span class="sc">-</span>indices, ])</span>
<span id="cb118-13"><a href="ChapSimulation.html#cb118-13" tabindex="-1"></a>    ksResultPareto <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(cvdata[indices, ]<span class="sc">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">2</span>]),</span>
<span id="cb118-14"><a href="ChapSimulation.html#cb118-14" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">1</span>]))</span>
<span id="cb118-15"><a href="ChapSimulation.html#cb118-15" tabindex="-1"></a>    cvalvec[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> ksResultPareto<span class="sc">$</span>statistic</span>
<span id="cb118-16"><a href="ChapSimulation.html#cb118-16" tabindex="-1"></a>    <span class="co"># Gamma</span></span>
<span id="cb118-17"><a href="ChapSimulation.html#cb118-17" tabindex="-1"></a>    fit.gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cvdata[<span class="sc">-</span>indices, ], <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> log))</span>
<span id="cb118-18"><a href="ChapSimulation.html#cb118-18" tabindex="-1"></a>    gamma_theta <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.gamma)) <span class="sc">*</span> <span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb118-19"><a href="ChapSimulation.html#cb118-19" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb118-20"><a href="ChapSimulation.html#cb118-20" tabindex="-1"></a>    ksResultGamma <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(cvdata[indices, ]<span class="sc">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape =</span> alpha, <span class="at">scale =</span> gamma_theta)</span>
<span id="cb118-21"><a href="ChapSimulation.html#cb118-21" tabindex="-1"></a>    cvalvec[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> ksResultGamma<span class="sc">$</span>statistic</span>
<span id="cb118-22"><a href="ChapSimulation.html#cb118-22" tabindex="-1"></a>}</span>
<span id="cb118-23"><a href="ChapSimulation.html#cb118-23" tabindex="-1"></a>KScv <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(cvalvec)<span class="sc">/</span>k</span></code></pre></div>
</div>
<p>The results appear in Figure <a href="ChapSimulation.html#fig:Fig813">8.13</a> where horizontal axis is Fold=1. This process was repeated for the other seven folds. The results summarized in Figure <a href="ChapSimulation.html#fig:Fig813">8.13</a> show that the Pareto consistently provides a more reliable predictive distribution than the gamma.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig813"></span>
<img src="LDAEd2_files/figure-html/Fig813-1.png" alt="Cross Validated Kolmogorov-Smirnov (KS) Statistics for the Property Fund Claims Data. The solid black line is for the Pareto distribution, the green dashed line is for the gamma distribution. The KS statistic measures the largest deviation between the fitted distribution and the empirical distribution for each of 8 groups, or folds, of randomly selected data." width="70%" />
<p class="caption">
Figure 8.13: <strong>Cross Validated Kolmogorov-Smirnov (KS) Statistics for the Property Fund Claims Data.</strong> The solid black line is for the Pareto distribution, the green dashed line is for the gamma distribution. The KS statistic measures the largest deviation between the fitted distribution and the empirical distribution for each of 8 groups, or folds, of randomly selected data.
</p>
</div>
</div>
<div id="S:Sec842" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Leave-One-Out Cross-Validation<a href="ChapSimulation.html#S:Sec842" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A special case where <span class="math inline">\(k=n\)</span> is known as <a href="#" class="tooltip" style="color:green"><em>leave-one-out cross validation</em><span style="font-size:8pt">A special case of k-fold cross validation, where each single data point gets a turn in being the lone hold-out test data point, and n separate models in total are built and tested</span></a>. This case is historically prominent and is closely related to <a href="#" class="tooltip" style="color:green"><em>jackknife statistics</em><span style="font-size:8pt">To calculate an estimator, leave out each observation in turn, calculate the sample estimator statistic each time, and average over the n separate estimates</span></a>, a precursor of the bootstrap technique.</p>
<p>Even though we present it as a special case of cross-validation, it is helpful to given an explicit definition. Consider a generic statistic <span class="math inline">\(\widehat{\theta}=t(\boldsymbol{x})\)</span> that is an estimator for a parameter of interest <span class="math inline">\(\theta\)</span>. The idea of the jackknife is to compute <span class="math inline">\(n\)</span> values <span class="math inline">\(\widehat{\theta}_{-i}=t(\boldsymbol{x}_{-i})\)</span>, where <span class="math inline">\(\boldsymbol{x}_{-i}\)</span> is the subsample of <span class="math inline">\(\boldsymbol{x}\)</span> with the <span class="math inline">\(i\)</span>-th value removed. The average of these values is denoted as</p>
<p><span class="math display">\[
\overline{\widehat{\theta}}_{(\cdot)}=\frac{1}{n}\sum_{i=1}^n \widehat{\theta}_{-i} .
\]</span></p>
<p>These values can be used to create estimates of the bias of the statistic <span class="math inline">\(\widehat{\theta}\)</span>
<span class="math display" id="eq:Biasjack">\[\begin{equation}
Bias_{jack} = (n-1) \left(\overline{\widehat{\theta}}_{(\cdot)} - \widehat{\theta}\right)
\tag{8.3}
\end{equation}\]</span>
as well as a standard deviation estimate
<span class="math display" id="eq:sdjack">\[\begin{equation}
s_{jack} =\sqrt{\frac{n-1}{n}\sum_{i=1}^n \left(\widehat{\theta}_{-i} -\overline{\widehat{\theta}}_{(\cdot)}\right)^2} ~.
\tag{8.4}
\end{equation}\]</span></p>
<p><strong>Example 8.4.2. Coefficient of Variation.</strong> To illustrate, consider a small fictitious sample <span class="math inline">\(\boldsymbol{x}=\{x_1,\ldots,x_n\}\)</span> with realizations</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="ChapSimulation.html#cb119-1" tabindex="-1"></a>sample_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.46</span>, <span class="fl">2.8</span>, <span class="fl">3.28</span>, <span class="fl">3.86</span>, <span class="fl">2.85</span>, <span class="fl">3.67</span>, <span class="fl">3.37</span>, <span class="fl">3.4</span>, <span class="fl">5.22</span>, <span class="fl">2.55</span>, <span class="fl">2.79</span>, <span class="fl">4.5</span>,</span>
<span id="cb119-2"><a href="ChapSimulation.html#cb119-2" tabindex="-1"></a>    <span class="fl">3.37</span>, <span class="fl">2.88</span>, <span class="fl">1.44</span>, <span class="fl">2.56</span>, <span class="dv">2</span>, <span class="fl">2.07</span>, <span class="fl">2.19</span>, <span class="fl">1.77</span>)</span></code></pre></div>
<p>Suppose that we are interested in the <a href="#" class="tooltip" style="color:green"><em>coefficient of variation</em><span style="font-size:8pt">Standard deviation divided by the mean of a distribution, to measure variability in terms of units of the mean</span></a>
<span class="math inline">\(\theta = CV\)</span> <span class="math inline">\(= \sqrt{\mathrm{Var~}[X]}/\mathrm{E~}[X]\)</span>.</p>
<p>With this dataset, the estimator of the coefficient of variation turns out to be 0.31196. But how reliable is it? To answer this question, we can compute the jackknife estimates of bias and its standard deviation. The following code shows that the jackknife estimator of the bias is <span class="math inline">\(Bias_{jack} =\)</span> -0.00627 and the jackknife standard deviation is <span class="math inline">\(s_{jack} =\)</span> 0.01293.</p>
<h5 style="text-align: center;">
<a id="displayCode.Example842.Hid" href="javascript:togglecode('toggleCode.Example842.Hid','displayCode.Example842.Hid');"><i><strong>Show R Code for Example 8.4.2</strong></i></a>
</h5>
<div id="toggleCode.Example842.Hid" style="display: none">
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ChapSimulation.html#cb120-1" tabindex="-1"></a><span class="co"># Sample Code for Example 8.4.2</span></span>
<span id="cb120-2"><a href="ChapSimulation.html#cb120-2" tabindex="-1"></a>CVar <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb120-3"><a href="ChapSimulation.html#cb120-3" tabindex="-1"></a>JackCVar <span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">sqrt</span>(<span class="fu">var</span>(sample_x[<span class="sc">-</span>i]))<span class="sc">/</span><span class="fu">mean</span>(sample_x[<span class="sc">-</span>i])</span>
<span id="cb120-4"><a href="ChapSimulation.html#cb120-4" tabindex="-1"></a>JackTheta <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(JackCVar)(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_x))</span>
<span id="cb120-5"><a href="ChapSimulation.html#cb120-5" tabindex="-1"></a>BiasJack <span class="ot">&lt;-</span> (<span class="fu">length</span>(sample_x) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(JackTheta) <span class="sc">-</span> <span class="fu">CVar</span>(sample_x))</span>
<span id="cb120-6"><a href="ChapSimulation.html#cb120-6" tabindex="-1"></a>sdJack <span class="ot">&lt;-</span> <span class="fu">sd</span>(JackTheta)</span></code></pre></div>
</div>
<hr />
<p><strong>Example 8.4.3. Bodily Injury Claims and Loss Elimination Ratios.</strong> In <a href="ChapSimulation.html#Ex:8.3.1">Example 8.3.1</a>, we showed how to compute bootstrap estimates of the bias and standard deviation for the loss elimination ratio using the Example 4.1.11 bodily injury claims data. We follow up now by providing comparable quantities using jackknife statistics.</p>
<p><a href="ChapSimulation.html#tab:8.8">Table 8.8</a> summarizes the results of the jackknife estimation. It shows that jackknife estimates of the bias and standard deviation of the loss elimination ratio <span class="math inline">\(\mathrm{E}~[\min(X,d)]/\mathrm{E}~[X]\)</span> are largely consistent with the bootstrap methodology. Moreover, one can use the standard deviations to construct normal based confidence intervals, centered around a bias-corrected estimator. For example, at <span class="math inline">\(d=14000\)</span>, we saw in Example 4.1.11 that the nonparametric estimate of <em>LER</em> is 0.97678. This has an estimated bias of 0.00010, resulting in the (jackknife) <em>bias-corrected</em> estimator 0.97688. The 95% confidence intervals are produced by creating an interval of twice the length of 1.96 jackknife standard deviations, centered about the bias-corrected estimator (1.96 is the approximate 97.5th quantile of the standard normal distribution).</p>
<h5 style="text-align: center;">
<a id="displayCode.Jackknife.1" href="javascript:togglecode('toggleCode.Jackknife.1','displayCode.Jackknife.1');"><i><strong>Show the R Code</strong></i></a>
</h5>
<div id="toggleCode.Jackknife.1" style="display: none">
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="ChapSimulation.html#cb121-1" tabindex="-1"></a><span class="co"># Example from Derrig et al</span></span>
<span id="cb121-2"><a href="ChapSimulation.html#cb121-2" tabindex="-1"></a>BIData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data/DerrigResampling.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb121-3"><a href="ChapSimulation.html#cb121-3" tabindex="-1"></a>BIData<span class="sc">$</span>Censored <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> (BIData<span class="sc">$</span>AmountPaid <span class="sc">&gt;=</span> BIData<span class="sc">$</span>PolicyLimit)</span>
<span id="cb121-4"><a href="ChapSimulation.html#cb121-4" tabindex="-1"></a>BIDataUncensored <span class="ot">&lt;-</span> <span class="fu">subset</span>(BIData, Censored <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb121-5"><a href="ChapSimulation.html#cb121-5" tabindex="-1"></a>LER.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(ded, data, indices) {</span>
<span id="cb121-6"><a href="ChapSimulation.html#cb121-6" tabindex="-1"></a>    resample.data <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb121-7"><a href="ChapSimulation.html#cb121-7" tabindex="-1"></a>    sumClaims <span class="ot">&lt;-</span> <span class="fu">sum</span>(resample.data<span class="sc">$</span>AmountPaid)</span>
<span id="cb121-8"><a href="ChapSimulation.html#cb121-8" tabindex="-1"></a>    sumClaims_d <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">pmin</span>(resample.data<span class="sc">$</span>AmountPaid, ded))</span>
<span id="cb121-9"><a href="ChapSimulation.html#cb121-9" tabindex="-1"></a>    LER <span class="ot">&lt;-</span> sumClaims_d<span class="sc">/</span>sumClaims</span>
<span id="cb121-10"><a href="ChapSimulation.html#cb121-10" tabindex="-1"></a>    <span class="fu">return</span>(LER)</span>
<span id="cb121-11"><a href="ChapSimulation.html#cb121-11" tabindex="-1"></a>}</span>
<span id="cb121-12"><a href="ChapSimulation.html#cb121-12" tabindex="-1"></a></span>
<span id="cb121-13"><a href="ChapSimulation.html#cb121-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> BIDataUncensored<span class="sc">$</span>AmountPaid</span>
<span id="cb121-14"><a href="ChapSimulation.html#cb121-14" tabindex="-1"></a>LER.jack <span class="ot">&lt;-</span> <span class="cf">function</span>(ded, i) {</span>
<span id="cb121-15"><a href="ChapSimulation.html#cb121-15" tabindex="-1"></a>    LER <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">pmin</span>(x[<span class="sc">-</span>i], ded))<span class="sc">/</span><span class="fu">sum</span>(x[<span class="sc">-</span>i])</span>
<span id="cb121-16"><a href="ChapSimulation.html#cb121-16" tabindex="-1"></a>    <span class="fu">return</span>(LER)</span>
<span id="cb121-17"><a href="ChapSimulation.html#cb121-17" tabindex="-1"></a>}</span>
<span id="cb121-18"><a href="ChapSimulation.html#cb121-18" tabindex="-1"></a>LER <span class="ot">&lt;-</span> <span class="cf">function</span>(ded) {</span>
<span id="cb121-19"><a href="ChapSimulation.html#cb121-19" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">pmin</span>(x, ded))<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb121-20"><a href="ChapSimulation.html#cb121-20" tabindex="-1"></a>}</span>
<span id="cb121-21"><a href="ChapSimulation.html#cb121-21" tabindex="-1"></a><span class="do">## Derrig et al</span></span>
<span id="cb121-22"><a href="ChapSimulation.html#cb121-22" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb121-23"><a href="ChapSimulation.html#cb121-23" tabindex="-1"></a>dVec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>, <span class="dv">10500</span>, <span class="dv">11500</span>, <span class="dv">14000</span>, <span class="dv">18500</span>)</span>
<span id="cb121-24"><a href="ChapSimulation.html#cb121-24" tabindex="-1"></a>OutJack <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(dVec2), <span class="dv">8</span>)</span>
<span id="cb121-25"><a href="ChapSimulation.html#cb121-25" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dVec2)) {</span>
<span id="cb121-26"><a href="ChapSimulation.html#cb121-26" tabindex="-1"></a>    OutJack[j, <span class="dv">1</span>] <span class="ot">&lt;-</span> dVec2[j]</span>
<span id="cb121-27"><a href="ChapSimulation.html#cb121-27" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> BIDataUncensored, <span class="at">statistic =</span> LER.boot, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">ded =</span> dVec2[j])</span>
<span id="cb121-28"><a href="ChapSimulation.html#cb121-28" tabindex="-1"></a>    OutJack[j, <span class="dv">2</span>] <span class="ot">&lt;-</span> results<span class="sc">$</span>t0</span>
<span id="cb121-29"><a href="ChapSimulation.html#cb121-29" tabindex="-1"></a>    biasboot <span class="ot">&lt;-</span> <span class="fu">mean</span>(results<span class="sc">$</span>t) <span class="sc">-</span> results<span class="sc">$</span>t0 <span class="ot">-&gt;</span> OutJack[j, <span class="dv">3</span>]</span>
<span id="cb121-30"><a href="ChapSimulation.html#cb121-30" tabindex="-1"></a>    sdboot <span class="ot">&lt;-</span> <span class="fu">sd</span>(results<span class="sc">$</span>t) <span class="ot">-&gt;</span> OutJack[j, <span class="dv">4</span>]</span>
<span id="cb121-31"><a href="ChapSimulation.html#cb121-31" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb121-32"><a href="ChapSimulation.html#cb121-32" tabindex="-1"></a></span>
<span id="cb121-33"><a href="ChapSimulation.html#cb121-33" tabindex="-1"></a>    LER.jack.ded <span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">LER.jack</span>(<span class="at">ded =</span> dVec2[j], i)</span>
<span id="cb121-34"><a href="ChapSimulation.html#cb121-34" tabindex="-1"></a>    JackTheta.ded <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(LER.jack.ded)(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb121-35"><a href="ChapSimulation.html#cb121-35" tabindex="-1"></a>    OutJack[j, <span class="dv">5</span>] <span class="ot">&lt;-</span> BiasJack.ded <span class="ot">&lt;-</span> (<span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(JackTheta.ded) <span class="sc">-</span> <span class="fu">LER</span>(<span class="at">ded =</span> dVec2[j]))</span>
<span id="cb121-36"><a href="ChapSimulation.html#cb121-36" tabindex="-1"></a>    OutJack[j, <span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(JackTheta.ded)</span>
<span id="cb121-37"><a href="ChapSimulation.html#cb121-37" tabindex="-1"></a>    OutJack[j, <span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(JackTheta.ded) <span class="sc">+</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="fu">length</span>(x) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span></span>
<span id="cb121-38"><a href="ChapSimulation.html#cb121-38" tabindex="-1"></a>        OutJack[j, <span class="dv">6</span>]</span>
<span id="cb121-39"><a href="ChapSimulation.html#cb121-39" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p><a id=tab:8.8></a></p>
<p><span id="tab:8.8">Table 8.8</span>. <strong>Jackknife Estimates of LER at Selected Deductibles</strong></p>
<table>
<thead>
<tr>
<th style="text-align:right;">
d
</th>
<th style="text-align:right;">
NP Estimate
</th>
<th style="text-align:right;">
Bootstrap Bias
</th>
<th style="text-align:right;">
Bootstrap SD
</th>
<th style="text-align:right;">
Jackknife Bias
</th>
<th style="text-align:right;">
Jackknife SD
</th>
<th style="text-align:right;">
Lower Jackknife 95% CI
</th>
<th style="text-align:right;">
Upper Jackknife 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
0.54113
</td>
<td style="text-align:right;">
0.00011
</td>
<td style="text-align:right;">
0.01237
</td>
<td style="text-align:right;">
0.00031
</td>
<td style="text-align:right;">
0.00061
</td>
<td style="text-align:right;">
0.53993
</td>
<td style="text-align:right;">
0.54233
</td>
</tr>
<tr>
<td style="text-align:right;">
5000
</td>
<td style="text-align:right;">
0.64960
</td>
<td style="text-align:right;">
0.00027
</td>
<td style="text-align:right;">
0.01412
</td>
<td style="text-align:right;">
0.00033
</td>
<td style="text-align:right;">
0.00068
</td>
<td style="text-align:right;">
0.64825
</td>
<td style="text-align:right;">
0.65094
</td>
</tr>
<tr>
<td style="text-align:right;">
10500
</td>
<td style="text-align:right;">
0.93563
</td>
<td style="text-align:right;">
0.00004
</td>
<td style="text-align:right;">
0.01017
</td>
<td style="text-align:right;">
0.00019
</td>
<td style="text-align:right;">
0.00053
</td>
<td style="text-align:right;">
0.93460
</td>
<td style="text-align:right;">
0.93667
</td>
</tr>
<tr>
<td style="text-align:right;">
11500
</td>
<td style="text-align:right;">
0.95281
</td>
<td style="text-align:right;">
-0.00003
</td>
<td style="text-align:right;">
0.00941
</td>
<td style="text-align:right;">
0.00016
</td>
<td style="text-align:right;">
0.00047
</td>
<td style="text-align:right;">
0.95189
</td>
<td style="text-align:right;">
0.95373
</td>
</tr>
<tr>
<td style="text-align:right;">
14000
</td>
<td style="text-align:right;">
0.97678
</td>
<td style="text-align:right;">
0.00016
</td>
<td style="text-align:right;">
0.00687
</td>
<td style="text-align:right;">
0.00010
</td>
<td style="text-align:right;">
0.00034
</td>
<td style="text-align:right;">
0.97612
</td>
<td style="text-align:right;">
0.97745
</td>
</tr>
<tr>
<td style="text-align:right;">
18500
</td>
<td style="text-align:right;">
0.99382
</td>
<td style="text-align:right;">
0.00014
</td>
<td style="text-align:right;">
0.00331
</td>
<td style="text-align:right;">
0.00003
</td>
<td style="text-align:right;">
0.00017
</td>
<td style="text-align:right;">
0.99350
</td>
<td style="text-align:right;">
0.99415
</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Discussion.</strong> One of the many interesting things about the leave-one-out special case is the ability to replicate estimates exactly. That is, when the size of the fold is only one, then there is no additional uncertainty induced by the cross-validation. This means that analysts can exactly replicate work of one another, an important consideration.</p>
<p>Jackknife statistics were developed to understand precision of estimators, producing estimators of bias and standard deviation in equations <a href="ChapSimulation.html#eq:Biasjack">(8.3)</a> and <a href="ChapSimulation.html#eq:sdjack">(8.4)</a>. This crosses into goals that we have associated with bootstrap techniques, not cross-validation methods. This demonstrates how statistical techniques can be used to achieve different goals.</p>
</div>
<div id="S:Sec843" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Cross-Validation and Bootstrap<a href="ChapSimulation.html#S:Sec843" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The bootstrap is useful in providing estimators of the precision, or variability, of statistics. It can also be useful for model validation. The bootstrap approach to model validation is similar to the leave-one-out and <em>k</em>-fold validation procedures:</p>
<ul>
<li>Create a bootstrap sample by re-sampling (with replacement) <span class="math inline">\(n\)</span> indices in <span class="math inline">\(\{1,\cdots,n\}\)</span>. That will be our <em>training sample</em>. Estimate the model under consideration based on this sample.</li>
<li>The <em>test</em>, or <em>validation sample</em>, consists of those observations not selected for training. Evaluate the fitted model (based on the training data) using the test data.</li>
</ul>
<p>Repeat this process many (say <span class="math inline">\(B\)</span>) times. Take an average over the results and choose the model based on the average evaluation statistic.</p>
<p><strong>Example 8.4.4. Wisconsin Property Fund.</strong> Return to <a href="ChapSimulation.html#Ex:8.3.1">Example 8.3.1</a> where we investigate the fit of the gamma and Pareto distributions on the property fund data. We again compare the predictive performance using the Kolmogorov-Smirnov (<em>KS</em>) statistic but this time using the bootstrap procedure to split the data between training and testing samples. The following provides illustrative code.</p>
<h5 style="text-align: center;">
<a id="displayCode.BootstrapValidation.1" href="javascript:togglecode('toggleCode.BootstrapValidation.1','displayCode.BootstrapValidation.1');"><i><strong>Show R Code for Bootstrapping Validation Procedures</strong></i></a>
</h5>
<div id="toggleCode.BootstrapValidation.1" style="display: none">
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ChapSimulation.html#cb122-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(claim_data)</span>
<span id="cb122-2"><a href="ChapSimulation.html#cb122-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12347</span>)</span>
<span id="cb122-3"><a href="ChapSimulation.html#cb122-3" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb122-4"><a href="ChapSimulation.html#cb122-4" tabindex="-1"></a><span class="co"># Number of Bootstrap Samples</span></span>
<span id="cb122-5"><a href="ChapSimulation.html#cb122-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb122-6"><a href="ChapSimulation.html#cb122-6" tabindex="-1"></a>cvalvec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, B)</span>
<span id="cb122-7"><a href="ChapSimulation.html#cb122-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb122-8"><a href="ChapSimulation.html#cb122-8" tabindex="-1"></a>    bootindex <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(indices, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb122-9"><a href="ChapSimulation.html#cb122-9" tabindex="-1"></a>    traindata <span class="ot">&lt;-</span> claim_data[bootindex, ]</span>
<span id="cb122-10"><a href="ChapSimulation.html#cb122-10" tabindex="-1"></a>    testdata <span class="ot">&lt;-</span> claim_data[<span class="sc">-</span>bootindex, ]</span>
<span id="cb122-11"><a href="ChapSimulation.html#cb122-11" tabindex="-1"></a>    <span class="co"># Pareto</span></span>
<span id="cb122-12"><a href="ChapSimulation.html#cb122-12" tabindex="-1"></a>    fit.pareto <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">data =</span> traindata)</span>
<span id="cb122-13"><a href="ChapSimulation.html#cb122-13" tabindex="-1"></a>    ksResultPareto <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(testdata<span class="sc">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>, <span class="at">loc =</span> <span class="dv">0</span>, <span class="at">shape =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">2</span>]),</span>
<span id="cb122-14"><a href="ChapSimulation.html#cb122-14" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.pareto)[<span class="dv">1</span>]))</span>
<span id="cb122-15"><a href="ChapSimulation.html#cb122-15" tabindex="-1"></a>    cvalvec[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> ksResultPareto<span class="sc">$</span>statistic</span>
<span id="cb122-16"><a href="ChapSimulation.html#cb122-16" tabindex="-1"></a>    <span class="co"># Gamma</span></span>
<span id="cb122-17"><a href="ChapSimulation.html#cb122-17" tabindex="-1"></a>    fit.gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(Claim <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> traindata, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> log))</span>
<span id="cb122-18"><a href="ChapSimulation.html#cb122-18" tabindex="-1"></a>    gamma_theta <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit.gamma)) <span class="sc">*</span> <span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb122-19"><a href="ChapSimulation.html#cb122-19" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">gamma.dispersion</span>(fit.gamma)</span>
<span id="cb122-20"><a href="ChapSimulation.html#cb122-20" tabindex="-1"></a>    ksResultGamma <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(testdata<span class="sc">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="at">shape =</span> alpha, <span class="at">scale =</span> gamma_theta)</span>
<span id="cb122-21"><a href="ChapSimulation.html#cb122-21" tabindex="-1"></a>    cvalvec[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> ksResultGamma<span class="sc">$</span>statistic</span>
<span id="cb122-22"><a href="ChapSimulation.html#cb122-22" tabindex="-1"></a>}</span>
<span id="cb122-23"><a href="ChapSimulation.html#cb122-23" tabindex="-1"></a>KSBoot <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(cvalvec)<span class="sc">/</span>B</span></code></pre></div>
</div>
<p>We did the sampling using <span class="math inline">\(B=\)</span> 100 replications. The average <em>KS</em> statistic for the Pareto distribution was 0.058 compared to the average for the gamma distribution, 0.262. This is consistent with earlier results and provides another piece of evidence that the Pareto is a better model for these data than the gamma.</p>
</div>
</div>
<div id="S:Sec85" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Further Resources and Contributors<a href="ChapSimulation.html#S:Sec85" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Section <a href="ChapSimulation.html#S:Sec842">8.4.2</a> presented the jackknife statistic as an application of (leave one out) cross-validation methods. Another way to present this material is to consider the historical development. <span class="citation">Efron (<a href="bibliography.html#ref-efron1982jackknife">1982</a>)</span> attributes the jackknife idea to <span class="citation">Quenouille (<a href="bibliography.html#ref-quenouille1949approximate">1949</a>)</span>. Even in this simpler time before modern computing power became widely available, the jackknife provided a handy tool to estimate the bias and standard deviation for virtually any statistic. In addition, this provided motivation for the 1979 introduction of the bootstrap in <span class="citation">Efron (<a href="bibliography.html#ref-efron1979bootstrap">1979</a>)</span> (see also <span class="citation">Efron (<a href="bibliography.html#ref-Efron1992">1992</a>)</span>). The bootstrap provided a tool to understand the uncertainty of a statistic, including the standard deviation.</p>
<p>The presentation in this book, outlined in Chapter <a href="ChapDataAnalytics.html#ChapDataAnalytics">2</a>, follows strategies adopted by analysts. We think of the jackknife and the bootstrap as tools that helps one understand qualities of a statistic of interest. In addition, cross-validation is a resampling strategy primarily devoted to model validation. As noted in <span class="citation">Efron (<a href="bibliography.html#ref-efron1982jackknife">1982</a>)</span>, the historical development of cross-validation is a bit murkier. It is a method borne from the very simple strategy of splitting a sample in half, then using a model trained on one half to predict performance in the other half. Comparing cross-validation methods to the jackknifing and bootstrapping techniques, all are based on resampling. In addition, questions of statistical inference naturally overlap with model validation issues, so there is a natural overlap among these methods.</p>
<ul>
<li>For further reading, a classic, and still very readable, introduction to the jackknife and bootstrap is provided by <span class="citation">Efron (<a href="bibliography.html#ref-efron1982jackknife">1982</a>)</span>.</li>
<li>Here are some links to learn more about <a href="https://freakonometrics.hypotheses.org/6470">reproducibility and randomness</a> and how to go
<a href="https://freakonometrics.hypotheses.org/6638">from a random generator to a sample function</a>.</li>
</ul>
<div id="contributors-7" class="section level4 unnumbered hasAnchor">
<h4>Contributors<a href="ChapSimulation.html#contributors-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Arthur Charpentier</strong>, Université du Quebec á Montreal, and <strong>Edward (Jed) Frees</strong>, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter.
<ul>
<li>Chapter reviewers include Yvonne Chueh and Brian Hartman.</li>
</ul></li>
<li><strong>Edward (Jed) Frees</strong>, University of Wisconsin-Madison and Australian National University, is the author of the second edition of this chapter. Email: <a href="mailto:jfrees@bus.wisc.edu" class="email">jfrees@bus.wisc.edu</a> for chapter comments and suggested improvements.
<ul>
<li>This chapter has benefited significantly from suggestions by Hirokazu (Iwahiro) Iwasawa.</li>
</ul></li>
</ul>

<!-- # Chap 1 -->
<!-- # Chap 2 -->
<!-- # Chap 3 -->
<!-- # Chap 4 -->
<!-- # Chap 5 -->
<!-- # Chap 6 -->
<!-- # Chap 7 -->
<!-- # Chap 8 -->
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ChapAggLossModels.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ChBayes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LDAEd2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
