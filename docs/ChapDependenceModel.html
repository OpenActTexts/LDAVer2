<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Quantifying Dependence | Loss Data Analytics   Second Edition</title>
  <meta name="description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Quantifying Dependence | Loss Data Analytics   Second Edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="github-repo" content="https://github.com/OpenActTexts/LDAVer2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Quantifying Dependence | Loss Data Analytics   Second Edition" />
  
  <meta name="twitter:description" content="Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  

<meta name="author" content="An open text authored by the Actuarial Community" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ChapBonusMalus.html"/>
<link rel="next" href="CAppA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YKJD3496MG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YKJD3496MG');
</script>


<!-- Mathjax Version 2-->
<script type='text/x-mathjax-config'>
		MathJax.Hub.Config({
			extensions: ['tex2jax.js'],
			jax: ['input/TeX', 'output/HTML-CSS'],
			tex2jax: {
				inlineMath: [ ['$','$'], ['\\(','\\)'] ],
				displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
				processEscapes: true
			},
			'HTML-CSS': { availableFonts: ['TeX'] }
		});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_HTML"> </script>


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/survey-jquery/survey.jquery.min.js"></script>
<link href="https://unpkg.com/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>


<script>
function markdownConverterEWF() {  
//Create showdown markdown converter
var converter = new showdown.Converter();
converter.setOption('ghCompatibleHeaderId', true);
survey
    .onTextMarkdown
    .add(function (survey, options) {
        //convert the markdown text to html
        var str = converter.makeHtml(options.text);
        //remove root paragraphs <p></p>
        str = str.substring(3);
        str = str.substring(0, str.length - 4);
        //set html
        options.html = str;
        MathJax.Hub.Queue(['Typeset',MathJax.Hub, 'options']);
    });  
};

// Quiz Header info
const jsonHeader = { 
    showProgressBar: "bottom",
    showTimerPanel: "none",
    maxTimeToFinishPage: 10000,
    maxTimeToFinish: 25000,
    firstPageIsStarted: true,
    startSurveyText: "Start Quiz" //,
//    title: "Does This Make Sense?"
}


// One and Two question quizzes
function jsonSummary1EWF(json) {  
let jsonEnd1 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
};  
return jsonEnd1;
};


function jsonSummary2EWF(json) {  
let jsonEnd2 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
};  
return jsonEnd2;
};

// Three, four, and five question quizzes
function jsonSummary3EWF(json) {  
let jsonEnd3 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][3]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][3]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][3]["questions"][0]["correctAnswer"]
};  
return jsonEnd3;
};

function jsonSummary4EWF(json) {  
jsonEnd4 = jsonSummary3EWF(json);
jsonEnd4.completedHtml = jsonEnd4.completedHtml +  
"<br>"+
json["pages"][4]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][4]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][4]["questions"][0]["correctAnswer"]
;  
return jsonEnd4;
};

function jsonSummary5EWF(json) {  
jsonEnd5 = jsonSummary4EWF(json);
jsonEnd5.completedHtml = jsonEnd5.completedHtml +  
"<br>"+
json["pages"][5]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][5]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][5]["questions"][0]["correctAnswer"]
;  
return jsonEnd5;
};

function jsonSummary6EWF(json) {  
jsonEnd6 = jsonSummary5EWF(json);
jsonEnd6.completedHtml = jsonEnd6.completedHtml +  
"<br>"+
json["pages"][6]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][6]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][6]["questions"][0]["correctAnswer"]
;  
return jsonEnd6;
};

function jsonSummary7EWF(json) {  
jsonEnd7 = jsonSummary6EWF(json);
jsonEnd7.completedHtml = jsonEnd7.completedHtml +  
"<br>"+
json["pages"][7]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][7]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][7]["questions"][0]["correctAnswer"]
;  
return jsonEnd7;
};

function jsonSummary8EWF(json) {  
jsonEnd8 = jsonSummary7EWF(json);
jsonEnd8.completedHtml = jsonEnd8.completedHtml +  
"<br>"+
json["pages"][8]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][8]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][8]["questions"][0]["correctAnswer"]
;  
return jsonEnd8;
};

function jsonSummary9EWF(json) {  
jsonEnd9 = jsonSummary8EWF(json);
jsonEnd9.completedHtml = jsonEnd9.completedHtml +  
"<br>"+
json["pages"][9]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][9]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][9]["questions"][0]["correctAnswer"]
;  
return jsonEnd9;
};


function jsonSummary10EWF(json) {  
jsonEnd10 = jsonSummary9EWF(json);
jsonEnd10.completedHtml = jsonEnd10.completedHtml +  
"<br>"+
json["pages"][10]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][10]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][10]["questions"][0]["correctAnswer"]
;  
return jsonEnd10;
};


function jsonSummary11EWF(json) {  
jsonEnd11 = jsonSummary10EWF(json);
jsonEnd11.completedHtml = jsonEnd11.completedHtml +  
"<br>"+
json["pages"][11]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][11]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][11]["questions"][0]["correctAnswer"]
;  
return jsonEnd11;
};

Survey.StylesManager.applyTheme("modern");

</script>  
<!-- This completes the code for the quizzes -->

<!-- Various toggle functions used throughout --> 
<script language="javascript">
function toggle(id1,id2) {
	var ele = document.getElementById(id1); var text = document.getElementById(id2);
	if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Solution";}
		else {ele.style.display = "block"; text.innerHTML = "Hide Solution";}}
function togglecode(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show R Code";}
      else {ele.style.display = "block"; text.innerHTML = "Hide R Code";}}
function toggleEX(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Example";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Example";}}
function toggleTheory(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Theory";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Theory";}}
function toggleQuiz(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Quiz Solution";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Quiz Solution";}}      
</script>

<!-- A few functions for revealing definitions -->
<script language="javascript">
<!--   $( function() {
    $("#tabs").tabs();
  } ); -->

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

<script language="javascript">
function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="Format/style.css" type="text/css" />
<link rel="stylesheet" href="includeWebex/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Loss Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reviewers"><i class="fa fa-check"></i>Reviewers</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-collaborators"><i class="fa fa-check"></i>Other Collaborators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-number"><i class="fa fa-check"></i>Version Number</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-our-readers"><i class="fa fa-check"></i>For our Readers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ChapIntro.html"><a href="ChapIntro.html"><i class="fa fa-check"></i><b>1</b> Loss Data and Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Intro"><i class="fa fa-check"></i><b>1.1</b> Data Driven Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#nature-and-relevance-of-insurance"><i class="fa fa-check"></i><b>1.1.1</b> Nature and Relevance of Insurance</a></li>
<li class="chapter" data-level="1.1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:DataDriven"><i class="fa fa-check"></i><b>1.1.2</b> Why Data Driven?</a></li>
<li class="chapter" data-level="1.1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:InsProcesses"><i class="fa fa-check"></i><b>1.1.3</b> Insurance Processes</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:PredModApps"><i class="fa fa-check"></i><b>1.2</b> Insurance Company Operations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ChapIntro.html"><a href="ChapIntro.html#initiating-insurance"><i class="fa fa-check"></i><b>1.2.1</b> Initiating Insurance</a></li>
<li class="chapter" data-level="1.2.2" data-path="ChapIntro.html"><a href="ChapIntro.html#renewing-insurance"><i class="fa fa-check"></i><b>1.2.2</b> Renewing Insurance</a></li>
<li class="chapter" data-level="1.2.3" data-path="ChapIntro.html"><a href="ChapIntro.html#claims-and-product-management"><i class="fa fa-check"></i><b>1.2.3</b> Claims and Product Management</a></li>
<li class="chapter" data-level="1.2.4" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Reserving"><i class="fa fa-check"></i><b>1.2.4</b> Loss Reserving</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:LGPIF"><i class="fa fa-check"></i><b>1.3</b> Case Study: Wisconsin Property Fund</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:OutComes"><i class="fa fa-check"></i><b>1.3.1</b> Fund Claims Variables: Frequency and Severity</a></li>
<li class="chapter" data-level="1.3.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:FundVariables"><i class="fa fa-check"></i><b>1.3.2</b> Fund Rating Variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="ChapIntro.html"><a href="ChapIntro.html#fund-operations"><i class="fa fa-check"></i><b>1.3.3</b> Fund Operations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ChapIntro.html"><a href="ChapIntro.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
<li class="chapter" data-level="1.5" data-path="ChapIntro.html"><a href="ChapIntro.html#Intro-further-reading-and-resources"><i class="fa fa-check"></i><b>1.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec21"><i class="fa fa-check"></i><b>2.1</b> Elements of Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#key-data-analytic-concepts"><i class="fa fa-check"></i><b>2.1.1</b> Key Data Analytic Concepts</a></li>
<li class="chapter" data-level="2.1.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec212"><i class="fa fa-check"></i><b>2.1.2</b> Data versus Algorithmic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec22"><i class="fa fa-check"></i><b>2.2</b> Data Analysis Process</a></li>
<li class="chapter" data-level="2.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec23"><i class="fa fa-check"></i><b>2.3</b> Single Variable Analytics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec231"><i class="fa fa-check"></i><b>2.3.1</b> Variable Types</a></li>
<li class="chapter" data-level="2.3.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec232"><i class="fa fa-check"></i><b>2.3.2</b> Exploratory versus Confirmatory</a></li>
<li class="chapter" data-level="2.3.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec233"><i class="fa fa-check"></i><b>2.3.3</b> Model Construction</a></li>
<li class="chapter" data-level="2.3.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec234"><i class="fa fa-check"></i><b>2.3.4</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec24"><i class="fa fa-check"></i><b>2.4</b> Analytics with Many Variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#supervised-and-unsupervised-learning"><i class="fa fa-check"></i><b>2.4.1</b> Supervised and Unsupervised Learning</a></li>
<li class="chapter" data-level="2.4.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#algorithmic-modeling"><i class="fa fa-check"></i><b>2.4.2</b> Algorithmic Modeling</a></li>
<li class="chapter" data-level="2.4.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-modeling"><i class="fa fa-check"></i><b>2.4.3</b> Data Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec25"><i class="fa fa-check"></i><b>2.5</b> Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-structures-and-storage"><i class="fa fa-check"></i><b>2.5.2</b> Data Structures and Storage</a></li>
<li class="chapter" data-level="2.5.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> Data Cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec254"><i class="fa fa-check"></i><b>2.5.4</b> Big Data Analysis</a></li>
<li class="chapter" data-level="2.5.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#ethical-issues"><i class="fa fa-check"></i><b>2.5.5</b> Ethical Issues</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec26"><i class="fa fa-check"></i><b>2.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Sec261"><i class="fa fa-check"></i><b>2.6.1</b> Technical Supplement: Multivariate Exploratory Analysis</a></li>
<li class="chapter" data-level="2.6.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#tree-based-models"><i class="fa fa-check"></i><b>2.6.2</b> Tree-based Models</a></li>
<li class="chapter" data-level="2.6.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#technical-supplement-some-r-functions"><i class="fa fa-check"></i><b>2.6.3</b> Technical Supplement: Some R Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html"><i class="fa fa-check"></i><b>3</b> Frequency Modeling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec31"><i class="fa fa-check"></i><b>3.1</b> Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec311"><i class="fa fa-check"></i><b>3.1.1</b> How Frequency Augments Severity Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec32"><i class="fa fa-check"></i><b>3.2</b> Basic Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec321"><i class="fa fa-check"></i><b>3.2.1</b> Foundations</a></li>
<li class="chapter" data-level="3.2.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec322"><i class="fa fa-check"></i><b>3.2.2</b> Moment and Probability Generating Functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec323"><i class="fa fa-check"></i><b>3.2.3</b> Important Frequency Distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec33"><i class="fa fa-check"></i><b>3.3</b> The (<em>a</em>, <em>b</em>, 0) Class</a></li>
<li class="chapter" data-level="3.4" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec34"><i class="fa fa-check"></i><b>3.4</b> Estimating Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec341"><i class="fa fa-check"></i><b>3.4.1</b> Parameter Estimation</a></li>
<li class="chapter" data-level="3.4.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec342"><i class="fa fa-check"></i><b>3.4.2</b> Frequency Distributions MLE</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec35"><i class="fa fa-check"></i><b>3.5</b> Other Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec351"><i class="fa fa-check"></i><b>3.5.1</b> Zero Truncation or Modification</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec36"><i class="fa fa-check"></i><b>3.6</b> Mixture Distributions</a></li>
<li class="chapter" data-level="3.7" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec37"><i class="fa fa-check"></i><b>3.7</b> Real Data Example</a></li>
<li class="chapter" data-level="3.8" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec38"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:Sec39"><i class="fa fa-check"></i><b>3.9</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:rcode"><i class="fa fa-check"></i><b>3.9.1</b> TS 3.A. R Code for Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ChapSeverity.html"><a href="ChapSeverity.html"><i class="fa fa-check"></i><b>4</b> Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec41"><i class="fa fa-check"></i><b>4.1</b> Basic Distributional Quantities</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec411"><i class="fa fa-check"></i><b>4.1.1</b> Moments and Moment Generating Functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec412"><i class="fa fa-check"></i><b>4.1.2</b> Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec42"><i class="fa fa-check"></i><b>4.2</b> Continuous Distributions for Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec421"><i class="fa fa-check"></i><b>4.2.1</b> Gamma Distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec422"><i class="fa fa-check"></i><b>4.2.2</b> Pareto Distribution</a></li>
<li class="chapter" data-level="4.2.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec423"><i class="fa fa-check"></i><b>4.2.3</b> Weibull Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec424"><i class="fa fa-check"></i><b>4.2.4</b> The Generalized Beta Distribution of the Second Kind</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec43"><i class="fa fa-check"></i><b>4.3</b> Methods of Creating New Distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec431"><i class="fa fa-check"></i><b>4.3.1</b> Functions of Random Variables and their Distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec432"><i class="fa fa-check"></i><b>4.3.2</b> Mixture Distributions for Severity</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec44"><i class="fa fa-check"></i><b>4.4</b> Estimating Loss Distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec441"><i class="fa fa-check"></i><b>4.4.1</b> Nonparametric Estimation</a></li>
<li class="chapter" data-level="4.4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec442"><i class="fa fa-check"></i><b>4.4.2</b> Parametric Estimation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec45"><i class="fa fa-check"></i><b>4.5</b> Exercises with a Practical Focus</a></li>
<li class="chapter" data-level="4.6" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Sec46"><i class="fa fa-check"></i><b>4.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html"><i class="fa fa-check"></i><b>5</b> Modeling Claim Severity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec51"><i class="fa fa-check"></i><b>5.1</b> Coverage Modifications</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec511"><i class="fa fa-check"></i><b>5.1.1</b> Policy Deductibles</a></li>
<li class="chapter" data-level="5.1.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec512"><i class="fa fa-check"></i><b>5.1.2</b> Policy Limits</a></li>
<li class="chapter" data-level="5.1.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec513"><i class="fa fa-check"></i><b>5.1.3</b> Coinsurance and Inflation</a></li>
<li class="chapter" data-level="5.1.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec514"><i class="fa fa-check"></i><b>5.1.4</b> Reinsurance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec52"><i class="fa fa-check"></i><b>5.2</b> Parametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec521"><i class="fa fa-check"></i><b>5.2.1</b> Parametric Estimation using Grouped Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec522"><i class="fa fa-check"></i><b>5.2.2</b> Censored Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec523"><i class="fa fa-check"></i><b>5.2.3</b> Truncated Data</a></li>
<li class="chapter" data-level="5.2.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec524"><i class="fa fa-check"></i><b>5.2.4</b> Parametric Estimation using Censored and Truncated Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec53"><i class="fa fa-check"></i><b>5.3</b> Nonparametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec531"><i class="fa fa-check"></i><b>5.3.1</b> Grouped Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec532"><i class="fa fa-check"></i><b>5.3.2</b> Plug-in Principle</a></li>
<li class="chapter" data-level="5.3.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec533"><i class="fa fa-check"></i><b>5.3.3</b> Right-Censored Empirical Distribution Function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Sec54"><i class="fa fa-check"></i><b>5.4</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html"><i class="fa fa-check"></i><b>6</b> Model Selection</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec61"><i class="fa fa-check"></i><b>6.1</b> Tools for Model Selection and Diagnostics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec611"><i class="fa fa-check"></i><b>6.1.1</b> Graphical Comparison of Distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec612"><i class="fa fa-check"></i><b>6.1.2</b> Statistical Comparison of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec62"><i class="fa fa-check"></i><b>6.2</b> Iterative Model Selection</a></li>
<li class="chapter" data-level="6.3" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec63"><i class="fa fa-check"></i><b>6.3</b> Model Selection Based on a Training Dataset</a></li>
<li class="chapter" data-level="6.4" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec64"><i class="fa fa-check"></i><b>6.4</b> Model Selection Based on a Test Dataset</a></li>
<li class="chapter" data-level="6.5" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec65"><i class="fa fa-check"></i><b>6.5</b> Model Selection Based on Cross-Validation</a></li>
<li class="chapter" data-level="6.6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:Sec66"><i class="fa fa-check"></i><b>6.6</b> Model Selection for Modified Data</a></li>
<li class="chapter" data-level="6.7" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#further-resources-and-contributors"><i class="fa fa-check"></i><b>6.7</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html"><i class="fa fa-check"></i><b>7</b> Aggregate Loss Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec71"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec72"><i class="fa fa-check"></i><b>7.2</b> Individual Risk Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec721"><i class="fa fa-check"></i><b>7.2.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.2.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec722"><i class="fa fa-check"></i><b>7.2.2</b> Aggregate Loss Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec73"><i class="fa fa-check"></i><b>7.3</b> Collective Risk Model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec731"><i class="fa fa-check"></i><b>7.3.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.3.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec732"><i class="fa fa-check"></i><b>7.3.2</b> Stop-loss Insurance</a></li>
<li class="chapter" data-level="7.3.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec733"><i class="fa fa-check"></i><b>7.3.3</b> Closed-form Distributions</a></li>
<li class="chapter" data-level="7.3.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec734"><i class="fa fa-check"></i><b>7.3.4</b> Tweedie Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec74"><i class="fa fa-check"></i><b>7.4</b> Computing the Aggregate Claims Distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec741"><i class="fa fa-check"></i><b>7.4.1</b> Recursive Method</a></li>
<li class="chapter" data-level="7.4.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec742"><i class="fa fa-check"></i><b>7.4.2</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec75"><i class="fa fa-check"></i><b>7.5</b> Effects of Coverage Modifications</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec751"><i class="fa fa-check"></i><b>7.5.1</b> Impact of Exposure on Frequency</a></li>
<li class="chapter" data-level="7.5.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec752"><i class="fa fa-check"></i><b>7.5.2</b> Impact of Deductibles on Claim Frequency</a></li>
<li class="chapter" data-level="7.5.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec753"><i class="fa fa-check"></i><b>7.5.3</b> Impact of Policy Modifications on Aggregate Claims</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:Sec76"><i class="fa fa-check"></i><b>7.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.1.-individual-risk-model-properties"><i class="fa fa-check"></i>TS 7.A.1. Individual Risk Model Properties</a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.2.-relationship-between-probability-generating-functions-of-x_i-and-x_it"><i class="fa fa-check"></i>TS 7.A.2. Relationship Between Probability Generating Functions of <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_i^T\)</span></a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.3.-moment-generating-function-of-aggregate-loss-s_n-in-example-7.3.9"><i class="fa fa-check"></i>TS 7.A.3. Moment Generating Function of Aggregate Loss <span class="math inline">\(S_N\)</span> in Example 7.3.9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ChapSimulation.html"><a href="ChapSimulation.html"><i class="fa fa-check"></i><b>8</b> Simulation and Resampling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec81"><i class="fa fa-check"></i><b>8.1</b> Random Number Generation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec811"><i class="fa fa-check"></i><b>8.1.1</b> Generating Independent Uniform Observations</a></li>
<li class="chapter" data-level="8.1.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec812"><i class="fa fa-check"></i><b>8.1.2</b> Inverse Transform Method</a></li>
<li class="chapter" data-level="8.1.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec813"><i class="fa fa-check"></i><b>8.1.3</b> Ready-made Random Number Generators</a></li>
<li class="chapter" data-level="8.1.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec814"><i class="fa fa-check"></i><b>8.1.4</b> Simulating from Complex Distributions</a></li>
<li class="chapter" data-level="8.1.5" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec815"><i class="fa fa-check"></i><b>8.1.5</b> Importance Sampling</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec82"><i class="fa fa-check"></i><b>8.2</b> Computing Distribution Parameters</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec821"><i class="fa fa-check"></i><b>8.2.1</b> Simulating Parameters</a></li>
<li class="chapter" data-level="8.2.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec822"><i class="fa fa-check"></i><b>8.2.2</b> Determining the Number of Simulations</a></li>
<li class="chapter" data-level="8.2.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec823"><i class="fa fa-check"></i><b>8.2.3</b> Simulation and Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec83"><i class="fa fa-check"></i><b>8.3</b> Bootstrapping and Resampling</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec831"><i class="fa fa-check"></i><b>8.3.1</b> Bootstrap Foundations</a></li>
<li class="chapter" data-level="8.3.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec832"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap Precision: Bias, Standard Deviation, and Mean Square Error</a></li>
<li class="chapter" data-level="8.3.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec833"><i class="fa fa-check"></i><b>8.3.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="8.3.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec834"><i class="fa fa-check"></i><b>8.3.4</b> Parametric Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec84"><i class="fa fa-check"></i><b>8.4</b> Model Selection and Cross-Validation</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec841"><i class="fa fa-check"></i><b>8.4.1</b> k-Fold Cross-Validation</a></li>
<li class="chapter" data-level="8.4.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec842"><i class="fa fa-check"></i><b>8.4.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="8.4.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec843"><i class="fa fa-check"></i><b>8.4.3</b> Cross-Validation and Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sec85"><i class="fa fa-check"></i><b>8.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ChBayes.html"><a href="ChBayes.html"><i class="fa fa-check"></i><b>9</b> Bayesian Statistics and Modeling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec91"><i class="fa fa-check"></i><b>9.1</b> A Gentle Introduction to Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec911"><i class="fa fa-check"></i><b>9.1.1</b> Bayesian versus Frequentist Statistics</a></li>
<li class="chapter" data-level="9.1.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec912"><i class="fa fa-check"></i><b>9.1.2</b> A Brief History Lesson</a></li>
<li class="chapter" data-level="9.1.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec913"><i class="fa fa-check"></i><b>9.1.3</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="9.1.4" data-path="ChBayes.html"><a href="ChBayes.html#an-introductory-example-of-bayes-rule"><i class="fa fa-check"></i><b>9.1.4</b> An Introductory Example of Bayes’ Rule</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec92"><i class="fa fa-check"></i><b>9.2</b> Building Blocks of Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec921"><i class="fa fa-check"></i><b>9.2.1</b> Posterior Distribution</a></li>
<li class="chapter" data-level="9.2.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec922"><i class="fa fa-check"></i><b>9.2.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="9.2.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec923"><i class="fa fa-check"></i><b>9.2.3</b> Prior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec93"><i class="fa fa-check"></i><b>9.3</b> Conjugate Families</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec931"><i class="fa fa-check"></i><b>9.3.1</b> The Beta–Binomial Conjugate Family</a></li>
<li class="chapter" data-level="9.3.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec932"><i class="fa fa-check"></i><b>9.3.2</b> The Gamma–Poisson Conjugate Family</a></li>
<li class="chapter" data-level="9.3.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec933"><i class="fa fa-check"></i><b>9.3.3</b> The Normal–Normal Conjugate Family</a></li>
<li class="chapter" data-level="9.3.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec934"><i class="fa fa-check"></i><b>9.3.4</b> Criticism of Conjugate Family Models</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec94"><i class="fa fa-check"></i><b>9.4</b> Posterior Simulation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec941"><i class="fa fa-check"></i><b>9.4.1</b> Introduction to Markov Chain Monte Carlo Methods</a></li>
<li class="chapter" data-level="9.4.2" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec942"><i class="fa fa-check"></i><b>9.4.2</b> The Gibbs Sampler</a></li>
<li class="chapter" data-level="9.4.3" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec943"><i class="fa fa-check"></i><b>9.4.3</b> The Metropolis–Hastings Algorithm</a></li>
<li class="chapter" data-level="9.4.4" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec944"><i class="fa fa-check"></i><b>9.4.4</b> Markov Chain Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec95"><i class="fa fa-check"></i><b>9.5</b> Bayesian Statistics in Practice</a></li>
<li class="chapter" data-level="9.6" data-path="ChBayes.html"><a href="ChBayes.html#S:Sec96"><i class="fa fa-check"></i><b>9.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChBayes.html"><a href="ChBayes.html#contributors-8"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html"><i class="fa fa-check"></i><b>10</b> Premium Foundations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec101"><i class="fa fa-check"></i><b>10.1</b> Introduction to Ratemaking</a></li>
<li class="chapter" data-level="10.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec102"><i class="fa fa-check"></i><b>10.2</b> Data Sources</a></li>
<li class="chapter" data-level="10.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec103"><i class="fa fa-check"></i><b>10.3</b> Claims</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1031"><i class="fa fa-check"></i><b>10.3.1</b> Estimated Ultimate Claims</a></li>
<li class="chapter" data-level="10.3.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1032"><i class="fa fa-check"></i><b>10.3.2</b> Adjustments to Claims and Allocated Claims Adjustment Expenses</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec104"><i class="fa fa-check"></i><b>10.4</b> Exposures</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1041"><i class="fa fa-check"></i><b>10.4.1</b> Criteria for Choosing an Exposure</a></li>
<li class="chapter" data-level="10.4.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1042"><i class="fa fa-check"></i><b>10.4.2</b> Written and Earned Exposures</a></li>
<li class="chapter" data-level="10.4.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1043"><i class="fa fa-check"></i><b>10.4.3</b> Adjustments to Exposures</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec105"><i class="fa fa-check"></i><b>10.5</b> Pure Premiums</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1051"><i class="fa fa-check"></i><b>10.5.1</b> Experience Period</a></li>
<li class="chapter" data-level="10.5.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1052"><i class="fa fa-check"></i><b>10.5.2</b> Expected Pure Premium</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec106"><i class="fa fa-check"></i><b>10.6</b> Non-Claim Expenses</a></li>
<li class="chapter" data-level="10.7" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec107"><i class="fa fa-check"></i><b>10.7</b> Investment Income</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1071"><i class="fa fa-check"></i><b>10.7.1</b> Investment Income on Policyholder Cash Flows</a></li>
<li class="chapter" data-level="10.7.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1072"><i class="fa fa-check"></i><b>10.7.2</b> Investment Income on Surplus</a></li>
<li class="chapter" data-level="10.7.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1073"><i class="fa fa-check"></i><b>10.7.3</b> The Underwriting Profit Provisions</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec108"><i class="fa fa-check"></i><b>10.8</b> The Premium Equation</a></li>
<li class="chapter" data-level="10.9" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec109"><i class="fa fa-check"></i><b>10.9</b> Pricing Principles</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1091"><i class="fa fa-check"></i><b>10.9.1</b> Premium Principles</a></li>
<li class="chapter" data-level="10.9.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1092"><i class="fa fa-check"></i><b>10.9.2</b> Properties of Premium Principles</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1010"><i class="fa fa-check"></i><b>10.10</b> Reviewing Rate Adequacy</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10101"><i class="fa fa-check"></i><b>10.10.1</b> The Loss Ratio Method</a></li>
<li class="chapter" data-level="10.10.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10102"><i class="fa fa-check"></i><b>10.10.2</b> Target Loss Ratio</a></li>
<li class="chapter" data-level="10.10.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10103"><i class="fa fa-check"></i><b>10.10.3</b> Experience Period Loss Ratios</a></li>
<li class="chapter" data-level="10.10.4" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10104"><i class="fa fa-check"></i><b>10.10.4</b> Adjustments to Loss</a></li>
<li class="chapter" data-level="10.10.5" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10105"><i class="fa fa-check"></i><b>10.10.5</b> Premium On-Level Adjustment</a></li>
<li class="chapter" data-level="10.10.6" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10106"><i class="fa fa-check"></i><b>10.10.6</b> Premium Trend</a></li>
<li class="chapter" data-level="10.10.7" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec10107"><i class="fa fa-check"></i><b>10.10.7</b> Credibility</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:Sec1011"><i class="fa fa-check"></i><b>10.11</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#ts-10.a.-rate-regulation"><i class="fa fa-check"></i>TS 10.A. Rate Regulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html"><i class="fa fa-check"></i><b>11</b> Risk Classification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec111"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec112"><i class="fa fa-check"></i><b>11.2</b> Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1121"><i class="fa fa-check"></i><b>11.2.1</b> Need for Poisson Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1122"><i class="fa fa-check"></i><b>11.2.2</b> Poisson Regression</a></li>
<li class="chapter" data-level="11.2.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1123"><i class="fa fa-check"></i><b>11.2.3</b> Incorporating Exposure</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec113"><i class="fa fa-check"></i><b>11.3</b> Categorical Variables and Multiplicative Tariff</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1131"><i class="fa fa-check"></i><b>11.3.1</b> Rating Factors and Tariff</a></li>
<li class="chapter" data-level="11.3.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1132"><i class="fa fa-check"></i><b>11.3.2</b> Multiplicative Tariff Model</a></li>
<li class="chapter" data-level="11.3.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1133"><i class="fa fa-check"></i><b>11.3.3</b> Poisson Regression for Multiplicative Tariff</a></li>
<li class="chapter" data-level="11.3.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1134"><i class="fa fa-check"></i><b>11.3.4</b> Numerical Examples</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec114"><i class="fa fa-check"></i><b>11.4</b> Risk Classification vs Discrimination</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1141"><i class="fa fa-check"></i><b>11.4.1</b> Economic Commodity versus Social Good</a></li>
<li class="chapter" data-level="11.4.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1142"><i class="fa fa-check"></i><b>11.4.2</b> Information Asymmetry</a></li>
<li class="chapter" data-level="11.4.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1143"><i class="fa fa-check"></i><b>11.4.3</b> Sensitive Variables and Regulation</a></li>
<li class="chapter" data-level="11.4.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec1144"><i class="fa fa-check"></i><b>11.4.4</b> Big Data Models and Proxy Discrimination</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec115"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
<li class="chapter" data-level="11.6" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:Sec116"><i class="fa fa-check"></i><b>11.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-11.a.-estimating-poisson-regression-models"><i class="fa fa-check"></i>TS 11.A. Estimating Poisson Regression Models</a></li>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-11.b.-selecting-rating-factors"><i class="fa fa-check"></i>TS 11.B. Selecting Rating Factors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ChapCredibility.html"><a href="ChapCredibility.html"><i class="fa fa-check"></i><b>12</b> Experience Rating Using Credibility Theory</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#introduction-to-applications-of-credibility-theory"><i class="fa fa-check"></i><b>12.1</b> Introduction to Applications of Credibility Theory</a></li>
<li class="chapter" data-level="12.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec122"><i class="fa fa-check"></i><b>12.2</b> Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1221"><i class="fa fa-check"></i><b>12.2.1</b> Credibility-Weighted Estimate for the Expected Loss</a></li>
<li class="chapter" data-level="12.2.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1222"><i class="fa fa-check"></i><b>12.2.2</b> Credibility <em>Z</em>, <em>EPV</em>, and <em>VHM</em></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec123"><i class="fa fa-check"></i><b>12.3</b> Bayesian Inference and Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1231"><i class="fa fa-check"></i><b>12.3.1</b> Beta-Binomial Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1232"><i class="fa fa-check"></i><b>12.3.2</b> Gamma-Poisson Model</a></li>
<li class="chapter" data-level="12.3.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1233"><i class="fa fa-check"></i><b>12.3.3</b> Exact Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec124"><i class="fa fa-check"></i><b>12.4</b> Bühlmann-Straub Credibility</a></li>
<li class="chapter" data-level="12.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec125"><i class="fa fa-check"></i><b>12.5</b> Estimating Credibility Parameters</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#nonparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.1</b> Nonparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
<li class="chapter" data-level="12.5.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#semiparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.2</b> Semiparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec126"><i class="fa fa-check"></i><b>12.6</b> Limited Fluctuation Credibility</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec1261"><i class="fa fa-check"></i><b>12.6.1</b> Full Credibility for Claim Frequency</a></li>
<li class="chapter" data-level="12.6.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-aggregate-losses-and-pure-premium"><i class="fa fa-check"></i><b>12.6.2</b> Full Credibility for Aggregate Losses and Pure Premium</a></li>
<li class="chapter" data-level="12.6.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-severity"><i class="fa fa-check"></i><b>12.6.3</b> Full Credibility for Severity</a></li>
<li class="chapter" data-level="12.6.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#partial-credibility"><i class="fa fa-check"></i><b>12.6.4</b> Partial Credibility</a></li>
<li class="chapter" data-level="12.6.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-standard-for-limited-fluctuation-credibility"><i class="fa fa-check"></i><b>12.6.5</b> Full Credibility Standard for Limited Fluctuation Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec127"><i class="fa fa-check"></i><b>12.7</b> Balancing Credibility Estimators</a></li>
<li class="chapter" data-level="12.8" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Sec128"><i class="fa fa-check"></i><b>12.8</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html"><i class="fa fa-check"></i><b>13</b> Insurance Portfolio Management including Reinsurance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#introduction-to-insurance-portfolios"><i class="fa fa-check"></i><b>13.1</b> Introduction to Insurance Portfolios</a></li>
<li class="chapter" data-level="13.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec132"><i class="fa fa-check"></i><b>13.2</b> Tails of Distributions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#classification-based-on-moments"><i class="fa fa-check"></i><b>13.2.1</b> Classification Based on Moments</a></li>
<li class="chapter" data-level="13.2.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#comparison-based-on-limiting-tail-behavior"><i class="fa fa-check"></i><b>13.2.2</b> Comparison Based on Limiting Tail Behavior</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec133"><i class="fa fa-check"></i><b>13.3</b> Risk Measures</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#value-at-risk"><i class="fa fa-check"></i><b>13.3.1</b> Value-at-Risk</a></li>
<li class="chapter" data-level="13.3.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#expected-shortfall"><i class="fa fa-check"></i><b>13.3.2</b> Expected Shortfall</a></li>
<li class="chapter" data-level="13.3.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1333"><i class="fa fa-check"></i><b>13.3.3</b> Coherent Risk Measures</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec134"><i class="fa fa-check"></i><b>13.4</b> Reinsurance</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1341"><i class="fa fa-check"></i><b>13.4.1</b> Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1342"><i class="fa fa-check"></i><b>13.4.2</b> Non-Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec1343"><i class="fa fa-check"></i><b>13.4.3</b> Additional Reinsurance Treaties</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#exercises-2"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
<li class="chapter" data-level="13.6" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Sec136"><i class="fa fa-check"></i><b>13.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html"><i class="fa fa-check"></i><b>14</b> Loss Reserving</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec141"><i class="fa fa-check"></i><b>14.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1412"><i class="fa fa-check"></i><b>14.1.1</b> Closed, IBNR, and RBNS Claims</a></li>
<li class="chapter" data-level="14.1.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1411"><i class="fa fa-check"></i><b>14.1.2</b> Why Reserving?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec142"><i class="fa fa-check"></i><b>14.2</b> Loss Reserve Data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1421"><i class="fa fa-check"></i><b>14.2.1</b> From Micro to Macro</a></li>
<li class="chapter" data-level="14.2.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1422"><i class="fa fa-check"></i><b>14.2.2</b> Run-off Triangles</a></li>
<li class="chapter" data-level="14.2.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1423"><i class="fa fa-check"></i><b>14.2.3</b> Loss Reserve Notation</a></li>
<li class="chapter" data-level="14.2.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1424"><i class="fa fa-check"></i><b>14.2.4</b> R Code to Summarize Loss Reserve Data</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec143"><i class="fa fa-check"></i><b>14.3</b> The Chain-Ladder Method</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1431"><i class="fa fa-check"></i><b>14.3.1</b> The Deterministic Chain-Ladder</a></li>
<li class="chapter" data-level="14.3.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1432"><i class="fa fa-check"></i><b>14.3.2</b> Mack’s Distribution-Free Chain-Ladder Model</a></li>
<li class="chapter" data-level="14.3.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec1433"><i class="fa fa-check"></i><b>14.3.3</b> R code for Chain-Ladder Predictions</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec144"><i class="fa fa-check"></i><b>14.4</b> GLMs and Bootstrap for Loss Reserves</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-specification"><i class="fa fa-check"></i><b>14.4.1</b> Model Specification</a></li>
<li class="chapter" data-level="14.4.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-estimation-and-prediction"><i class="fa fa-check"></i><b>14.4.2</b> Model Estimation and Prediction</a></li>
<li class="chapter" data-level="14.4.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#bootstrap"><i class="fa fa-check"></i><b>14.4.3</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Sec145"><i class="fa fa-check"></i><b>14.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html"><i class="fa fa-check"></i><b>15</b> Experience Rating using Bonus-Malus</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec151"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec152"><i class="fa fa-check"></i><b>15.2</b> <em>BMS</em> in Several Countries</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#bms-in-malaysia"><i class="fa fa-check"></i><b>15.2.1</b> <em>BMS</em> in Malaysia</a></li>
<li class="chapter" data-level="15.2.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#bms-in-other-countries"><i class="fa fa-check"></i><b>15.2.2</b> <em>BMS</em> in Other Countries</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec153"><i class="fa fa-check"></i><b>15.3</b> <em>BMS</em> and Markov Chain Model</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#transition-probability"><i class="fa fa-check"></i><b>15.3.1</b> Transition Probability</a></li>
<li class="chapter" data-level="15.3.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#some-applications"><i class="fa fa-check"></i><b>15.3.2</b> Some Applications</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec154"><i class="fa fa-check"></i><b>15.4</b> <em>BMS</em> and Stationary Distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution"><i class="fa fa-check"></i><b>15.4.1</b> Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-a-stationary-distribution"><i class="fa fa-check"></i><b>15.4.2</b> <code>R</code> Code for a Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-evolution"><i class="fa fa-check"></i><b>15.4.3</b> Premium Evolution</a></li>
<li class="chapter" data-level="15.4.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-premium-evolution"><i class="fa fa-check"></i><b>15.4.4</b> <code>R</code> Code for Premium Evolution</a></li>
<li class="chapter" data-level="15.4.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#convergence-rate"><i class="fa fa-check"></i><b>15.4.5</b> Convergence Rate</a></li>
<li class="chapter" data-level="15.4.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-convergence-rate"><i class="fa fa-check"></i><b>15.4.6</b> <code>R</code> Code for Convergence Rate</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec155"><i class="fa fa-check"></i><b>15.5</b> <em>BMS</em> and Premium Rating</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-rating"><i class="fa fa-check"></i><b>15.5.1</b> Premium Rating</a></li>
<li class="chapter" data-level="15.5.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#a-priori-risk-classification"><i class="fa fa-check"></i><b>15.5.2</b> A Priori Risk Classification</a></li>
<li class="chapter" data-level="15.5.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#modelling-of-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.3</b> Modelling of Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution-allowing-for-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.4</b> Stationary Distribution Allowing for Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#determination-of-optimal-relativities"><i class="fa fa-check"></i><b>15.5.5</b> Determination of Optimal Relativities</a></li>
<li class="chapter" data-level="15.5.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#numerical-illustrations"><i class="fa fa-check"></i><b>15.5.6</b> Numerical Illustrations</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Sec156"><i class="fa fa-check"></i><b>15.6</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html"><i class="fa fa-check"></i><b>16</b> Quantifying Dependence</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec161"><i class="fa fa-check"></i><b>16.1</b> Classic Measures of Scalar Associations</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#association-measures-for-quantitative-variables"><i class="fa fa-check"></i><b>16.1.1</b> Association Measures for Quantitative Variables</a></li>
<li class="chapter" data-level="16.1.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1612"><i class="fa fa-check"></i><b>16.1.2</b> Rank Based Measures</a></li>
<li class="chapter" data-level="16.1.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1613"><i class="fa fa-check"></i><b>16.1.3</b> Tail Dependence Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec162"><i class="fa fa-check"></i><b>16.2</b> Introduction to Copulas</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#definition-of-a-copula"><i class="fa fa-check"></i><b>16.2.1</b> Definition of a Copula</a></li>
<li class="chapter" data-level="16.2.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#sklars-theorem"><i class="fa fa-check"></i><b>16.2.2</b> Sklar’s Theorem</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec163"><i class="fa fa-check"></i><b>16.3</b> Application Using Copulas</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#marginal-models"><i class="fa fa-check"></i><b>16.3.1</b> Marginal Models</a></li>
<li class="chapter" data-level="16.3.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1632"><i class="fa fa-check"></i><b>16.3.2</b> Probability Integral Transformation</a></li>
<li class="chapter" data-level="16.3.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#joint-modeling-with-copula-function"><i class="fa fa-check"></i><b>16.3.3</b> Joint Modeling with Copula Function</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec164"><i class="fa fa-check"></i><b>16.4</b> Types of Copulas</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#normal-gaussian-copulas"><i class="fa fa-check"></i><b>16.4.1</b> Normal (Gaussian) Copulas</a></li>
<li class="chapter" data-level="16.4.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#t--and-elliptical-copulas"><i class="fa fa-check"></i><b>16.4.2</b> <em>t</em>- and Elliptical Copulas</a></li>
<li class="chapter" data-level="16.4.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#archimedean-copulas"><i class="fa fa-check"></i><b>16.4.3</b> Archimedean Copulas</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#properties-of-copulas"><i class="fa fa-check"></i><b>16.5</b> Properties of Copulas</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1651"><i class="fa fa-check"></i><b>16.5.1</b> Bounds on Association</a></li>
<li class="chapter" data-level="16.5.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec1652"><i class="fa fa-check"></i><b>16.5.2</b> Measures of Association</a></li>
<li class="chapter" data-level="16.5.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#tail-dependency"><i class="fa fa-check"></i><b>16.5.3</b> Tail Dependency</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec166"><i class="fa fa-check"></i><b>16.6</b> Importance of Dependence Modeling</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#why-is-dependence-modeling-important"><i class="fa fa-check"></i><b>16.6.1</b> Why is Dependence Modeling Important?</a></li>
<li class="chapter" data-level="16.6.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#copula-regression"><i class="fa fa-check"></i><b>16.6.2</b> Copula Regression</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Sec167"><i class="fa fa-check"></i><b>16.7</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#ts-16.a.-other-classic-measures-of-scalar-associations"><i class="fa fa-check"></i>TS 16.A. Other Classic Measures of Scalar Associations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="CAppA.html"><a href="CAppA.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Review of Statistical Inference</a>
<ul>
<li class="chapter" data-level="17.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec171"><i class="fa fa-check"></i><b>17.1</b> Basic Concepts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1711"><i class="fa fa-check"></i><b>17.1.1</b> Random Sampling</a></li>
<li class="chapter" data-level="17.1.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1712"><i class="fa fa-check"></i><b>17.1.2</b> Sampling Distribution</a></li>
<li class="chapter" data-level="17.1.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec1713"><i class="fa fa-check"></i><b>17.1.3</b> Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec172"><i class="fa fa-check"></i><b>17.2</b> Point Estimation and Properties</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1721"><i class="fa fa-check"></i><b>17.2.1</b> Method of Moments Estimation</a></li>
<li class="chapter" data-level="17.2.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1722"><i class="fa fa-check"></i><b>17.2.2</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec173"><i class="fa fa-check"></i><b>17.3</b> Interval Estimation</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1731"><i class="fa fa-check"></i><b>17.3.1</b> Exact Distribution for Normal Sample Mean</a></li>
<li class="chapter" data-level="17.3.2" data-path="CAppA.html"><a href="CAppA.html#large-sample-properties-of-mle"><i class="fa fa-check"></i><b>17.3.2</b> Large-sample Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="17.3.3" data-path="CAppA.html"><a href="CAppA.html#confidence-interval"><i class="fa fa-check"></i><b>17.3.3</b> Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="CAppA.html"><a href="CAppA.html#S:Sec174"><i class="fa fa-check"></i><b>17.4</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="CAppA.html"><a href="CAppA.html#S:Sec1741"><i class="fa fa-check"></i><b>17.4.1</b> Basic Concepts</a></li>
<li class="chapter" data-level="17.4.2" data-path="CAppA.html"><a href="CAppA.html#S:Sec1742"><i class="fa fa-check"></i><b>17.4.2</b> Student-<em>t</em> test based on <em>mle</em></a></li>
<li class="chapter" data-level="17.4.3" data-path="CAppA.html"><a href="CAppA.html#S:Sec1743"><i class="fa fa-check"></i><b>17.4.3</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="17.4.4" data-path="CAppA.html"><a href="CAppA.html#S:Sec1744"><i class="fa fa-check"></i><b>17.4.4</b> Information Criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="CAppB.html"><a href="CAppB.html"><i class="fa fa-check"></i><b>18</b> Appendix B: Iterated Expectations</a>
<ul>
<li class="chapter" data-level="18.1" data-path="CAppB.html"><a href="CAppB.html#S:Sec181"><i class="fa fa-check"></i><b>18.1</b> Conditional Distribution and Conditional Expectation</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="CAppB.html"><a href="CAppB.html#conditional-distribution"><i class="fa fa-check"></i><b>18.1.1</b> Conditional Distribution</a></li>
<li class="chapter" data-level="18.1.2" data-path="CAppB.html"><a href="CAppB.html#conditional-expectation-and-conditional-variance"><i class="fa fa-check"></i><b>18.1.2</b> Conditional Expectation and Conditional Variance</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="CAppB.html"><a href="CAppB.html#S:Sec182"><i class="fa fa-check"></i><b>18.2</b> Iterated Expectations and Total Variance</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="CAppB.html"><a href="CAppB.html#S:Sec1821"><i class="fa fa-check"></i><b>18.2.1</b> Law of Iterated Expectations</a></li>
<li class="chapter" data-level="18.2.2" data-path="CAppB.html"><a href="CAppB.html#law-of-total-variance"><i class="fa fa-check"></i><b>18.2.2</b> Law of Total Variance</a></li>
<li class="chapter" data-level="18.2.3" data-path="CAppB.html"><a href="CAppB.html#application"><i class="fa fa-check"></i><b>18.2.3</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="CAppB.html"><a href="CAppB.html#S:Sec183"><i class="fa fa-check"></i><b>18.3</b> Conjugate Distributions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="CAppB.html"><a href="CAppB.html#linear-exponential-family"><i class="fa fa-check"></i><b>18.3.1</b> Linear Exponential Family</a></li>
<li class="chapter" data-level="18.3.2" data-path="CAppB.html"><a href="CAppB.html#S:Sec1832"><i class="fa fa-check"></i><b>18.3.2</b> Conjugate Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="CAppC.html"><a href="CAppC.html"><i class="fa fa-check"></i><b>19</b> Appendix C: Maximum Likelihood Theory</a>
<ul>
<li class="chapter" data-level="19.1" data-path="CAppC.html"><a href="CAppC.html#S:Sec191"><i class="fa fa-check"></i><b>19.1</b> Likelihood Function</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="CAppC.html"><a href="CAppC.html#likelihood-and-log-likelihood-functions"><i class="fa fa-check"></i><b>19.1.1</b> Likelihood and Log-likelihood Functions</a></li>
<li class="chapter" data-level="19.1.2" data-path="CAppC.html"><a href="CAppC.html#properties-of-likelihood-functions"><i class="fa fa-check"></i><b>19.1.2</b> Properties of Likelihood Functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="CAppC.html"><a href="CAppC.html#S:Sec192"><i class="fa fa-check"></i><b>19.2</b> Maximum Likelihood Estimators</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="CAppC.html"><a href="CAppC.html#definition-and-derivation-of-mle"><i class="fa fa-check"></i><b>19.2.1</b> Definition and Derivation of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.2" data-path="CAppC.html"><a href="CAppC.html#asymptotic-properties-of-mle"><i class="fa fa-check"></i><b>19.2.2</b> Asymptotic Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.3" data-path="CAppC.html"><a href="CAppC.html#use-of-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>19.2.3</b> Use of Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="CAppC.html"><a href="CAppC.html#S:Sec193"><i class="fa fa-check"></i><b>19.3</b> Statistical Inference Based on Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="CAppC.html"><a href="CAppC.html#hypothesis-testing"><i class="fa fa-check"></i><b>19.3.1</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="19.3.2" data-path="CAppC.html"><a href="CAppC.html#S:Sec1932"><i class="fa fa-check"></i><b>19.3.2</b> <em>MLE</em> and Model Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html"><i class="fa fa-check"></i><b>20</b> Appendix D: Summary of Distributions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:DiscreteDistributions"><i class="fa fa-check"></i><b>20.1</b> Discrete Distributions</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab0-class"><i class="fa fa-check"></i><b>20.1.1</b> The <em>(a,b,0)</em> Class</a></li>
<li class="chapter" data-level="20.1.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab1-class"><i class="fa fa-check"></i><b>20.1.2</b> The <em>(a,b,1)</em> Class</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:ContinuousDistributions"><i class="fa fa-check"></i><b>20.2</b> Continuous Distributions</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#one-parameter-distributions"><i class="fa fa-check"></i><b>20.2.1</b> One Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#two-parameter-distributions"><i class="fa fa-check"></i><b>20.2.2</b> Two Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#three-parameter-distributions"><i class="fa fa-check"></i><b>20.2.3</b> Three Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.4" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#four-parameter-distribution"><i class="fa fa-check"></i><b>20.2.4</b> Four Parameter Distribution</a></li>
<li class="chapter" data-level="20.2.5" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#other-distributions"><i class="fa fa-check"></i><b>20.2.5</b> Other Distributions</a></li>
<li class="chapter" data-level="20.2.6" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#distributions-with-finite-support"><i class="fa fa-check"></i><b>20.2.6</b> Distributions with Finite Support</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#limited-expected-values"><i class="fa fa-check"></i><b>20.3</b> Limited Expected Values</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html"><i class="fa fa-check"></i><b>21</b> Appendix E: Conventions for Notation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:General"><i class="fa fa-check"></i><b>21.1</b> General Conventions</a></li>
<li class="chapter" data-level="21.2" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Abbreviations"><i class="fa fa-check"></i><b>21.2</b> Abbreviations</a></li>
<li class="chapter" data-level="21.3" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:StatSymbols"><i class="fa fa-check"></i><b>21.3</b> Common Statistical Symbols and Operators</a></li>
<li class="chapter" data-level="21.4" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Symbols"><i class="fa fa-check"></i><b>21.4</b> Common Mathematical Symbols and Functions</a></li>
<li class="chapter" data-level="21.5" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#further-readings"><i class="fa fa-check"></i><b>21.5</b> Further Readings</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="DataResources.html"><a href="DataResources.html"><i class="fa fa-check"></i><b>22</b> Appendix. Data Resources</a>
<ul>
<li class="chapter" data-level="22.1" data-path="DataResources.html"><a href="DataResources.html#S:WiscPropFundA"><i class="fa fa-check"></i><b>22.1</b> Wisconsin Property Fund</a></li>
<li class="chapter" data-level="22.2" data-path="DataResources.html"><a href="DataResources.html#Sec:DataTravel"><i class="fa fa-check"></i><b>22.2</b> ANU Corporate Travel Data</a></li>
<li class="chapter" data-level="22.3" data-path="DataResources.html"><a href="DataResources.html#Sec:DataGPA"><i class="fa fa-check"></i><b>22.3</b> ANU Group Personal Accident Data</a></li>
<li class="chapter" data-level="22.4" data-path="DataResources.html"><a href="DataResources.html#Sec:DataAuto"><i class="fa fa-check"></i><b>22.4</b> ANU Motor Vehicle Data</a></li>
<li class="chapter" data-level="22.5" data-path="DataResources.html"><a href="DataResources.html#spanish-personal-insurance-data"><i class="fa fa-check"></i><b>22.5</b> Spanish Personal Insurance Data</a></li>
<li class="chapter" data-level="22.6" data-path="DataResources.html"><a href="DataResources.html#S:CASDatasets"><i class="fa fa-check"></i><b>22.6</b> ‘R’ Package CASdatasets</a></li>
<li class="chapter" data-level="22.7" data-path="DataResources.html"><a href="DataResources.html#other-data-sources"><i class="fa fa-check"></i><b>22.7</b> Other Data Sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/OpenActTexts/Loss-Data-Analytics" target="blank">Loss Data Analytics on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Loss Data Analytics <br> Second Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ChapDependenceModel" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Quantifying Dependence<a href="ChapDependenceModel.html#ChapDependenceModel" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Chapter Preview</em>. Dependence modeling involves using statistical models to describe the dependence structure between random variables and enables us to understand the relationships between variables in a dataset. This chapter introduces readers to techniques for modeling and quantifying dependence or association of multivariate distributions. Section <a href="ChapDependenceModel.html#S:Sec161">16.1</a> elaborates basic measures for modeling the dependence between variables.</p>
<p>Section <a href="ChapDependenceModel.html#S:Sec162">16.2</a> introduces an approach to modeling dependence using copulas which is reinforced with practical illustrations in Section <a href="ChapDependenceModel.html#S:Sec163">16.3</a>. The types of copula families and basic properties of copula functions are explained in Section <a href="ChapDependenceModel.html#S:Sec164">16.4</a>. The chapter concludes by explaining why the study of dependence modeling is important in Section <a href="ChapDependenceModel.html#S:Sec166">16.6</a>.</p>
<div id="S:Sec161" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Classic Measures of Scalar Associations<a href="ChapDependenceModel.html#S:Sec161" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Estimate correlation using the Pearson method</li>
<li>Use rank based measures like Spearman, Kendall to estimate correlation</li>
<li>Measure tail dependency</li>
</ul>
<hr />
<p>In this chapter, we consider the first two variables from an insurance dataset of sample size (<span class="math inline">\(n = 1500\)</span>) introduced in <span class="citation">Frees and Valdez (<a href="bibliography.html#ref-frees1998understanding" role="doc-biblioref">1998</a>)</span> and is now readily available in the <code>copula</code> package; <em>losses</em> and <em>expenses</em>.</p>
<ul>
<li><span class="math inline">\({\tt LOSS}\)</span>, general liability claims from the Insurance Services Office, Inc. (ISO)</li>
<li><span class="math inline">\({\tt ALAE}\)</span>, specifically attributable to the settlement of individual claims (e.g. lawyer’s fees, claims investigation expenses)</li>
</ul>
<p>We would like to know whether the distribution of <span class="math inline">\({\tt LOSS}\)</span> depends on the distribution of <span class="math inline">\({\tt ALAE}\)</span> or whether they are statistically independent. To visualize the relationship between losses and expenses, the scatterplots in Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a> are created on dollar and log dollar scales. It is difficult to see any relationship between the two variables in the left-hand panel. Their dependence is more evident when viewed on the log scale, as in the right-hand panel. This section elaborates basic measures for modeling the dependence between variables.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig161"></span>
<img src="LDAEd2_files/figure-html/Fig161-1.png" alt="Scatter Plot of LOSS and ALAE" width="80%" />
<p class="caption">
Figure 16.1: <strong>Scatter Plot of LOSS and ALAE</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.ScaHis.1" href="javascript:togglecode('toggleCode.ScaHis.1','displayCode.ScaHis.1');"><i><strong>R Code for Loss versus Expense Scatterplots</strong></i></a>
</h5>
<div id="toggleCode.ScaHis.1" style="display: none">
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="ChapDependenceModel.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb231-2"><a href="ChapDependenceModel.html#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(loss)  <span class="co"># loss data from copula library</span></span>
<span id="cb231-3"><a href="ChapDependenceModel.html#cb231-3" aria-hidden="true" tabindex="-1"></a>LOSS <span class="ot">&lt;-</span> loss<span class="sc">$</span>loss</span>
<span id="cb231-4"><a href="ChapDependenceModel.html#cb231-4" aria-hidden="true" tabindex="-1"></a>ALAE <span class="ot">&lt;-</span> loss<span class="sc">$</span>alae</span>
<span id="cb231-5"><a href="ChapDependenceModel.html#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb231-6"><a href="ChapDependenceModel.html#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LOSS, ALAE, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2200000</span>),</span>
<span id="cb231-7"><a href="ChapDependenceModel.html#cb231-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">520000</span>))  <span class="co"># dollar scale</span></span>
<span id="cb231-8"><a href="ChapDependenceModel.html#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;LOSS&quot;</span>, <span class="at">line =</span> <span class="fl">1.8</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb231-9"><a href="ChapDependenceModel.html#cb231-9" aria-hidden="true" tabindex="-1"></a>xtick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">400000</span>, <span class="dv">800000</span>, <span class="dv">1200000</span>, <span class="dv">1600000</span>, <span class="dv">2000000</span>)</span>
<span id="cb231-10"><a href="ChapDependenceModel.html#cb231-10" aria-hidden="true" tabindex="-1"></a>xticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;10K&quot;</span>, <span class="st">&quot;400K&quot;</span>, <span class="st">&quot;800K&quot;</span>, <span class="st">&quot;1.2M&quot;</span>, <span class="st">&quot;1.6M&quot;</span>, <span class="st">&quot;2.0M&quot;</span>)</span>
<span id="cb231-11"><a href="ChapDependenceModel.html#cb231-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> xtick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb231-12"><a href="ChapDependenceModel.html#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> xtick, <span class="sc">-</span><span class="dv">35000</span>, <span class="at">labels =</span> xticklab, <span class="at">pos =</span> <span class="dv">1</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb231-13"><a href="ChapDependenceModel.html#cb231-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-14"><a href="ChapDependenceModel.html#cb231-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">text =</span> <span class="st">&quot;ALAE&quot;</span>, <span class="at">line =</span> <span class="fl">3.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb231-15"><a href="ChapDependenceModel.html#cb231-15" aria-hidden="true" tabindex="-1"></a>ytick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">100000</span>, <span class="dv">200000</span>, <span class="dv">300000</span>, <span class="dv">400000</span>, <span class="dv">500000</span>)</span>
<span id="cb231-16"><a href="ChapDependenceModel.html#cb231-16" aria-hidden="true" tabindex="-1"></a>yticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;5K&quot;</span>, <span class="st">&quot;100K&quot;</span>, <span class="st">&quot;200K&quot;</span>, <span class="st">&quot;300K&quot;</span>, <span class="st">&quot;400K&quot;</span>, <span class="st">&quot;500K&quot;</span>)</span>
<span id="cb231-17"><a href="ChapDependenceModel.html#cb231-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> ytick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb231-18"><a href="ChapDependenceModel.html#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">400000</span>, <span class="at">y =</span> ytick, <span class="at">labels =</span> yticklab, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb231-19"><a href="ChapDependenceModel.html#cb231-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-20"><a href="ChapDependenceModel.html#cb231-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(LOSS), <span class="fu">log</span>(ALAE), <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>,</span>
<span id="cb231-21"><a href="ChapDependenceModel.html#cb231-21" aria-hidden="true" tabindex="-1"></a>    <span class="fl">14.60397</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">14.60397</span>))  <span class="co"># log scale</span></span>
<span id="cb231-22"><a href="ChapDependenceModel.html#cb231-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-23"><a href="ChapDependenceModel.html#cb231-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;log(LOSS)&quot;</span>, <span class="at">line =</span> <span class="fl">1.8</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb231-24"><a href="ChapDependenceModel.html#cb231-24" aria-hidden="true" tabindex="-1"></a>xtick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)</span>
<span id="cb231-25"><a href="ChapDependenceModel.html#cb231-25" aria-hidden="true" tabindex="-1"></a>xticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;14&quot;</span>)</span>
<span id="cb231-26"><a href="ChapDependenceModel.html#cb231-26" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> xtick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb231-27"><a href="ChapDependenceModel.html#cb231-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> xtick, <span class="fl">1.2</span>, <span class="at">labels =</span> xticklab, <span class="at">pos =</span> <span class="dv">1</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb231-28"><a href="ChapDependenceModel.html#cb231-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-29"><a href="ChapDependenceModel.html#cb231-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-30"><a href="ChapDependenceModel.html#cb231-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">text =</span> <span class="st">&quot;log(ALAE)&quot;</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb231-31"><a href="ChapDependenceModel.html#cb231-31" aria-hidden="true" tabindex="-1"></a>ytick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)</span>
<span id="cb231-32"><a href="ChapDependenceModel.html#cb231-32" aria-hidden="true" tabindex="-1"></a>yticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;14&quot;</span>)</span>
<span id="cb231-33"><a href="ChapDependenceModel.html#cb231-33" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> ytick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb231-34"><a href="ChapDependenceModel.html#cb231-34" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">0.25</span>, <span class="at">y =</span> ytick, <span class="at">labels =</span> yticklab, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="association-measures-for-quantitative-variables" class="section level3 hasAnchor" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> Association Measures for Quantitative Variables<a href="ChapDependenceModel.html#association-measures-for-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this section, consider a pair of random variables <span class="math inline">\((X,Y)\)</span> having joint distribution function <span class="math inline">\(F(\cdot)\)</span> and a random sample <span class="math inline">\((X_i,Y_i), i=1, \ldots, n\)</span>. For the continuous case, suppose that <span class="math inline">\(F(\cdot)\)</span> has absolutely continuous marginals with marginal density functions.</p>
<div id="pearson-correlation" class="section level4 unnumbered hasAnchor">
<h4>Pearson Correlation<a href="ChapDependenceModel.html#pearson-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define the sample covariance function <span class="math inline">\(\widehat{Cov}(X,Y) = \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})\)</span>, where <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\bar{Y}\)</span> are the sample means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, respectively. Then, the <a href="#" class="tooltip" style="color:green"><em>product-moment (Pearson) correlation</em><span style="font-size:8pt">Pearson correlation, a measure of the linear correlation between two variables</span></a> can be written as
<span class="math display">\[
r = \frac{\widehat{Cov}(X,Y)}{\sqrt{\widehat{Cov}(X,X)\widehat{Cov}(Y,Y)}}
= \frac{\widehat{Cov}(X,Y)}{\sqrt{\widehat{Var}(X)}\sqrt{\widehat{Var}(Y)}}.
\]</span>
The correlation statistic <span class="math inline">\(r\)</span> is widely used to capture linear association between random variables. It is a (nonparametric) estimator of the correlation parameter <span class="math inline">\(\rho\)</span>, defined to be the covariance divided by the product of standard deviations.</p>
<p>This statistic has several important features. Unlike regression estimators, it is symmetric between random variables, so the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> equals the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. It is unchanged by linear transformations of random variables (up to sign changes) so that we can multiply random variables or add constants as is helpful for interpretation. The range of the statistic is <span class="math inline">\([-1,1]\)</span> which does not depend on the distribution of either <span class="math inline">\(X\)</span> or <span class="math inline">\(Y\)</span>.</p>
<p>Further, in the case of independence, the correlation coefficient <span class="math inline">\(r\)</span> is 0. However, it is well known that zero correlation does not in general imply independence, one exception is the case of normally distributed random variables. The correlation statistic <span class="math inline">\(r\)</span> is also a (maximum likelihood) estimator of the association parameter for the bivariate normal distribution. So, for normally distributed data, the correlation statistic <span class="math inline">\(r\)</span> can be used to assess independence. For additional interpretations of this well-known statistic, readers will enjoy <span class="citation">Lee Rodgers and Nicewander (<a href="bibliography.html#ref-lee1988thirteen" role="doc-biblioref">1998</a>)</span>.</p>
<p>You can obtain the <a href="#" class="tooltip" style="color:green"><em>Pearson correlation</em><span style="font-size:8pt">A measure of the linear correlation between two variables</span></a> statistic <span class="math inline">\(r\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>pearson</code> method. This is demonstrated below by using the <span class="math inline">\({\tt LOSS}\)</span> rating variable in millions of dollars and <span class="math inline">\({\tt ALAE}\)</span> amount variable in dollars from the dataset in Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a>.</p>
<h5 style="text-align: center;">
<a id="displayCode.pearson.1" href="javascript:togglecode('toggleCode.pearson.1','displayCode.pearson.1');"><i><strong>R Code for Pearson Correlation Statistic</strong></i></a>
</h5>
<div id="toggleCode.pearson.1" style="display: none">
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ChapDependenceModel.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Pearson correlation between LOSS and ALAE</span></span>
<span id="cb232-2"><a href="ChapDependenceModel.html#cb232-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,ALAE, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb232-3"><a href="ChapDependenceModel.html#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">2</span>)</span>
<span id="cb232-4"><a href="ChapDependenceModel.html#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="ChapDependenceModel.html#cb232-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb232-6"><a href="ChapDependenceModel.html#cb232-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4</span></span>
<span id="cb232-7"><a href="ChapDependenceModel.html#cb232-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-8"><a href="ChapDependenceModel.html#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Pearson correlation between log(LOSS) and log(ALAE)</span></span>
<span id="cb232-9"><a href="ChapDependenceModel.html#cb232-9" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,<span class="fu">log</span>(ALAE), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb232-10"><a href="ChapDependenceModel.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">2</span>)</span>
<span id="cb232-11"><a href="ChapDependenceModel.html#cb232-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-12"><a href="ChapDependenceModel.html#cb232-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb232-13"><a href="ChapDependenceModel.html#cb232-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.33</span></span></code></pre></div>
</div>
<p>From the <code>R</code> output above, <span class="math inline">\(r=0.4\)</span>, which indicates a positive association between <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span>. This means that as the loss amount of a claim increases we expect expenses to increase.</p>
</div>
</div>
<div id="S:Sec1612" class="section level3 hasAnchor" number="16.1.2">
<h3><span class="header-section-number">16.1.2</span> Rank Based Measures<a href="ChapDependenceModel.html#S:Sec1612" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="spearmans-rho" class="section level4 unnumbered hasAnchor">
<h4>Spearman’s Rho<a href="ChapDependenceModel.html#spearmans-rho" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Pearson correlation coefficient does have the drawback that it is not invariant to nonlinear transforms of the data. For example, the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(\log Y\)</span> can be quite different from the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. As we see from the <code>R</code> code for the Pearson correlation statistic above, the correlation statistic <span class="math inline">\(r\)</span> between the <span class="math inline">\({\tt ALAE}\)</span> variable in logarithmic dollars and the <span class="math inline">\({\tt LOSS}\)</span> amounts variable in dollars is <span class="math inline">\(0.33\)</span> as compared to <span class="math inline">\(0.4\)</span> when we calculate the correlation between the <span class="math inline">\({\tt ALAE}\)</span> variable in dollars and the <span class="math inline">\({\tt LOSS}\)</span> amounts variable in dollars. This limitation is one reason for considering alternative statistics.</p>
<p>Alternative measures of correlation are based on ranks of the data. Let <span class="math inline">\(R(X_j)\)</span> denote the rank of <span class="math inline">\(X_j\)</span> from the sample <span class="math inline">\(X_1, \ldots, X_n\)</span> and similarly for <span class="math inline">\(R(Y_j)\)</span>. Let <span class="math inline">\(R(X) = \left(R(X_1), \ldots, R(X_n)\right)&#39;\)</span> denote the vector of ranks, and similarly for <span class="math inline">\(R(Y)\)</span>. For example, if <span class="math inline">\(n=3\)</span> and <span class="math inline">\(X=(24, 13, 109)\)</span>, then <span class="math inline">\(R(X)=(2,1,3)\)</span>. A comprehensive introduction of rank statistics can be found in, for example, <span class="citation">Hettmansperger (<a href="bibliography.html#ref-hettmansperger1984statistical" role="doc-biblioref">1984</a>)</span>. Also, ranks can be used to obtain the empirical distribution function, refer to Section <a href="ChapSeverity.html#S:Sec441">4.4.1</a> for more on the empirical distribution function.</p>
<p>With this, the correlation measure of <span class="citation">Spearman (<a href="bibliography.html#ref-spearman1904proof" role="doc-biblioref">1904</a>)</span> is simply the product-moment correlation computed on the ranks:
<span class="math display">\[
r_S = \frac{\widehat{Cov}(R(X),R(Y))}{\sqrt{\widehat{Cov}(R(X),R(X))\widehat{Cov}(R(Y),R(Y))}}
= \frac{\widehat{Cov}(R(X),R(Y))}{(n^2-1)/12} .
\]</span>
You can obtain the Spearman correlation statistic <span class="math inline">\(r_S\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>spearman</code> method. From below, the Spearman correlation between the <span class="math inline">\({\tt LOSS}\)</span> variable and <span class="math inline">\({\tt ALAE}\)</span> variable is <span class="math inline">\(0.45\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.spearman.1" href="javascript:togglecode('toggleCode.spearman.1','displayCode.spearman.1');"><i><strong>R Code for Spearman Correlation Statistic</strong></i></a>
</h5>
<div id="toggleCode.spearman.1" style="display: none">
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="ChapDependenceModel.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Spearman correlation between LOSS and ALAE </span><span class="al">###</span></span>
<span id="cb233-2"><a href="ChapDependenceModel.html#cb233-2" aria-hidden="true" tabindex="-1"></a>rs<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,ALAE, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb233-3"><a href="ChapDependenceModel.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs,<span class="dv">2</span>)</span>
<span id="cb233-4"><a href="ChapDependenceModel.html#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="ChapDependenceModel.html#cb233-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb233-6"><a href="ChapDependenceModel.html#cb233-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.45</span></span>
<span id="cb233-7"><a href="ChapDependenceModel.html#cb233-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-8"><a href="ChapDependenceModel.html#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Spearman correlation between LOSS and log(ALAE) </span><span class="al">###</span></span>
<span id="cb233-9"><a href="ChapDependenceModel.html#cb233-9" aria-hidden="true" tabindex="-1"></a>rs<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,<span class="fu">log</span>(ALAE), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb233-10"><a href="ChapDependenceModel.html#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs,<span class="dv">2</span>)</span>
<span id="cb233-11"><a href="ChapDependenceModel.html#cb233-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-12"><a href="ChapDependenceModel.html#cb233-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb233-13"><a href="ChapDependenceModel.html#cb233-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.45</span></span></code></pre></div>
</div>
<p>We can show that the Spearman correlation statistic is invariant under strictly increasing transformations. From the <code>R</code> Code for the Spearman correlation statistic above, <span class="math inline">\(r_S=0.45\)</span> between the <span class="math inline">\({\tt ALAE}\)</span> variable in logarithmic dollars and <span class="math inline">\({\tt LOSS}\)</span> amount variable in dollars.</p>
<p><strong>Example 16.1.1. Calculation by Hand.</strong> You are given the following six observations:
<span class="math display">\[
\small{
\begin{array}{|c|c|c|}
\hline \textbf{Observation} &amp; x \textbf{ value} &amp; y \textbf{ value}\\
\hline 1 &amp; 15 &amp; 19  \\
\hline 2 &amp; 9 &amp; 7  \\
\hline 3 &amp; 5 &amp; 13   \\
\hline 4 &amp; 3 &amp; 15   \\
\hline 5 &amp; 21 &amp; 17   \\
\hline 6 &amp; 12 &amp; 11   \\
\hline
\end{array}
}
\]</span>
Calculate the sample Spearman’s <span class="math inline">\(\rho\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayExample.16.1.1" href="javascript:toggleEX('toggleExample.16.1.1','displayExample.16.1.1');"><i><strong>Show Example Solution</strong></i></a>
</h5>
<div id="toggleExample.16.1.1" style="display: none">
<p><em>Example Solution.</em> The Spearman correlation is simply the product-moment correlation computed on the ranks:
<span class="math display">\[
\small{
r_S = \frac{\widehat{Cov}(R(X),R(Y))}{\sqrt{\widehat{Cov}(R(X),R(X))\widehat{Cov}(R(Y),R(Y))}}
= \frac{\widehat{Cov}(R(X),R(Y))}{(n^2-1)/12} .
}
\]</span>
where <span class="math inline">\(\widehat{Cov}(X,Y) = \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})\)</span>.</p>
<p>Then we have:</p>
<p><span class="math display">\[
\scriptsize
\begin{array}{|c|c|c|c|c|c|c|c|}
\hline \textbf{Obs} &amp; x  &amp; y  &amp;\textbf{Rank of} &amp; \textbf{Rank of}  &amp; R(X)_i - \bar{R(X)}&amp; R(Y)_i - \bar{R(Y)} &amp;(R(X)_i - \bar{R(X)}) \times \\
   &amp; \textbf{ value}&amp; \textbf{ value} &amp; x_i ~~ (R(X)) &amp; y_i  ~~ (R(Y)) &amp; &amp; &amp;(R(Y)_i - \bar{R(Y)}) \\
\hline 1 &amp; 15 &amp; 19. &amp; 2 &amp; 1    &amp; 2-3.5=-1.5 &amp; 1-3.5=-2.5 &amp; 3.75\\
\hline 2 &amp; 9 &amp; 7  &amp; 4 &amp; 6     &amp;  4-3.5=0.5 &amp;  6-3.5= 2.5 &amp; 1.25\\
\hline 3 &amp; 5 &amp; 13  &amp; 5 &amp;4     &amp; 5-3.5=1.5  &amp;  4-3.5= 0.5&amp; 0.75\\
\hline 4 &amp; 3 &amp; 15  &amp; 6 &amp; 3    &amp; 6-3.5=2.5 &amp;  3-3.5= -0.5&amp;-1.25\\
\hline 5 &amp; 21 &amp; 17  &amp; 1 &amp; 2   &amp; 1-3.5=-2.5  &amp; 2-3.5= -1.5&amp; 3.75\\
\hline 6 &amp; 12 &amp; 11  &amp; 3 &amp; 5   &amp; 3-3.5=-0.5 &amp; 5-3.5= 1.5&amp; -0.75\\
\hline Total &amp;  &amp;  &amp;  &amp;   &amp; &amp; &amp; 7.5\\
\hline
\end{array}
\]</span>
***
Note that: <span class="math inline">\(\bar{R(X)}=\bar{R(Y)}=\frac{1+2+3+4+5+6}{6}=3.5\)</span>.</p>
<p>Then,
<span class="math display">\[
\widehat{Cov}(R(X),R(Y))=\frac{1}{n} \sum_{i=1}^n (R(X)_i - \bar{R(X)})(R(Y)_i - \bar{R(Y)})=\frac{7.5}{6}=1.25.
\]</span>
Applying the formula
<span class="math display">\[
r_S = \frac{\widehat{Cov}(R(X),R(Y))}{(n^2-1)/12}=\frac{1.25}{(6^2-1)/12}=0.42857 .
\]</span>
***</p>
</div>
<hr />
</div>
<div id="kendalls-tau" class="section level4 unnumbered hasAnchor">
<h4>Kendall’s Tau<a href="ChapDependenceModel.html#kendalls-tau" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An alternative measure that uses ranks is based on the concept of <em>concordance</em>. An observation pair <span class="math inline">\((X,Y)\)</span> is said to be <a href="#" class="tooltip" style="color:green"><em>concordant</em><span style="font-size:8pt">An observation pair (x,y) is said to be concordant if the observation with a larger value of x has also the larger value of y</span></a> (<a href="#" class="tooltip" style="color:green"><em>discordant</em><span style="font-size:8pt">An observation pair (x,y) is said to be discordant if the observation with a larger value of x has the smaller value of y</span></a>) if the observation with a larger value of <span class="math inline">\(X\)</span> has also the larger (smaller) value of <span class="math inline">\(Y\)</span>. Then <span class="math inline">\(\Pr(concordance) = \Pr[ (X_1-X_2)(Y_1-Y_2) &gt;0 ]\)</span> , <span class="math inline">\(\Pr(discordance) = \Pr[ (X_1-X_2)(Y_1-Y_2) &lt;0 ]\)</span>, <span class="math inline">\(\Pr(tie) = \Pr[ (X_1-X_2)(Y_1-Y_2) =0 ]\)</span> and
<span class="math display">\[
\begin{array}{rl}
\tau(X,Y) &amp;= \Pr(concordance) - \Pr(discordance) \\
&amp; = 2\Pr(concordance) - 1 + \Pr(tie).
\end{array}
\]</span>
Thus, the population parameter Kendall’s tau, <span class="math inline">\(\tau=\tau(X,Y)\)</span>, measures whether higher values of one variable generally correspond to higher values of another variables, regardless of the actual values of those variables.</p>
<p>To estimate this, the pairs <span class="math inline">\((X_i,Y_i)\)</span> and <span class="math inline">\((X_j,Y_j)\)</span> are said to be concordant if the product <span class="math inline">\(sgn(X_j-X_i)sgn(Y_j-Y_i)\)</span> equals 1 and discordant if the product equals -1. Here, <span class="math inline">\(sgn(x)=1,0,-1\)</span> as <span class="math inline">\(x&gt;0\)</span>, <span class="math inline">\(x=0\)</span>, <span class="math inline">\(x&lt;0\)</span>, respectively. With this, we can express the (statistical) association measure of <span class="citation">Maurice G. Kendall (<a href="bibliography.html#ref-kendall1938new" role="doc-biblioref">1938</a>)</span>, known as <a href="#" class="tooltip" style="color:green"><em>Kendall’s tau</em><span style="font-size:8pt"></span></a>, as
<span class="math display">\[
\begin{array}{rl}
\hat{\tau} &amp;= \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(X_j-X_i) \times sgn(Y_j-Y_i)\\
&amp;= \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(R(X_j)-R(X_i)) \times sgn(R(Y_j)-R(Y_i)) .
\end{array}
\]</span>
Interestingly, <span class="citation">Hougaard (<a href="bibliography.html#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, page 137, attributes the original discovery of this statistic to <span class="citation">Fechner (<a href="bibliography.html#ref-fechnerkollektivmasslehre" role="doc-biblioref">1897</a>)</span>, noting that Kendall’s discovery was independent and more complete than the original work.</p>
<p>You can obtain Kendall’s tau using the <code>cor()</code> function in <code>R</code> and selecting the <code>kendall</code> method. From below, <span class="math inline">\(\hat{\tau}=0.32\)</span> between the <span class="math inline">\({\tt LOSS}\)</span> variable in dollars and the <span class="math inline">\({\tt ALAE}\)</span> variable in dollars. When there are ties in the data, the <code>cor()</code> function computes <em>Kendall’s tau_b</em> as proposed by <span class="citation">M. G. Kendall (<a href="bibliography.html#ref-kendall1945" role="doc-biblioref">1945</a>)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.kendall.1" href="javascript:togglecode('toggleCode.kendall.1','displayCode.kendall.1');"><i><strong>R Code for Kendall’s Tau</strong></i></a>
</h5>
<div id="toggleCode.kendall.1" style="display: none">
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ChapDependenceModel.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Kendall&#39;s tau correlation between LOSS and ALAE </span><span class="al">###</span></span>
<span id="cb234-2"><a href="ChapDependenceModel.html#cb234-2" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,ALAE, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))</span>
<span id="cb234-3"><a href="ChapDependenceModel.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(tau,<span class="dv">2</span>)</span>
<span id="cb234-4"><a href="ChapDependenceModel.html#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="ChapDependenceModel.html#cb234-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb234-6"><a href="ChapDependenceModel.html#cb234-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.32</span></span>
<span id="cb234-7"><a href="ChapDependenceModel.html#cb234-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-8"><a href="ChapDependenceModel.html#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Kendall&#39;s tau correlation between LOSS and log(ALAE) </span><span class="al">###</span></span>
<span id="cb234-9"><a href="ChapDependenceModel.html#cb234-9" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="fu">cor</span>(LOSS,<span class="fu">log</span>(ALAE), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))</span>
<span id="cb234-10"><a href="ChapDependenceModel.html#cb234-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(tau,<span class="dv">2</span>)</span>
<span id="cb234-11"><a href="ChapDependenceModel.html#cb234-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-12"><a href="ChapDependenceModel.html#cb234-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb234-13"><a href="ChapDependenceModel.html#cb234-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.32</span></span></code></pre></div>
</div>
<p>Also, to show that the Kendall’s tau is invariant under strictly increasing transformations, we see that <span class="math inline">\(\hat{\tau}=0.32\)</span> between the <span class="math inline">\({\tt ALAE}\)</span> variable in logarithmic dollars and the <span class="math inline">\({\tt LOSS}\)</span> amount variable in dollars.</p>
<p><strong>Example 16.1.2. Calculation by Hand.</strong> You are given the following six observations:
<span class="math display">\[
\small{
\begin{array}{|c|c|c|}
\hline \textbf{Observation} &amp; x \textbf{ value} &amp; y \textbf{ value}\\
\hline 1 &amp; 15 &amp; 19  \\
\hline 2 &amp; 9 &amp; 7  \\
\hline 3 &amp; 5 &amp; 13   \\
\hline 4 &amp; 3 &amp; 15   \\
\hline 5 &amp; 21 &amp; 17   \\
\hline 6 &amp; 12 &amp; 11   \\
\hline
\end{array}
}
\]</span>
Calculate the sample Kendall’s <span class="math inline">\(\tau\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayExample.16.1.2" href="javascript:toggleEX('toggleExample.16.1.2','displayExample.16.1.2');"><i><strong>Show Example Solution</strong></i></a>
</h5>
<div id="toggleExample.16.1.2" style="display: none">
<p><em>Example Solution.</em> We can obtain the Kendall’s tau using:
<span class="math display">\[
\hat{\tau} = \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(X_j-X_i) \times sgn(Y_j-Y_i)
\]</span>
Here, <span class="math inline">\(sgn(x)=1,0,-1\)</span> as <span class="math inline">\(x&gt;0\)</span>, <span class="math inline">\(x=0\)</span>, <span class="math inline">\(x&lt;0\)</span>, respectively. For each pair of observations <span class="math inline">\(i,j\)</span> so that <span class="math inline">\(i&lt;j\)</span>, the pairs <span class="math inline">\((X_i,Y_i)\)</span> and <span class="math inline">\((X_j,Y_j)\)</span> are said to be concordant if the product <span class="math inline">\(sgn(X_j-X_i)sgn(Y_j-Y_i)\)</span> equals 1 and discordant if the product equals -1. This is summarized in the table below, where a 1 indicates concordance, -1 sign indicates discordance. Note: The pairs compared are in the upper triangle.
<span class="math display">\[
\small \begin{array}{|c|c|c|c|c|c|c|}
\hline i/ j &amp; j=1 &amp; j=2 &amp; j=3 &amp; j=4 &amp; j=5 &amp; j=6\\
\hline i=1    &amp;       &amp; 1     &amp; 1         &amp; 1     &amp; -1        &amp; 1\\
\hline i=2    &amp;       &amp;       &amp; -1        &amp;-1     &amp; 1        &amp;1 \\
\hline i=3    &amp;       &amp;       &amp;           &amp;-1     &amp; 1        &amp; -1\\
\hline i=4    &amp;       &amp;       &amp;           &amp;       &amp; 1        &amp; -1 \\
\hline i=5    &amp;       &amp;       &amp;           &amp;       &amp;           &amp; 1\\
\hline i=6    &amp;       &amp;       &amp;           &amp;       &amp;           &amp;  \\
\hline
\end{array}
\]</span>
There are 9 concordant pairs and 6 discordant pairs. Applying the formula
<span class="math display">\[
\hat{\tau} = \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(X_j-X_i) \times sgn(Y_j-Y_i)=\frac{2}{6(6-1)}(3)=0.2 .
\]</span></p>
</div>
<hr />
</div>
</div>
<div id="S:Sec1613" class="section level3 hasAnchor" number="16.1.3">
<h3><span class="header-section-number">16.1.3</span> Tail Dependence Coefficients<a href="ChapDependenceModel.html#S:Sec1613" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tail dependence is a statistical concept that measures the strength of the dependence between two variables in the tails of their distribution. Specifically, tail dependence measures the correlation or dependence between the extreme values of two variables beyond a certain threshold, that is, the dependence in the corner of the lower-left quadrant or upper-right quadrant of the bivariate distribution. Tail dependence is essential in many areas of finance, economics, and risk management. For example, it is relevant in analyzing extreme events, such as financial crashes, natural disasters, and pandemics. In these situations, tail dependence can help to determine the likelihood of joint extreme events occurring and to develop strategies to manage the associated risks.</p>
<p>In Figure <a href="ChapDependenceModel.html#fig:Fig162">16.2</a>, the concept of tail dependence is demonstrated through an example. The figure showcases two randomly generated variables with a Kendall’s Tau of 0.7. On the left side of Figure <a href="ChapDependenceModel.html#fig:Fig162">16.2</a>, the variables (<span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>) are simulated using the bivariate normal distribution, while on the right side, they are generated using the bivariate <span class="math inline">\(t\)</span>-distribution. Although both sides display a Kendall’s Tau of 0.7, there is a difference in the upper right quadrant (above the dashed lines) on each panel. In the left panel, the values in the upper right quadrant (upper tails of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>) are independent, while in the right panel, the upper tail values appear to be correlated (the upper right corners of the right panel contain 4 points). This suggests that the probability of <span class="math inline">\(Y\)</span> occurring above a high threshold (e.g., the dashed line in the figure) when <span class="math inline">\(X\)</span> exceeds the same threshold is higher in the right panel than in the left panel of Figure <a href="ChapDependenceModel.html#fig:Fig162">16.2</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig162"></span>
<img src="LDAEd2_files/figure-html/Fig162-1.png" alt="Left Panel: Upper tails of \(X\) and \(Y\) are independent. Right Panel: Upper tails of \(X\) and \(Y\) appear to be dependent." width="90%" />
<p class="caption">
Figure 16.2: <strong>Left Panel: Upper tails of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent. Right Panel: Upper tails of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> appear to be dependent.</strong>
</p>
</div>
<p>Consider a pair of random variables <span class="math inline">\((X,Y)\)</span>, from definitions provided in Joe (1997), the upper tail dependent coefficient denoted by <span class="math inline">\(\lambda_{\text{up}}\)</span> is given by:</p>
<p><span class="math display">\[
\lambda_\text{up} {=} \lim _{u \rightarrow 1^-} \mathrm{Pr}\left\{X&gt;F_X^{-1}(u) \mid Y&gt;F_Y^{-1}(u)\right\},
\]</span>
in case the limit exists. Here, <span class="math inline">\(F_X^{-1}(u)\)</span> and <span class="math inline">\(F_Y^{-1}(u)\)</span> denote the quantiles of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> at the level <span class="math inline">\(u\)</span>. Then, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are said to be upper tail-dependent if <span class="math inline">\(\lambda_\text{up}\in(0,1]\)</span> and upper tail-independent if <span class="math inline">\(\lambda_\text{up}=0\)</span>. When a variable reaches an extreme high value, the upper tail-dependent condition indicates that the other variable also reaches an extremely high value. On the other hand, the upper tail-independent suggests that the extreme values of the two variables are not related to each other. Similarly, the lower tail dependence coefficient, <span class="math inline">\(\lambda_{\text{lo}}\)</span>, is defined as:
<span class="math display">\[
\lambda_{\text{lo}} {=} \lim _{u \rightarrow 0^+} \mathrm{Pr}\left\{X \leq F_X^{-1}(u) \mid Y \leq F_Y^{-1}(u)\right\} .
\]</span>
Let <span class="math inline">\(R(X_j)\)</span> and <span class="math inline">\(R(Y_j)\)</span> denote the rank of <span class="math inline">\(X_j\)</span> and <span class="math inline">\(Y_j\)</span>, <span class="math inline">\(j=1,\ldots, n\)</span>, respectively. From <span class="citation">Schmidt (<a href="bibliography.html#ref-Schmidt05" role="doc-biblioref">2005</a>)</span>, non-parametric estimates of <span class="math inline">\(\lambda_\text{up}\)</span> and <span class="math inline">\(\lambda_\text{lo}\)</span> are given by:
<span class="math display">\[
\hat{\lambda}_{\text{lo}}=\frac{1}{k} \sum_{j=1}^n I\left\{R(X_j)\leq k, R(Y_j) \leq k\right\},
\]</span>
and
<span class="math display">\[
\begin{aligned}
\hat{\lambda}_{\text{up}} &amp; =\frac{1}{k} \sum_{j=1}^n I\left\{R(X_j)&gt;n-k, R(Y_j)&gt;n-k\right\},
\end{aligned}
\]</span>
where <span class="math inline">\(k \in {1, . . .,n}\)</span> is the threshold rank and a parameter to be chosen by the analyst, <span class="math inline">\(k=k(n) \rightarrow \infty \text { and } k / n \rightarrow 0 \text { as } n \rightarrow \infty \text {, }\)</span>. Here, <span class="math inline">\(n\)</span> is the sample size, and <span class="math inline">\(I\{\cdot\}\)</span> takes the value of 1 if the condition is satisfied, and 0 otherwise.</p>
<p>Figure <a href="ChapDependenceModel.html#fig:Fig163">16.3</a> shows the scatter plot of the ranks of the <span class="math inline">\({\tt LOSS}\)</span> variable and the <span class="math inline">\({\tt ALAE}\)</span> variable. You can obtain the upper and lower tail dependent coefficient using the <code>tdc()</code> function from the <code>FRAPO</code> package in <code>R</code>. From below, <span class="math inline">\(\hat{\lambda}_{\text{up}}=0.39\)</span>, at <span class="math inline">\(k=75\)</span> (note that <span class="math inline">\(n=1500\)</span>), between the <span class="math inline">\({\tt LOSS}\)</span> variable and the <span class="math inline">\({\tt ALAE}\)</span> variable and <span class="math inline">\(\hat{\lambda}_{\text{lo}}=0.13\)</span>. The results implies the losses and expenses variables appear to be more upper-tailed dependent.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig163"></span>
<img src="LDAEd2_files/figure-html/Fig163-1.png" alt="Scatter Plot of Ranks of LOSS and ALAE" width="374.4" />
<p class="caption">
Figure 16.3: <strong>Scatter Plot of Ranks of LOSS and ALAE</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.TDC.1" href="javascript:togglecode('toggleCode.TDC.1','displayCode.TDC.1');"><i><strong>R Code for Tail Dependence Coefficient</strong></i></a>
</h5>
<div id="toggleCode.TDC.1" style="display: none">
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="ChapDependenceModel.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FRAPO)</span>
<span id="cb235-2"><a href="ChapDependenceModel.html#cb235-2" aria-hidden="true" tabindex="-1"></a>Lambda_up<span class="ot">&lt;-</span><span class="fu">tdc</span>(<span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(LOSS,ALAE)),<span class="at">lower =</span> F, <span class="at">k=</span><span class="dv">75</span>)</span>
<span id="cb235-3"><a href="ChapDependenceModel.html#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Lambda_up,<span class="dv">2</span>)</span>
<span id="cb235-4"><a href="ChapDependenceModel.html#cb235-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-5"><a href="ChapDependenceModel.html#cb235-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb235-6"><a href="ChapDependenceModel.html#cb235-6" aria-hidden="true" tabindex="-1"></a>    LOSS ALAE</span>
<span id="cb235-7"><a href="ChapDependenceModel.html#cb235-7" aria-hidden="true" tabindex="-1"></a>LOSS <span class="fl">1.00</span> <span class="fl">0.39</span></span>
<span id="cb235-8"><a href="ChapDependenceModel.html#cb235-8" aria-hidden="true" tabindex="-1"></a>ALAE <span class="fl">0.39</span> <span class="fl">1.00</span></span>
<span id="cb235-9"><a href="ChapDependenceModel.html#cb235-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-10"><a href="ChapDependenceModel.html#cb235-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-11"><a href="ChapDependenceModel.html#cb235-11" aria-hidden="true" tabindex="-1"></a>Lambda_lo<span class="ot">&lt;-</span><span class="fu">tdc</span>(<span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(LOSS,ALAE)),<span class="at">lower =</span> T, <span class="at">k=</span><span class="dv">75</span>)</span>
<span id="cb235-12"><a href="ChapDependenceModel.html#cb235-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Lambda_lo,<span class="dv">2</span>)</span>
<span id="cb235-13"><a href="ChapDependenceModel.html#cb235-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-14"><a href="ChapDependenceModel.html#cb235-14" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb235-15"><a href="ChapDependenceModel.html#cb235-15" aria-hidden="true" tabindex="-1"></a>     LOSS ALAE</span>
<span id="cb235-16"><a href="ChapDependenceModel.html#cb235-16" aria-hidden="true" tabindex="-1"></a>LOSS <span class="fl">1.00</span> <span class="fl">0.13</span></span>
<span id="cb235-17"><a href="ChapDependenceModel.html#cb235-17" aria-hidden="true" tabindex="-1"></a>ALAE <span class="fl">0.13</span> <span class="fl">1.00</span></span></code></pre></div>
</div>
<div id="surveyElement161">

</div>
<div id="surveyResult161">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz161.1" href="javascript:toggleQuiz
('display.Quiz161.2','display.Quiz161.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz161.2" style="display: none">
<p id="Quiz161Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz161.js">
</script>
</div>
</div>
<div id="S:Sec162" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Introduction to Copulas<a href="ChapDependenceModel.html#S:Sec162" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Describe a multivariate distribution function in terms of a copula function.</li>
</ul>
<hr />
<div id="definition-of-a-copula" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> Definition of a Copula<a href="ChapDependenceModel.html#definition-of-a-copula" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Copulas are widely used in insurance and many other fields to model the dependence among multivariate outcomes as they expresses the dependence between the variables explicitly. Recall that the joint cumulative distribution function (<span class="math inline">\(cdf\)</span>) for two variables <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> is given by:
<span class="math display">\[
{F}(y_1, y_2)= {\Pr}(Y_1 \leq y_1, Y_2 \leq y_2) .
\]</span>
For the multivariate case in <span class="math inline">\(p\)</span> dimensions, we have:
<span class="math display">\[
{F}(y_1,\ldots, y_p)= {\Pr}(Y_1 \leq y_1,\ldots ,Y_p \leq y_p) .
\]</span>
The joint distribution considers both the marginal distributions and how the variables are related to each other. However, it expresses this dependence implicitly. Copulas offer a different method that allows us to break down the joint distribution of variables into individual components (the marginal distributions and a copula) that can be adjusted separately.</p>
<p>A <a href="#" class="tooltip" style="color:green"><em>copula</em><span style="font-size:8pt">A multivariate distribution function with uniform marginals</span></a> is a multivariate distribution function with uniform marginals. Specifically, let <span class="math inline">\(\{U_1, \ldots, U_p\}\)</span> be <span class="math inline">\(p\)</span> uniform random variables on <span class="math inline">\((0,1)\)</span>. Their distribution function <span class="math display">\[{C}(u_1, \ldots, u_p) = \Pr(U_1 \leq u_1, \ldots, U_p \leq u_p),\]</span></p>
<p>is a copula. We seek to use copulas in applications that are based on more than just uniformly distributed data. Thus, consider arbitrary marginal distribution functions <span class="math inline">\({F}_1(y_1)\)</span>,…,<span class="math inline">\({F}_p(y_p)\)</span>. Then, we can define a multivariate distribution function using the copula such that
<span class="math display" id="eq:DFDefined">\[\begin{equation}
{F}(y_1, \ldots, y_p)= {C}({F}_1(y_1), \ldots, {F}_p(y_p)).
\tag{16.1}
\end{equation}\]</span>
Here, <span class="math inline">\(F\)</span> is a multivariate distribution function, and the resulting value from the copula function is limited to a range of <span class="math inline">\([0,1]\)</span> as it relates to probabilities. <span class="citation">Sklar (<a href="bibliography.html#ref-sklar1959fonctions" role="doc-biblioref">1959</a>)</span> showed that <span class="math inline">\(any\)</span> multivariate distribution function <span class="math inline">\(F\)</span>, can be written in the form of equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>, that is, using a copula representation.</p>
<p>Sklar also showed that, if the marginal distributions are continuous, then there is a unique copula representation. Hence, copulas can be used instead of joint distribution functions. In order to be considered valid, they must meet the necessary requirements of a valid joint cumulative distribution function. In this chapter we focus on copula modeling with continuous variables. A copula <span class="math inline">\(C\)</span> is considered to be <strong>absolutely continuous</strong> if the <strong>density</strong>
<span class="math display">\[
c(u_1, \ldots, u_p)=\frac{\partial^p}{\partial_{u_p}\ldots \partial_{u_1}}C(u_1, \ldots, u_p),
\]</span>
exists. For the discrete case, readers can see <span class="citation">Joe (<a href="bibliography.html#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span> and <span class="citation">Genest and Nešlohva (<a href="bibliography.html#ref-genest2007methods" role="doc-biblioref">2007</a>)</span>. For the bivariate case where <span class="math inline">\(p=2\)</span>, we can write a copula and the distribution function of two random variables as
<span class="math display">\[
{C}(u_1, \, u_2) = \Pr(U_1 \leq u_1, \, U_2 \leq u_2)
\]</span>
and
<span class="math display">\[
{F}(y_1, \, y_2)= {C}({F}_1(y_1),  {F}_p(y_2)).
\]</span>
One example of a bivariate copula is the product copula, also called the independence copula, as it captures the property of independence of the two variables <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>. The copula (distribution function) is
<span class="math display">\[
{F}(y_1, \, y_2)= {C}({F}_1(y_1),  {F}_p(y_2))={F}_1(y_1){F}_p(y_2)=u_1u_2=\Pi(u).
\]</span>
In Figure <a href="ChapDependenceModel.html#fig:Fig164">16.4</a>, both the distribution function and scatter plot of observations generated from the independence copula are displayed. The scatter plot indicates that there is no correlation between the two components, <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig164"></span>
<img src="LDAEd2_files/figure-html/Fig164-1.png" alt="Independence Copula. Left: Scatterplot of observations from Independence Copula. Right: Plot for distribution function for Independence Copula." width="768" />
<p class="caption">
Figure 16.4: <strong>Independence Copula.</strong> Left: Scatterplot of observations from Independence Copula. Right: Plot for distribution function for Independence Copula.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.IndPlot.1" href="javascript:togglecode('toggleCode.IndPlot.1','displayCode.IndPlot.1');"><i><strong>R Code for Independence Copula Plots</strong></i></a>
</h5>
<div id="toggleCode.IndPlot.1" style="display: none">
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="ChapDependenceModel.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb236-2"><a href="ChapDependenceModel.html#cb236-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb236-3"><a href="ChapDependenceModel.html#cb236-3" aria-hidden="true" tabindex="-1"></a>ic <span class="ot">&lt;-</span> <span class="fu">indepCopula</span>(<span class="at">dim =</span> d)</span>
<span id="cb236-4"><a href="ChapDependenceModel.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb236-5"><a href="ChapDependenceModel.html#cb236-5" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(<span class="dv">1000</span>, <span class="at">copula =</span> ic)  <span class="co"># generate a sample</span></span>
<span id="cb236-6"><a href="ChapDependenceModel.html#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U, <span class="at">xlab =</span> <span class="fu">quote</span>(u[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(u[<span class="dv">2</span>]), <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb236-7"><a href="ChapDependenceModel.html#cb236-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-8"><a href="ChapDependenceModel.html#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">text =</span> <span class="fu">quote</span>(u[<span class="dv">1</span>]), <span class="at">line =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb236-9"><a href="ChapDependenceModel.html#cb236-9" aria-hidden="true" tabindex="-1"></a>xtick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb236-10"><a href="ChapDependenceModel.html#cb236-10" aria-hidden="true" tabindex="-1"></a><span class="co"># xtick&lt;-c(0,1.386294,2.079442,2.484907,2.772589,2.995732,3.178054)</span></span>
<span id="cb236-11"><a href="ChapDependenceModel.html#cb236-11" aria-hidden="true" tabindex="-1"></a>xticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0.0&quot;</span>, <span class="st">&quot;0.2&quot;</span>, <span class="st">&quot;0.4&quot;</span>, <span class="st">&quot;0.6&quot;</span>, <span class="st">&quot;0.8&quot;</span>, <span class="st">&quot;1.0&quot;</span>)</span>
<span id="cb236-12"><a href="ChapDependenceModel.html#cb236-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> xtick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb236-13"><a href="ChapDependenceModel.html#cb236-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> xtick, <span class="sc">-</span><span class="fl">0.08</span>, <span class="at">labels =</span> xticklab, <span class="at">pos =</span> <span class="dv">1</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb236-14"><a href="ChapDependenceModel.html#cb236-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-15"><a href="ChapDependenceModel.html#cb236-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-16"><a href="ChapDependenceModel.html#cb236-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">text =</span> <span class="fu">quote</span>(u[<span class="dv">2</span>]), <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb236-17"><a href="ChapDependenceModel.html#cb236-17" aria-hidden="true" tabindex="-1"></a>ytick <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb236-18"><a href="ChapDependenceModel.html#cb236-18" aria-hidden="true" tabindex="-1"></a>yticklab <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0.0&quot;</span>, <span class="st">&quot;0.2&quot;</span>, <span class="st">&quot;0.4&quot;</span>, <span class="st">&quot;0.6&quot;</span>, <span class="st">&quot;0.8&quot;</span>, <span class="st">&quot;1.0&quot;</span>)</span>
<span id="cb236-19"><a href="ChapDependenceModel.html#cb236-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> ytick, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb236-20"><a href="ChapDependenceModel.html#cb236-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">y =</span> ytick, <span class="at">labels =</span> yticklab, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb236-21"><a href="ChapDependenceModel.html#cb236-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-22"><a href="ChapDependenceModel.html#cb236-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-23"><a href="ChapDependenceModel.html#cb236-23" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(ic, pCopula, <span class="at">zlab =</span> <span class="st">&quot;C(u,v)&quot;</span>, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">cex.lab =</span> <span class="fl">0.5</span>, <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span>
<span id="cb236-24"><a href="ChapDependenceModel.html#cb236-24" aria-hidden="true" tabindex="-1"></a><span class="co"># xlab = expression(u[1]),ylab = expression(u[2])</span></span></code></pre></div>
</div>
<p>There is another type of copula that is frequently utilized, known as Frank’s Copula <span class="citation">(<a href="bibliography.html#ref-frank1979simultaneous" role="doc-biblioref">Frank 1979</a>)</span>. This copula can represent both positive and negative dependence and has a straightforward analytic structure. The copula (distribution function) is</p>
<p><span class="math display" id="eq:FrankCopula">\[\begin{equation}
{C}(u_1,u_2) = \frac{1}{\gamma} \log \left( 1+ \frac{ (\exp(\gamma
u_1) -1)(\exp(\gamma u_2) -1)} {\exp(\gamma) -1} \right).
\tag{16.2}
\end{equation}\]</span></p>
<p>This is a bivariate distribution function with its domain on the unit square <span class="math inline">\([0,1]^2.\)</span> Here <span class="math inline">\(\gamma\)</span> is the dependence parameter, that is, the range of dependence is controlled by the parameter <span class="math inline">\(\gamma\)</span>. Positive association increases as <span class="math inline">\(\gamma\)</span> increases. As we will see, this positive association can be summarized with <a href="#" class="tooltip" style="color:green"><em>Spearman’s rho</em><span style="font-size:8pt"></span></a> (<span class="math inline">\(\rho_S\)</span>) and Kendall’s tau (<span class="math inline">\(\tau\)</span>).</p>
<p>In Figure <a href="ChapDependenceModel.html#fig:Fig165">16.5</a>, we can see scatterplots of data generated from the Frank’s copula. As <span class="math inline">\(\gamma\)</span> value changes, we observe that components <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> become positively or negatively dependent. When <span class="math inline">\(\theta\)</span> approaches 0, <a href="ChapDependenceModel.html#eq:FrankCopula">(16.2)</a> transforms into an independence copula. Also, Figure <a href="ChapDependenceModel.html#fig:Fig166">16.6</a> provides the distribution and density functions for Frank’s copula when <span class="math inline">\(\gamma=12\)</span>. In Section <a href="ChapDependenceModel.html#S:Sec164">16.4</a>, we will explore copula functions other than the commonly used Frank’s copula.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig165"></span>
<img src="LDAEd2_files/figure-html/Fig165-1.png" alt="Scatterplot of Observations from Frank’s Copula. \(\gamma=12\) (left), \(\gamma=0\) (middle) and \(\gamma=-12\) (right)." width="672" />
<p class="caption">
Figure 16.5: <strong>Scatterplot of Observations from Frank’s Copula</strong>. <span class="math inline">\(\gamma=12\)</span> (left), <span class="math inline">\(\gamma=0\)</span> (middle) and <span class="math inline">\(\gamma=-12\)</span> (right).
</p>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig166"></span>
<img src="LDAEd2_files/figure-html/Fig166-1.png" alt="Left: Plot for distribution function for Frank’s Copula (\(\gamma=12\)). Right: Plot for the density function for Frank’s Copula (\(\gamma=12\))." width="672" />
<p class="caption">
Figure 16.6: Left: Plot for distribution function for Frank’s Copula (<span class="math inline">\(\gamma=12\)</span>). Right: Plot for the density function for Frank’s Copula (<span class="math inline">\(\gamma=12\)</span>).
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.CopPlot.1" href="javascript:togglecode('toggleCode.CopPlot.1','displayCode.CopPlot.1');"><i><strong>R Code for Frank Copula Plots</strong></i></a>
</h5>
<div id="toggleCode.CopPlot.1" style="display: none">
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="ChapDependenceModel.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatterplots</span></span>
<span id="cb237-2"><a href="ChapDependenceModel.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb237-3"><a href="ChapDependenceModel.html#cb237-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb237-4"><a href="ChapDependenceModel.html#cb237-4" aria-hidden="true" tabindex="-1"></a>gamma_par <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb237-5"><a href="ChapDependenceModel.html#cb237-5" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">frankCopula</span>(gamma_par, <span class="at">dim =</span> d)</span>
<span id="cb237-6"><a href="ChapDependenceModel.html#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb237-7"><a href="ChapDependenceModel.html#cb237-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb237-8"><a href="ChapDependenceModel.html#cb237-8" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> fc)  <span class="co"># generate a sample with gamma=5</span></span>
<span id="cb237-9"><a href="ChapDependenceModel.html#cb237-9" aria-hidden="true" tabindex="-1"></a>U0 <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> <span class="fu">setTheta</span>(fc, <span class="at">value =</span> <span class="dv">0</span>))  <span class="co"># generate a sample with gamma=0</span></span>
<span id="cb237-10"><a href="ChapDependenceModel.html#cb237-10" aria-hidden="true" tabindex="-1"></a>U12 <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> <span class="fu">setTheta</span>(fc, <span class="at">value =</span> <span class="sc">-</span><span class="dv">12</span>))  <span class="co"># generate a sample with gamma=-5</span></span>
<span id="cb237-11"><a href="ChapDependenceModel.html#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U, <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]))</span>
<span id="cb237-12"><a href="ChapDependenceModel.html#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U0, <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]))</span>
<span id="cb237-13"><a href="ChapDependenceModel.html#cb237-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U12, <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]))</span>
<span id="cb237-14"><a href="ChapDependenceModel.html#cb237-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-15"><a href="ChapDependenceModel.html#cb237-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-16"><a href="ChapDependenceModel.html#cb237-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution and density functions</span></span>
<span id="cb237-17"><a href="ChapDependenceModel.html#cb237-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb237-18"><a href="ChapDependenceModel.html#cb237-18" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb237-19"><a href="ChapDependenceModel.html#cb237-19" aria-hidden="true" tabindex="-1"></a>gamma_par <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb237-20"><a href="ChapDependenceModel.html#cb237-20" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">frankCopula</span>(gamma_par, <span class="at">dim =</span> d)</span>
<span id="cb237-21"><a href="ChapDependenceModel.html#cb237-21" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(fc, pCopula, <span class="at">zlab =</span> <span class="st">&quot;C(u,v)&quot;</span>, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">cex.lab =</span> <span class="fl">0.5</span>, <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span>
<span id="cb237-22"><a href="ChapDependenceModel.html#cb237-22" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(fc, dCopula, <span class="at">zlab =</span> <span class="st">&quot;c(u,v)&quot;</span>, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">cex.lab =</span> <span class="fl">0.5</span>, <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</div>
<p><strong>Example 16.2.1. Copula Representation Example</strong></p>
<p>Suppose we have a variable <span class="math inline">\(X\)</span> that follows a Pareto distribution with a scale parameter of <span class="math inline">\(\theta=10\)</span> and a shape parameter of <span class="math inline">\(\alpha=1.6\)</span>. Additionally, let <span class="math inline">\(Y\)</span> be an exponential variable with a mean value of 8. Write <span class="math inline">\(F_{X,Y}(7.2, 4.1)\)</span> in the form <span class="math inline">\(C(u,v)\)</span>.</p>
<p>Note: <span class="math inline">\(F_{X,Y}(x,y)\)</span> is the joint distribution function and <span class="math inline">\(C(u,v)\)</span> is the copula that links <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayExample.16.2.1" href="javascript:toggleEX('toggleExample.16.2.1','displayExample.16.2.1');"><i><strong>Show Example Solution</strong></i></a>
</h5>
<div id="toggleExample.16.2.1" style="display: none">
<p><em>Example Solution.</em> Denote the marginal distribution functions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as <span class="math inline">\(F_X(x)\)</span> and <span class="math inline">\(F_Y(y)\)</span>, respectively. Since <span class="math inline">\(F_{X,Y}(7.2,4.1)=C[F_X(7.2),F_Y(4.1)]\)</span>, we can use the marginal distribution functions to obtain the arguments of the copula function:</p>
<p>For the Pareto variable, <span class="math inline">\(X\)</span>:
<span class="math display">\[
F_X(7.2)=1- \left(  \frac{10}{7.2+ 10} \right) ^{1.6} =0.58;
\]</span>
For the Exponential variable, <span class="math inline">\(Y\)</span>:
<span class="math display">\[
F_Y(4.1)=1-e^{-0.125\times 4.1}=0.40.
\]</span>
Hence, <span class="math inline">\(F_{X,Y}(7.2,4.1)=C[0.58,0.40]\)</span>.</p>
</div>
<hr />
</div>
<div id="sklars-theorem" class="section level3 hasAnchor" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Sklar’s Theorem<a href="ChapDependenceModel.html#sklars-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <span class="citation">Sklar (<a href="bibliography.html#ref-sklar1959fonctions" role="doc-biblioref">1959</a>)</span>, Sklar showcased how copulas can capture the dependence structure of a group of random variables. This principle has since been referred to as Sklar’s Theorem and serves as the cornerstone of copula theory. Dependence modeling with copulas for continuous multivariate distributions allows for the separation of modeling the univariate marginals and the dependence structure, where a copula can represent the dependence structure.</p>
<ol style="list-style-type: decimal">
<li><p>For a <span class="math inline">\(p\)</span>-variate distribution <span class="math inline">\(F\)</span>, with marginal cumulative distribution functions <span class="math inline">\(F_1, \ldots, F_p\)</span>, the copula associated with <span class="math inline">\(F\)</span> is a distribution function <span class="math inline">\(C: [0,1]^p \rightarrow [0,1]\)</span> with <span class="math inline">\(U(0,1)\)</span> margins that satisfies:
<span class="math display" id="eq:DFDefined2">\[\begin{equation}
{F}\left(\mathbf{y}\right)= {C}\left({F}_1\left(y_1\right), \ldots, {F}_p\left(y_p\right)\right), \quad \mathbf{y}=\{y_1 \ldots y_p\} \in \mathbb{R}^p.
\tag{16.3}
\end{equation}\]</span>
If <span class="math inline">\(F\)</span> is a continuous <span class="math inline">\(p\)</span>-variate distribution function with univariate margins <span class="math inline">\(F_1, \ldots, F_p\)</span> and quantile functions <span class="math inline">\(F_1^{-1}, \ldots, F_p^{-1}\)</span>, then:
<span class="math display">\[
C\left(\mathbf{u}\right) =F\left(F_1^{-1}\left(u_1\right), \ldots, F_p^{-1}\left(u_p\right)\right), \quad \mathbf{u} \in [0,1]^p ,
\]</span>
is the unique choice.</p></li>
<li><p>The converse also holds: If <span class="math inline">\(C\)</span> is a copula and <span class="math inline">\(F_1, \ldots, F_p\)</span> are univariate cumulative distribution functions, then the function <span class="math inline">\(F\)</span> defined by <a href="ChapDependenceModel.html#eq:DFDefined2">(16.3)</a> is a joint cumulative distribution function with marginal cumulative distribution functions <span class="math inline">\(F_1, \ldots, F_p\)</span>.</p></li>
</ol>
<h5 style="text-align: center;">
<a id="displayTheory.Copula.1" href="javascript:toggleTheory('toggleTheory.Copula.1','displayCode.Copula.1');"><i><strong>Proof of Sklar’s Theorem</strong></i></a>
</h5>
<div id="toggleTheory.Copula.1" style="display: none">
<hr />
<p>*** <span class="math inline">\(\textbf{Proof}\)</span>. Suppose we have <span class="math inline">\(Y_1, \ldots, Y_p \sim F\)</span>, <span class="math inline">\(U\sim \text{U}(0,1)\)</span> and assume <span class="math inline">\(Y_1, \ldots, Y_p\)</span> is continuous, which implies <span class="math inline">\(F_1^{-1}(U_i)=Y_i\)</span>. Then, the random variables have a multivariate distribution function <span class="math inline">\(C\)</span>, given by:
<span class="math display">\[
\begin{array}{cl}
{C}\left(u_1, \ldots, u_p\right)&amp;=\Pr\left( U_1 \leq u_1, \ldots, U_p \leq u_p\right)\\
&amp;=\Pr\left( {F}_1\left(Y_1\right) \leq u_1, \ldots, {F}_p\left(Y_p\right) \leq u_p\right)\\
&amp;=\Pr\left( Y_1 \leq {F}_1^{-1}(u_1), \ldots, Y_p \leq {F}_p^{-1}(u_p)\right)\\
&amp;=F\left(F_1^{-1}\left(u_1\right), \ldots, F_p^{-1}\left(u_p\right)\right)\\
&amp;=F\left(y_1, \ldots, y_p\right) .\\
\end{array}
\]</span>
Hence:
<span class="math display">\[
{C}\left(F_1(y_1), \ldots, F_p(y_p)\right)=F\left(y_1, \ldots, y_p\right) .
\]</span>
***</p>
<hr />
</div>
<p>According to the first part of Sklar’s theorem, there is a unique underlying copula that is unknown, and it can be estimated from the data available. After estimating the margins and copula, they are usually combined using <a href="ChapDependenceModel.html#eq:DFDefined2">(16.3)</a> to give the estimated multivariate distribution function. Also, Sklar’s theorem’s second part enables the construction of adaptable multivariate distribution functions with specified univariate margins. These functions are useful in more intricate models, like pricing models.</p>
<div id="surveyElement162">

</div>
<div id="surveyResult162">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz162.1" href="javascript:toggleQuiz
('display.Quiz162.2','display.Quiz162.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz162.2" style="display: none">
<p id="Quiz162Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz162.js">
</script>
</div>
</div>
<div id="S:Sec163" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Application Using Copulas<a href="ChapDependenceModel.html#S:Sec163" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Discover dependence structure between random variables</li>
<li>Model the dependence with a copula function</li>
</ul>
<hr />
<p>This section analyzes the insurance losses and expenses data with the statistical program <code>R</code>. The data set is visualized in Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a>. The model fitting process is started by marginal modeling of each of the two variables, <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span>. Then we model the joint distribution of these marginal outcomes.</p>
<div id="marginal-models" class="section level3 hasAnchor" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Marginal Models<a href="ChapDependenceModel.html#marginal-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We first examine the <a href="#" class="tooltip" style="color:green"><em>marginal distributions</em><span style="font-size:8pt">The probability distribution of the variables contained in the subset of a collection of random variables</span></a> of losses and expenses before going through the joint modeling. The histograms show that both <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span> are right-skewed and <a href="#" class="tooltip" style="color:green"><em>fat-tailed</em><span style="font-size:8pt">A fat-tailed distribution is a probability distribution that exhibits a large skewness or kurtosis, relative to that of either a normal distribution or an exponential distribution</span></a>. Because of these features, for both marginal distributions of losses and expenses, we consider a Pareto distribution, distribution function of the form
<span class="math display">\[
F(y)=1- \left(  \frac{\theta}{y+ \theta} \right) ^{\alpha}.
\]</span>
Here, <span class="math inline">\(\theta\)</span> is a scale parameter and <span class="math inline">\(\alpha\)</span> is a shape parameter. Section <a href="ChapSummaryDistributions.html#S:ContinuousDistributions">20.2</a> provides details of this distribution.</p>
<p>The marginal distributions of losses and expenses are fit using the method of maximum likelihood. Specifically, we use the <code>vglm</code> function from the <code>R VGAM</code> package. Firstly, we fit the marginal distribution of <span class="math inline">\({\tt ALAE}\)</span>. Parameters are summarized in <a href="ChapDependenceModel.html#tab:16.6">Table 16.6</a>.</p>
<h5 style="text-align: center;">
<a id="displayCode.Reg.1" href="javascript:togglecode('toggleCode.Reg.1','displayCode.Reg.1');"><i><strong>R Code for Pareto Fitting of ALAE</strong></i></a>
</h5>
<div id="toggleCode.Reg.1" style="display: none">
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="ChapDependenceModel.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb238-2"><a href="ChapDependenceModel.html#cb238-2" aria-hidden="true" tabindex="-1"></a>fit.ALAE <span class="ot">&lt;-</span> <span class="fu">vglm</span>(ALAE <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">paretoII</span>(<span class="at">location=</span><span class="dv">0</span>, <span class="at">lscale=</span><span class="st">&quot;loge&quot;</span>, <span class="at">lshape=</span><span class="st">&quot;loge&quot;</span>)) <span class="co"># fit the model by vlgm function</span></span>
<span id="cb238-3"><a href="ChapDependenceModel.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.ALAE, <span class="at">matrix=</span><span class="cn">TRUE</span>) <span class="co"># extract fitted model coefficients, matrix=TRUE gives logarithm of estimated parameters instead of default normal scale estimates</span></span>
<span id="cb238-4"><a href="ChapDependenceModel.html#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="ChapDependenceModel.html#cb238-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb238-6"><a href="ChapDependenceModel.html#cb238-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">loge</span>(scale) <span class="fu">loge</span>(shape)</span>
<span id="cb238-7"><a href="ChapDependenceModel.html#cb238-7" aria-hidden="true" tabindex="-1"></a> (Intercept)     <span class="fl">9.624673</span>   <span class="fl">0.7988753</span></span>
<span id="cb238-8"><a href="ChapDependenceModel.html#cb238-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb238-9"><a href="ChapDependenceModel.html#cb238-9" aria-hidden="true" tabindex="-1"></a>                  scale        shape </span>
<span id="cb238-10"><a href="ChapDependenceModel.html#cb238-10" aria-hidden="true" tabindex="-1"></a> (Intercept)  <span class="fl">15133.603598</span>     <span class="fl">2.223039</span> </span></code></pre></div>
</div>
<p>We repeat this procedure to fit the marginal distribution of the <span class="math inline">\({\tt LOSS}\)</span> variable. Because the loss variable also seems right-skewed and heavy-tailed data, we also model the marginal distribution with the Pareto distribution (although with different parameters).</p>
<h5 style="text-align: center;">
<a id="displayCode.ParFit.1" href="javascript:togglecode('toggleCode.ParFit.1','displayCode.ParFit.1');"><i><strong>R Code for Pareto Fitting of LOSS</strong></i></a>
</h5>
<div id="toggleCode.ParFit.1" style="display: none">
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="ChapDependenceModel.html#cb239-1" aria-hidden="true" tabindex="-1"></a>fit.LOSS <span class="ot">&lt;-</span> <span class="fu">vglm</span>(LOSS <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">trace=</span><span class="cn">TRUE</span>)</span>
<span id="cb239-2"><a href="ChapDependenceModel.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Coef</span>(fit.LOSS)</span>
<span id="cb239-3"><a href="ChapDependenceModel.html#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="ChapDependenceModel.html#cb239-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb239-5"><a href="ChapDependenceModel.html#cb239-5" aria-hidden="true" tabindex="-1"></a>       scale        shape </span>
<span id="cb239-6"><a href="ChapDependenceModel.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fl">16228.14797</span>     <span class="fl">1.23766</span></span></code></pre></div>
</div>
<p><a id=tab:16.6></a></p>
<p><strong><span id="tab:16.6">Table 16.6</span>. Summary of Pareto Maximum Likelihood Fitted Parameters from the LGPIF Data</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|r|r}
    \hline
&amp; \text{Shape } \hat{\theta}     &amp;\text{Scale }    \hat{\alpha}     \\
  \hline
\text{ALAE}  &amp; 15133.60360  &amp;  2.22304    \\
\text{LOSS}  &amp;    16228.14797  &amp;  1.23766 \\
   \hline
\end{array}
\end{matrix}}
\]</span>
To visualize the fitted distribution of <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span> variables, one can use the estimated parameters and plot the corresponding distribution function and density function. For more details on the selection of marginal models, see Chapter <a href="ChapModelSelection.html#ChapModelSelection">6</a>.</p>
</div>
<div id="S:Sec1632" class="section level3 hasAnchor" number="16.3.2">
<h3><span class="header-section-number">16.3.2</span> Probability Integral Transformation<a href="ChapDependenceModel.html#S:Sec1632" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When studying simulation, in Section <a href="ChapSimulation.html#S:Sec812">8.1.2</a> we learned about the <a href="#" class="tooltip" style="color:green"><em>inverse transform method</em><span style="font-size:8pt">Samples a uniform number between 0 and 1 to represent the randomly selected percentile, then uses the inverse of the cumulative density function of the desired distribution to simulate from in order to find the simulated value from the desired distribution</span></a>. This is a way of mapping a <span class="math inline">\(U(0,1)\)</span> random variable into a random variable <span class="math inline">\(X\)</span> with distribution function <span class="math inline">\(F\)</span> via the inverse of the distribution, that is, <span class="math inline">\(X = F^{-1}(U)\)</span>. The <a href="#" class="tooltip" style="color:green"><em>probability integral transformation</em><span style="font-size:8pt">Any continuous variable can be mapped to a uniform random variable via its distribution function</span></a> goes in the other direction, it states that <span class="math inline">\(F(X) = U\)</span>. Although the inverse transform result is available when the underlying random variable is continuous, discrete or a hybrid combination of the two, the probability integral transform is mainly useful when the distribution is continuous. That is the focus of this chapter.</p>
<p>We use the probability integral transform for two purposes: (1) for diagnostic purposes, to check that we have correctly specified a distribution function and (2) as an input into the copula function in equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>.</p>
<p>For the first purpose, we can check to see whether the Pareto is a reasonable distribution to model our marginal distributions. Given the fitted Pareto distribution, the variable <span class="math inline">\({\tt ALAE}\)</span> is transformed to the variable <span class="math inline">\(u_1\)</span>, which follows a uniform distribution on <span class="math inline">\([0,1]\)</span>:
<span class="math display">\[
u_1 = \hat{F}_{1}(ALAE) = 1 - \left( \frac{\hat{\theta}}{\hat{\theta}+ALAE} \right)^{\hat{\alpha}}.
\]</span></p>
<p>After applying the probability integral transformation to the <span class="math inline">\({\tt ALAE}\)</span> variable, we plot the histogram of <em>Transformed</em> <span class="math inline">\({\tt ALAE}\)</span> in Figure <a href="ChapDependenceModel.html#fig:Fig167">16.7</a>. This plot appears reasonably close to what we expect to see with a uniform distribution, suggesting that the Pareto distribution is a reasonable specification.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig167"></span>
<img src="LDAEd2_files/figure-html/Fig167-1.png" alt="Histogram of Transformed ALAE" width="60%" />
<p class="caption">
Figure 16.7: <strong>Histogram of Transformed ALAE</strong>
</p>
</div>
<p>In the same way, the variable <span class="math inline">\({\tt LOSS}\)</span> is also transformed to the variable <span class="math inline">\(u_2\)</span>, which follows a uniform distribution on <span class="math inline">\([0,1]\)</span>. The left-hand panel of Figure <a href="ChapDependenceModel.html#fig:Fig168">16.8</a> shows a plot the histogram of <em>Transformed</em> <span class="math inline">\({\tt ALAE}\)</span>, again reinforcing the Pareto distribution specification.
For another way of looking at the data, the variable <span class="math inline">\(u_2\)</span> can be transformed to a <em>normal score</em> with the quantile function of standard normal distribution. As we see in Figure <a href="ChapDependenceModel.html#fig:Fig168">16.8</a>, normal scores of the variable <span class="math inline">\({\tt LOSS}\)</span> are approximately marginally standard normal. This figure is helpful because analysts are used to looking for patterns of approximate normality (which seems to be evident in the figure). The logic is that, if the Pareto distribution is correctly specified, then transformed losses <span class="math inline">\(u_2\)</span> should be approximately normal, and the normal scores <span class="math inline">\(\Phi^{-1}(u_2)\)</span>, should be approximately normal. (Here, <span class="math inline">\(\Phi\)</span> is the cumulative standard normal distribution function.)</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig168"></span>
<img src="LDAEd2_files/figure-html/Fig168-1.png" alt="Histogram of Transformed Loss. The left-hand panel shows the distribution of probability integral transformed losses. The right-hand panel shows the distribution for the corresponding normal scores." width="80%" />
<p class="caption">
Figure 16.8: <strong>Histogram of Transformed Loss.</strong> The left-hand panel shows the distribution of probability integral transformed losses. The right-hand panel shows the distribution for the corresponding normal scores.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.transalae.1" href="javascript:togglecode('toggleCode.transalae.1','displayCode.transalae.1');"><i><strong>R Code for Histograms of Transformed Variables</strong></i></a>
</h5>
<div id="toggleCode.transalae.1" style="display: none">
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ChapDependenceModel.html#cb240-1" aria-hidden="true" tabindex="-1"></a>theta.LOSS <span class="ot">=</span> <span class="fu">Coef</span>(fit.LOSS)[<span class="dv">1</span>]</span>
<span id="cb240-2"><a href="ChapDependenceModel.html#cb240-2" aria-hidden="true" tabindex="-1"></a>alpha.LOSS <span class="ot">=</span> <span class="fu">Coef</span>(fit.LOSS)[<span class="dv">2</span>]</span>
<span id="cb240-3"><a href="ChapDependenceModel.html#cb240-3" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">+</span> (LOSS<span class="sc">/</span>theta.LOSS))<span class="sc">^</span>(<span class="sc">-</span>alpha.LOSS)</span>
<span id="cb240-4"><a href="ChapDependenceModel.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb240-5"><a href="ChapDependenceModel.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(u2, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb240-6"><a href="ChapDependenceModel.html#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">qnorm</span>(u2), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="joint-modeling-with-copula-function" class="section level3 hasAnchor" number="16.3.3">
<h3><span class="header-section-number">16.3.3</span> Joint Modeling with Copula Function<a href="ChapDependenceModel.html#joint-modeling-with-copula-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before jointly modeling losses and expenses, we draw the scatterplot of transformed variables <span class="math inline">\((U_1, U_2)\)</span> and the scatterplot of normal scores in Figure <a href="ChapDependenceModel.html#fig:Fig169">16.9</a>. The left-hand panel is a plot of <span class="math inline">\(U_1\)</span> versus <span class="math inline">\(U_2\)</span>, where <span class="math inline">\(U_1 = \hat{F}_1(ALAE)\)</span> and <span class="math inline">\(U_2=\hat{F}_2(LOSS)\)</span>). Then we transform each one using an inverse standard normal distribution function, <span class="math inline">\(\Phi^{-1}(\cdot)\)</span>, or <code>qnorm</code> in <code>R</code> to get normal scores. As in Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a>, it is difficult to see patterns in the left-hand panel. However, with rescaling, patterns are evident in the right-hand panel. To learn more details about normal scores and their applications in copula modeling, see <span class="citation">Joe (<a href="bibliography.html#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig169"></span>
<img src="LDAEd2_files/figure-html/Fig169-1.png" alt="Left: Scatter plot for transformed variables. Right:Scatter plot for normal scores" width="80%" />
<p class="caption">
Figure 16.9: Left: Scatter plot for transformed variables. Right:Scatter plot for normal scores
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Cor.1" href="javascript:togglecode('toggleCode.Cor.1','displayCode.Cor.1');"><i><strong>R Code for Scatter Plots and Correlation</strong></i></a>
</h5>
<div id="toggleCode.Cor.1" style="display: none">
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="ChapDependenceModel.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb241-2"><a href="ChapDependenceModel.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u1, u2, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="at">xlab =</span> <span class="st">&quot;Transformed ALAE&quot;</span>,</span>
<span id="cb241-3"><a href="ChapDependenceModel.html#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Transformed LOSS&quot;</span>)</span>
<span id="cb241-4"><a href="ChapDependenceModel.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">qnorm</span>(u1), <span class="fu">qnorm</span>(u2), <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">qnorm</span>(u[<span class="dv">1</span>])), <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">qnorm</span>(u[<span class="dv">2</span>])))</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="ChapDependenceModel.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(u1, u2, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb242-2"><a href="ChapDependenceModel.html#cb242-2" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb242-3"><a href="ChapDependenceModel.html#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="ChapDependenceModel.html#cb242-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.451872</span></span></code></pre></div>
</div>
<p>The right-hand panel of Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a> shows us there is a positive dependency between these two random variables. This can be summarized using, for example, Spearman’s rho that turns out to be 0.451. As we learned in Section <a href="ChapDependenceModel.html#S:Sec1612">16.1.2</a>, this statistic depends only on the order of the two variables through their respective ranks. Therefore, the statistic is the same for (1) the original data in Figure <a href="ChapDependenceModel.html#fig:Fig161">16.1</a>, (2) the data transformed to uniform scales in the left-hand panel of Figure <a href="ChapDependenceModel.html#fig:Fig169">16.9</a>, and (3) the normal scores in the right-hand panel of Figure <a href="ChapDependenceModel.html#fig:Fig169">16.9</a>.</p>
<p>The next step is to calculate estimates of the copula parameters. One option is to use traditional maximum likelihood and determine all the parameters at the same time which can be computationally burdensome. Even in our simple example, this means maximizing a (log) likelihood function over five parameters, two for the marginal <span class="math inline">\({\tt ALAE}\)</span> distribution, two for the marginal <span class="math inline">\({\tt LOSS}\)</span> distribution, and one for the copula. A widely alternative, known as the <em>inference for margins (IFM)</em> approach, is to simply use the fitted marginal distributions, <span class="math inline">\(u_1\)</span> and <span class="math inline">\(u_2\)</span>, as inputs when determining the copula. This is the approach taken here. In the following code, you will see that the fitted copula parameter becomes <span class="math inline">\(\hat{\gamma} = 3.114\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.FrankCopula.1" href="javascript:togglecode('toggleCode.FrankCopula.1','displayCode.FrankCopula.1');"><i><strong>R Code for IFM Fitting with Frank’s Copula</strong></i></a>
</h5>
<div id="toggleCode.FrankCopula.1" style="display: none">
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="ChapDependenceModel.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformed data matrix uu</span></span>
<span id="cb243-2"><a href="ChapDependenceModel.html#cb243-2" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb243-3"><a href="ChapDependenceModel.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Frank&#39;s copula object with arbitrary parameter value</span></span>
<span id="cb243-4"><a href="ChapDependenceModel.html#cb243-4" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb243-5"><a href="ChapDependenceModel.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb243-6"><a href="ChapDependenceModel.html#cb243-6" aria-hidden="true" tabindex="-1"></a>fit.ml <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(frank.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>))</span>
<span id="cb243-7"><a href="ChapDependenceModel.html#cb243-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-8"><a href="ChapDependenceModel.html#cb243-8" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span> <span class="fu">fitCopula</span>(copula, <span class="at">data =</span> data, <span class="at">method =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">start =</span> ..<span class="dv">2</span>)</span>
<span id="cb243-9"><a href="ChapDependenceModel.html#cb243-9" aria-hidden="true" tabindex="-1"></a>Fit based on <span class="st">&quot;maximum likelihood&quot;</span> and <span class="dv">1500</span> <span class="dv">2</span><span class="sc">-</span>dimensional observations.</span>
<span id="cb243-10"><a href="ChapDependenceModel.html#cb243-10" aria-hidden="true" tabindex="-1"></a>Frank copula, dim. d <span class="ot">=</span> <span class="dv">2</span> </span>
<span id="cb243-11"><a href="ChapDependenceModel.html#cb243-11" aria-hidden="true" tabindex="-1"></a>      Estimate Std. Error</span>
<span id="cb243-12"><a href="ChapDependenceModel.html#cb243-12" aria-hidden="true" tabindex="-1"></a>alpha    <span class="fl">3.114</span>      <span class="fl">0.169</span></span>
<span id="cb243-13"><a href="ChapDependenceModel.html#cb243-13" aria-hidden="true" tabindex="-1"></a>The maximized loglikelihood is <span class="fl">172.6</span> </span></code></pre></div>
</div>
<p>To visualize the fitted Frank’s copula, the distribution function and density function perspective plots are drawn in Figure <a href="ChapDependenceModel.html#fig:Fig1610">16.10</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig1610"></span>
<img src="LDAEd2_files/figure-html/Fig1610-1.png" alt="Frank’s Copula. Left: Plot for distribution function for Frank’s Copula. Right:Plot for density function for Frank’s Copula" width="672" />
<p class="caption">
Figure 16.10: <strong>Frank’s Copula</strong>. Left: Plot for distribution function for Frank’s Copula. Right:Plot for density function for Frank’s Copula
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.DistriPlot.1" href="javascript:togglecode('toggleCode.DistriPlot.1','displayCode.DistriPlot.1');"><i><strong>R Code for Frank’s Copula Plots</strong></i></a>
</h5>
<div id="toggleCode.DistriPlot.1" style="display: none">
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ChapDependenceModel.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(1,2))</span></span>
<span id="cb244-2"><a href="ChapDependenceModel.html#cb244-2" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">3.114</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb244-3"><a href="ChapDependenceModel.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb244-4"><a href="ChapDependenceModel.html#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(frank.cop, pCopula, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">zlab =</span> <span class="st">&quot;C(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.5</span>,</span>
<span id="cb244-5"><a href="ChapDependenceModel.html#cb244-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span>
<span id="cb244-6"><a href="ChapDependenceModel.html#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(frank.cop, dCopula, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">zlab =</span> <span class="st">&quot;c(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.5</span>,</span>
<span id="cb244-7"><a href="ChapDependenceModel.html#cb244-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</div>
<p>We can estimate the anticipated expenses when losses surpass a specific threshold by utilizing the fitted Frank copula based on the data on losses and expenses. For instance, according to the data, the mean expense when losses exceed <span class="math inline">\(\$200,000\)</span> is <span class="math inline">\(\$58,807\)</span>. However, when we apply the fitted Frank copula, the projected expenses when losses exceed <span class="math inline">\(\$200,000\)</span> is <span class="math inline">\(\$26,767\)</span>. This suggests that the Frank copula doesn’t provide an accurate estimate and may not be suitable for this dataset. We will now explore other copula types.</p>
<h5 style="text-align: center;">
<a id="displayCode.ExpectedExp.1" href="javascript:togglecode('toggleCode.ExpectedExp.1','displayCode.ExpectedExp.1');"><i><strong>R Code for using the fitted Frank copula to calculate the expected level of expenses</strong></i></a>
</h5>
<div id="toggleCode.ExpectedExp.1" style="display: none">
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="ChapDependenceModel.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb245-2"><a href="ChapDependenceModel.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb245-3"><a href="ChapDependenceModel.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="do">## From data</span></span>
<span id="cb245-4"><a href="ChapDependenceModel.html#cb245-4" aria-hidden="true" tabindex="-1"></a>lossData_Ori<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(loss<span class="sc">$</span>alae,loss<span class="sc">$</span>loss))</span>
<span id="cb245-5"><a href="ChapDependenceModel.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(lossData_Ori)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;alae&quot;</span>,<span class="st">&quot;loss&quot;</span>)</span>
<span id="cb245-6"><a href="ChapDependenceModel.html#cb245-6" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb245-7"><a href="ChapDependenceModel.html#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(lossData_Ori<span class="sc">$</span>alae<span class="sc">*</span>(lossData_Ori<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((lossData_Ori<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb245-8"><a href="ChapDependenceModel.html#cb245-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-9"><a href="ChapDependenceModel.html#cb245-9" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb245-10"><a href="ChapDependenceModel.html#cb245-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">58806.75</span></span>
<span id="cb245-11"><a href="ChapDependenceModel.html#cb245-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-12"><a href="ChapDependenceModel.html#cb245-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-13"><a href="ChapDependenceModel.html#cb245-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Using fitted Frank copula</span></span>
<span id="cb245-14"><a href="ChapDependenceModel.html#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2010</span>)</span>
<span id="cb245-15"><a href="ChapDependenceModel.html#cb245-15" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb245-16"><a href="ChapDependenceModel.html#cb245-16" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="fl">3.114</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb245-17"><a href="ChapDependenceModel.html#cb245-17" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(frank.cop, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;paretoII&quot;</span>,<span class="st">&quot;paretoII&quot;</span>), </span>
<span id="cb245-18"><a href="ChapDependenceModel.html#cb245-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta.ALAE, <span class="at">shape=</span>alpha.ALAE),</span>
<span id="cb245-19"><a href="ChapDependenceModel.html#cb245-19" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">list</span>(<span class="at">scale =</span> theta.LOSS, <span class="at">shape=</span>alpha.LOSS)))</span>
<span id="cb245-20"><a href="ChapDependenceModel.html#cb245-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-21"><a href="ChapDependenceModel.html#cb245-21" aria-hidden="true" tabindex="-1"></a>LossData_Sim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc))</span>
<span id="cb245-22"><a href="ChapDependenceModel.html#cb245-22" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb245-23"><a href="ChapDependenceModel.html#cb245-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LossData_Sim<span class="sc">$</span>alae<span class="sc">*</span>(LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb245-24"><a href="ChapDependenceModel.html#cb245-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-25"><a href="ChapDependenceModel.html#cb245-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-26"><a href="ChapDependenceModel.html#cb245-26" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb245-27"><a href="ChapDependenceModel.html#cb245-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">26766.84</span></span></code></pre></div>
</div>
</div>
</div>
<div id="S:Sec164" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Types of Copulas<a href="ChapDependenceModel.html#S:Sec164" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Define the basic types of elliptical copulas, including the normal, <span class="math inline">\(t\)</span></li>
<li>Define basic types of Archimedean copulas</li>
</ul>
<hr />
<p>There are several families of copulas that have been described in the literature. Two main families of the copula families are the <strong>Archimedean</strong> and <strong>Elliptical</strong> copulas.</p>
<div id="normal-gaussian-copulas" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Normal (Gaussian) Copulas<a href="ChapDependenceModel.html#normal-gaussian-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We started our study with Frank’s copula in equation <a href="ChapDependenceModel.html#eq:FrankCopula">(16.2)</a> because it can capture both positive and negative dependence and has a readily understood analytic form. However, extensions to multivariate cases where <span class="math inline">\(p&gt;2\)</span> are not easy and so we look to alternatives. In particular, the normal, or Gaussian, distribution has been used for many years in empirical work, starting with Gauss in 1887. So, it is natural to turn to this distribution as a benchmark for understanding multivariate dependencies.</p>
<p>For a multivariate normal distribution, think of <span class="math inline">\(p\)</span> normal random variables, each with mean zero and standard deviation one. Their dependence is controlled by <span class="math inline">\(\boldsymbol \Sigma\)</span>, a <a href="#" class="tooltip" style="color:green"><em>correlation matrix</em><span style="font-size:8pt">A table showing correlation coefficients between variables</span></a>, with ones on the diagonal. The number in the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column, say <span class="math inline">\(\boldsymbol \Sigma_{ij}\)</span>, gives the correlation between the <span class="math inline">\(i\)</span>th and <span class="math inline">\(j\)</span>th normal random variables. This collection of random variables has a multivariate normal distribution with probability density function
<span class="math display" id="eq:Normalpdf">\[\begin{equation}
\phi_N (\mathbf{z})= \frac{1}{(2 \pi)^{p/2}\sqrt{\det \boldsymbol \Sigma}}
\exp\left( -\frac{1}{2} \mathbf{z}^{\prime} \boldsymbol
\Sigma^{-1}\mathbf{z}\right).
\tag{16.4}
\end{equation}\]</span>
To develop the corresponding copula version, it is possible to start with equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>, evaluate this using normal variables, and go through a bit of calculus. Instead, we simply state as a definition, the normal (Gaussian) <strong>copula</strong> density function is
<span class="math display">\[
c_N(u_1,  \ldots, u_p) = \phi_N \left(\Phi^{-1}(u_1), \ldots, \Phi^{-1}(u_p) \right) \prod_{j=1}^p \frac{1}{\phi(\Phi^{-1}(u_j))}.
\]</span>
Here, we use <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\phi\)</span> to denote the standard normal distribution and density functions. Unlike the usual probability density function <span class="math inline">\(\phi_N\)</span>, the copula density function has its domain on the hyper-cube <span class="math inline">\([0,1]^p\)</span>. For contrast, Figure <a href="ChapDependenceModel.html#fig:Fig1611">16.11</a> compares these two density functions.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig1611"></span>
<img src="LDAEd2_files/figure-html/Fig1611-1.png" alt="Bivariate Normal Probability Density Function Plots. The left-hand panel is a traditional bivariate normal probability density function. The right-hand plot is a plot of the copula density for the normal distribution." width="672" />
<p class="caption">
Figure 16.11: <strong>Bivariate Normal Probability Density Function Plots.</strong> The left-hand panel is a traditional bivariate normal probability density function. The right-hand plot is a plot of the copula density for the normal distribution.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.DistriPlot.2" href="javascript:togglecode('toggleCode.DistriPlot.2','displayCode.DistriPlot.2');"><i><strong>R Code for Normal pdf and Normal Copula pdf Plots</strong></i></a>
</h5>
<div id="toggleCode.DistriPlot.2" style="display: none">
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ChapDependenceModel.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb246-2"><a href="ChapDependenceModel.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BIVARIATE NORMAL DF WITH RHO = 0.25</span></span>
<span id="cb246-3"><a href="ChapDependenceModel.html#cb246-3" aria-hidden="true" tabindex="-1"></a>norm.pdf <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(<span class="fu">normalCopula</span>(<span class="fl">0.25</span>), <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;norm&quot;</span>), <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb246-4"><a href="ChapDependenceModel.html#cb246-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)))</span>
<span id="cb246-5"><a href="ChapDependenceModel.html#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(norm.pdf, dMvdc, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">zlab =</span> <span class="fu">expression</span>(<span class="st">&quot;Φ&quot;</span>),</span>
<span id="cb246-6"><a href="ChapDependenceModel.html#cb246-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.8</span>, <span class="at">cex.axis =</span> <span class="fl">0.3</span>)</span>
<span id="cb246-7"><a href="ChapDependenceModel.html#cb246-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-8"><a href="ChapDependenceModel.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="co"># BIVARIATE NORMAL COPULA WITH RHO = 0.25</span></span>
<span id="cb246-9"><a href="ChapDependenceModel.html#cb246-9" aria-hidden="true" tabindex="-1"></a>norm.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb246-10"><a href="ChapDependenceModel.html#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(norm.cop, dCopula, <span class="at">theta =</span> <span class="dv">30</span>, <span class="at">zlab =</span> <span class="st">&quot;c(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.8</span>,</span>
<span id="cb246-11"><a href="ChapDependenceModel.html#cb246-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.3</span>)</span></code></pre></div>
</div>
</div>
<div id="t--and-elliptical-copulas" class="section level3 hasAnchor" number="16.4.2">
<h3><span class="header-section-number">16.4.2</span> <em>t</em>- and Elliptical Copulas<a href="ChapDependenceModel.html#t--and-elliptical-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another copula used widely in practice is the <span class="math inline">\(t\)</span>- copula. Both the <span class="math inline">\(t\)</span>- and the normal copula are special cases of a family known as <em>elliptical</em> copulas, so we introduce this general family first, then specialize to the case of the <span class="math inline">\(t\)</span>- copula.</p>
<p>The normal and the <span class="math inline">\(t\)</span>- distributions are examples of symmetric distributions. More generally, <a href="#" class="tooltip" style="color:green"><em>elliptical distributions</em><span style="font-size:8pt">Any member of a broad family of probability distributions that generalize the multivariate normal distribution</span></a> is a class of distributions that are symmetric and can be multivariate. In short, an elliptical distribution is a type of symmetric, multivariate distribution. The multivariate normal and multivariate <span class="math inline">\(t\)</span>- are special types of elliptical distributions.</p>
<p><a href="#" class="tooltip" style="color:green"><em>Elliptical copulas</em><span style="font-size:8pt">The copulas of elliptical distributions</span></a> are constructed from elliptical distributions. This copula decomposes a (multivariate) elliptical distribution into their univariate elliptical marginal distributions by Sklar’s theorem. Properties of elliptical copulas can be obtained from the properties of the corresponding elliptical distributions, see for example, <span class="citation">Hofert et al. (<a href="bibliography.html#ref-hofertelements" role="doc-biblioref">2018</a>)</span>.</p>
<p>In general, a <span class="math inline">\(p\)</span>-dimensional vector of random variables has an <em>elliptical distribution</em> if the density can be written as
<span class="math display">\[
h_E (\mathbf{z})= \frac{k_p}{\sqrt{\det \boldsymbol \Sigma}}
g_p \left( \frac{1}{2} (\mathbf{z}- \boldsymbol \mu)^{\prime}
\boldsymbol \Sigma^{-1}(\mathbf{z}- \boldsymbol \mu) \right) ,
\]</span>
for <span class="math inline">\(\mathbf{z} \in R^p\)</span> and <span class="math inline">\(k_p\)</span> is a constant, determined so the density integrates to one. The function <span class="math inline">\(g_p(\cdot)\)</span> is called a <em>generator</em> because it can be used to produce different distributions. <a href="ChapDependenceModel.html#tab:16.7">Table 16.7</a> summarizes a few choices used in actuarial practice. The choice <span class="math inline">\(g_p(x) = \exp(-x)\)</span> gives rises to the normal <em>pdf</em> in equation <a href="ChapDependenceModel.html#eq:Normalpdf">(16.4)</a>. The choice <span class="math inline">\(g_p(x) = \exp(-(1+2x/r)^{-(p+r)/2})\)</span> gives rise to a multivariate <span class="math inline">\(t\)</span>- distribution with <span class="math inline">\(r\)</span> degrees of freedom with <em>pdf</em>
<span class="math display">\[
h_{t_r} (\mathbf{z})= \frac{k_p}{\sqrt{\det \boldsymbol \Sigma}}
\exp\left[- \left( 1+ \frac{(\mathbf{z}- \boldsymbol \mu)^{\prime} \boldsymbol \Sigma^{-1}(\mathbf{z}- \boldsymbol \mu)}{r} \right)^{-(p+r)/2}\right] .
\]</span></p>
<p><a id=tab:16.7></a></p>
<p><strong><span id="tab:16.7">Table 16.7</span>. Generator Functions (<span class="math inline">\(g_p(\cdot)\)</span>) for Selected Elliptical Distributions</strong></p>
<p><span class="math display">\[
\small\begin{array}{lc}
\hline &amp; Generator \\
Distribution &amp;  g_p(x)  \\
\hline
\text{Normal distribution} &amp;  e^{-x}\\
t-\text{distribution with }r \text{ degrees of freedom} &amp;   (1+2x/r)^{-(p+r)/2}\\
\text{Cauchy} &amp;  (1+2x)^{-(p+1)/2}\\
\text{Logistic} &amp;  e^{-x}/(1+e^{-x})^2\\
\text{Exponential power} &amp;   \exp(-rx^s)\\
\hline
\end{array}
\]</span></p>
<p>We can use elliptical distributions to generate copulas. Because copulas are concerned primarily with relationships, we may restrict our considerations to the case where <span class="math inline">\(\mu = \mathbf{0}\)</span> and <span class="math inline">\(\boldsymbol \Sigma\)</span> is a correlation matrix. With these restrictions, the marginal distributions of the multivariate elliptical copula are identical; we use <span class="math inline">\(H\)</span> to refer to this marginal distribution function and <span class="math inline">\(h\)</span> is the corresponding density. This marginal density is <span class="math inline">\(h(z) = k_1 g_1(z^2/2).\)</span> For example, in the normal case we have <span class="math inline">\(H(\cdot)=\Phi(\cdot)\)</span> and <span class="math inline">\(h(\cdot)=\phi(\cdot)\)</span>.</p>
<p>We are now ready to define the <em>pdf</em> of the <em>elliptical copula</em>, a function defined on the unit cube <span class="math inline">\([0,1]^p\)</span> as</p>
<p><span class="math display">\[
{c}_E(u_1,  \ldots, u_p) = h_E \left(H^{-1}(u_1), \ldots,
H^{-1}(u_p) \right) \prod_{j=1}^p \frac{1}{h(H^{-1}(u_j))}.
\]</span></p>
<p>As noted above, most empirical work focuses on the normal copula and <span class="math inline">\(t\)</span>-copula. Specifically, <span class="math inline">\(t\)</span>-copulas are useful for modeling the dependency in the tails of bivariate distributions, especially in financial risk analysis applications. The <span class="math inline">\(t\)</span>-copulas with same association parameter in varying the degrees of freedom parameter show us different tail dependency structures. For more information about <span class="math inline">\(t\)</span>-copulas, readers can see <span class="citation">Joe (<a href="bibliography.html#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span> and <span class="citation">Hofert et al. (<a href="bibliography.html#ref-hofertelements" role="doc-biblioref">2018</a>)</span>.</p>
<p>We used the same approach as with the fitted Frank copula to fit the Normal and <span class="math inline">\(t\)</span> copula. The <code>R</code> code below fits the Normal and <span class="math inline">\(t\)</span> copula and estimates the expected level of expenses when losses exceed <span class="math inline">\(\$200,000\)</span>. The results show that the estimated expenses using the fitted Normal copula when losses exceed <span class="math inline">\(\$200,000\)</span> is <span class="math inline">\(\$35,411\)</span>. However, this is not a good fit compared to the mean expense of <span class="math inline">\(\$58,807\)</span> from the losses and expenses data. When losses exceed <span class="math inline">\(\$200,000\)</span>, the fitted <span class="math inline">\(t\)</span> copula estimates expenses to be <span class="math inline">\(\$47,354\)</span>, making it a better fit than the Normal copula.</p>
<h5 style="text-align: center;">
<a id="displayCode.ExpectedExp.2" href="javascript:togglecode('toggleCode.ExpectedExp.2','displayCode.ExpectedExp.2');"><i><strong>R Code for using the fitted Normal and t copula to calculate the expected level of expenses</strong></i></a>
</h5>
<div id="toggleCode.ExpectedExp.2" style="display: none">
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ChapDependenceModel.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit Gaussian Copula and Calculate Expenses. </span></span>
<span id="cb247-2"><a href="ChapDependenceModel.html#cb247-2" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb247-3"><a href="ChapDependenceModel.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal copula object with arbitrary parameter value</span></span>
<span id="cb247-4"><a href="ChapDependenceModel.html#cb247-4" aria-hidden="true" tabindex="-1"></a>normal.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.04</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb247-5"><a href="ChapDependenceModel.html#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb247-6"><a href="ChapDependenceModel.html#cb247-6" aria-hidden="true" tabindex="-1"></a>fit.mlnc <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(normal.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>))</span>
<span id="cb247-7"><a href="ChapDependenceModel.html#cb247-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-8"><a href="ChapDependenceModel.html#cb247-8" aria-hidden="true" tabindex="-1"></a>normal.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.4783</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb247-9"><a href="ChapDependenceModel.html#cb247-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-10"><a href="ChapDependenceModel.html#cb247-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2010</span>)</span>
<span id="cb247-11"><a href="ChapDependenceModel.html#cb247-11" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb247-12"><a href="ChapDependenceModel.html#cb247-12" aria-hidden="true" tabindex="-1"></a>normal.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.4783</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb247-13"><a href="ChapDependenceModel.html#cb247-13" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(normal.cop, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;paretoII&quot;</span>,<span class="st">&quot;paretoII&quot;</span>), </span>
<span id="cb247-14"><a href="ChapDependenceModel.html#cb247-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta.ALAE, <span class="at">shape=</span>alpha.ALAE),</span>
<span id="cb247-15"><a href="ChapDependenceModel.html#cb247-15" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">list</span>(<span class="at">scale =</span> theta.LOSS, <span class="at">shape=</span>alpha.LOSS)))</span>
<span id="cb247-16"><a href="ChapDependenceModel.html#cb247-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-17"><a href="ChapDependenceModel.html#cb247-17" aria-hidden="true" tabindex="-1"></a>LossData_Sim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc))</span>
<span id="cb247-18"><a href="ChapDependenceModel.html#cb247-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(LossData_Sim)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;alae&quot;</span>,<span class="st">&quot;loss&quot;</span>)</span>
<span id="cb247-19"><a href="ChapDependenceModel.html#cb247-19" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb247-20"><a href="ChapDependenceModel.html#cb247-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LossData_Sim<span class="sc">$</span>alae<span class="sc">*</span>(LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb247-21"><a href="ChapDependenceModel.html#cb247-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-22"><a href="ChapDependenceModel.html#cb247-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-23"><a href="ChapDependenceModel.html#cb247-23" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb247-24"><a href="ChapDependenceModel.html#cb247-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">35410.6</span></span>
<span id="cb247-25"><a href="ChapDependenceModel.html#cb247-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-26"><a href="ChapDependenceModel.html#cb247-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-27"><a href="ChapDependenceModel.html#cb247-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit t Copula and Calculate Expenses. </span></span>
<span id="cb247-28"><a href="ChapDependenceModel.html#cb247-28" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb247-29"><a href="ChapDependenceModel.html#cb247-29" aria-hidden="true" tabindex="-1"></a><span class="co"># t copula object with arbitrary parameter value</span></span>
<span id="cb247-30"><a href="ChapDependenceModel.html#cb247-30" aria-hidden="true" tabindex="-1"></a>t.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.04</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb247-31"><a href="ChapDependenceModel.html#cb247-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb247-32"><a href="ChapDependenceModel.html#cb247-32" aria-hidden="true" tabindex="-1"></a>fit.mlt <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(t.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">2</span>))</span>
<span id="cb247-33"><a href="ChapDependenceModel.html#cb247-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-34"><a href="ChapDependenceModel.html#cb247-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-35"><a href="ChapDependenceModel.html#cb247-35" aria-hidden="true" tabindex="-1"></a>t.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.4816</span>), <span class="at">dim =</span> <span class="dv">2</span>,<span class="at">df =</span> <span class="fl">9.6474</span>)</span>
<span id="cb247-36"><a href="ChapDependenceModel.html#cb247-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-37"><a href="ChapDependenceModel.html#cb247-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2010</span>)</span>
<span id="cb247-38"><a href="ChapDependenceModel.html#cb247-38" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb247-39"><a href="ChapDependenceModel.html#cb247-39" aria-hidden="true" tabindex="-1"></a>t.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param=</span><span class="fu">c</span>(<span class="fl">0.4816</span>), <span class="at">dim =</span> <span class="dv">2</span>,<span class="at">df =</span> <span class="fl">9.6474</span>)</span>
<span id="cb247-40"><a href="ChapDependenceModel.html#cb247-40" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(t.cop, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;paretoII&quot;</span>,<span class="st">&quot;paretoII&quot;</span>), </span>
<span id="cb247-41"><a href="ChapDependenceModel.html#cb247-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta.ALAE, <span class="at">shape=</span>alpha.ALAE),</span>
<span id="cb247-42"><a href="ChapDependenceModel.html#cb247-42" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">list</span>(<span class="at">scale =</span> theta.LOSS, <span class="at">shape=</span>alpha.LOSS)))</span>
<span id="cb247-43"><a href="ChapDependenceModel.html#cb247-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-44"><a href="ChapDependenceModel.html#cb247-44" aria-hidden="true" tabindex="-1"></a>LossData_Sim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc))</span>
<span id="cb247-45"><a href="ChapDependenceModel.html#cb247-45" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(LossData_Sim)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;alae&quot;</span>,<span class="st">&quot;loss&quot;</span>)</span>
<span id="cb247-46"><a href="ChapDependenceModel.html#cb247-46" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb247-47"><a href="ChapDependenceModel.html#cb247-47" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LossData_Sim<span class="sc">$</span>alae<span class="sc">*</span>(LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb247-48"><a href="ChapDependenceModel.html#cb247-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-49"><a href="ChapDependenceModel.html#cb247-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-50"><a href="ChapDependenceModel.html#cb247-50" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb247-51"><a href="ChapDependenceModel.html#cb247-51" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">47353.78</span></span></code></pre></div>
</div>
</div>
<div id="archimedean-copulas" class="section level3 hasAnchor" number="16.4.3">
<h3><span class="header-section-number">16.4.3</span> Archimedean Copulas<a href="ChapDependenceModel.html#archimedean-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This class of copulas is also constructed from a <em>generator</em> function. For Archimedean copulas, we assume that <span class="math inline">\(g(\cdot)\)</span> is a convex, decreasing function with domain [0,1] and range <span class="math inline">\([0, \infty)\)</span> such that <span class="math inline">\(g(0)=0\)</span>. Use <span class="math inline">\(g^{-1}\)</span> for the inverse function of <span class="math inline">\(g\)</span>. Then the function</p>
<p><span class="math display">\[
C_g(u_1, \ldots, u_p) = g^{-1} \left(g(u_1)+ \cdots + g(u_p) \right)
\]</span></p>
<p>is said to be an <em>Archimedean</em> copula distribution function.</p>
<p>For the bivariate case, <span class="math inline">\(p=2\)</span>, an Archimedean copula function can be written by the function</p>
<p><span class="math display">\[
C_{g}(u_1, \, u_2) = g^{-1} \left(g(u_1) + g(u_2) \right).
\]</span></p>
<p>Some important special cases of Archimedean copulas include the Frank, Clayton/Cook-Johnson, and Gumbel/Hougaard copulas. Each copula class is derived from different generator functions. As another useful special case, recall the Frank’s copula described in Sections <a href="ChapDependenceModel.html#S:Sec162">16.2</a> and <a href="ChapDependenceModel.html#S:Sec163">16.3</a>. To illustrate, we now provide explicit expressions for the Clayton and Gumbel/Hougaard copulas.</p>
<div id="clayton-copula" class="section level4 unnumbered hasAnchor">
<h4>Clayton Copula<a href="ChapDependenceModel.html#clayton-copula" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For <span class="math inline">\(p=2\)</span>, the Clayton copula with parameter <span class="math inline">\(\gamma \in [-1,\infty)\)</span> is defined by</p>
<p><span class="math display">\[
C_{\gamma}^C(u)=\max\{u_1^{-\gamma}+u_2^{-\gamma}-1,0\}^{1/\gamma}, \quad u \in [0,1]^2.
\]</span></p>
<p>This is a bivariate distribution function defined on the unit square <span class="math inline">\([0,1]^2.\)</span> The range of dependence is controlled by the parameter <span class="math inline">\(\gamma\)</span>, similar to Frank’s copula.</p>
</div>
<div id="gumbel-hougaard-copula" class="section level4 unnumbered hasAnchor">
<h4>Gumbel-Hougaard Copula<a href="ChapDependenceModel.html#gumbel-hougaard-copula" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Gumbel-Hougaard copula is parametrized by <span class="math inline">\(\gamma \in [1,\infty)\)</span> and defined by</p>
<p><span class="math display">\[
C_{\gamma}^{GH}(u)=\exp\left(-\left(\sum_{i=1}^2 (-\log u_i)^{\gamma}\right)^{1/\gamma}\right), \quad u\in[0,1]^2.
\]</span></p>
<p>For more information on Archimedean copulas, see <span class="citation">Joe (<a href="bibliography.html#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>, <span class="citation">Frees and Valdez (<a href="bibliography.html#ref-frees1998understanding" role="doc-biblioref">1998</a>)</span>, and <span class="citation">Genest and Mackay (<a href="bibliography.html#ref-genest1986bivariate" role="doc-biblioref">1986</a>)</span>.</p>
<p>We used the same approach to fit the Clayton and Gumbel-Hougaard copulas as we did for the fitted Frank copula. The <code>R</code> code below fits these two copulas and determines the expected expense level for losses higher than <span class="math inline">\(\$200,000\)</span>. Our analysis shows that the estimated expenses for losses exceeding <span class="math inline">\(\$200,000\)</span> using the fitted Clayton copula are <span class="math inline">\(\$14,209\)</span>, while the fitted Gumbel-Hougaard copula predicts <span class="math inline">\(\$58,554\)</span>. Of all the copula types considered, the Gumbel-Hougaard copula provides the best fit for this data. For more on Goodness-of-fit tests, see <span class="citation">Hofert et al. (<a href="bibliography.html#ref-hofertelements" role="doc-biblioref">2018</a>)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.ExpectedExp.3" href="javascript:togglecode('toggleCode.ExpectedExp.3','displayCode.ExpectedExp.3');"><i><strong>R Code for using the fitted Clayton and Gumbel-Hougaard copula to calculate the expected level of expenses</strong></i></a>
</h5>
<div id="toggleCode.ExpectedExp.3" style="display: none">
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ChapDependenceModel.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit Clayton Copula and Calculate Expenses. </span></span>
<span id="cb248-2"><a href="ChapDependenceModel.html#cb248-2" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb248-3"><a href="ChapDependenceModel.html#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clayton&#39;s copula object with arbitrary parameter value</span></span>
<span id="cb248-4"><a href="ChapDependenceModel.html#cb248-4" aria-hidden="true" tabindex="-1"></a>clayton.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;clayton&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-5"><a href="ChapDependenceModel.html#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb248-6"><a href="ChapDependenceModel.html#cb248-6" aria-hidden="true" tabindex="-1"></a>fitclayton.ml <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(clayton.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>))</span>
<span id="cb248-7"><a href="ChapDependenceModel.html#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitclayton.ml)</span>
<span id="cb248-8"><a href="ChapDependenceModel.html#cb248-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-9"><a href="ChapDependenceModel.html#cb248-9" aria-hidden="true" tabindex="-1"></a>clayton.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;clayton&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="fl">0.5678</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-10"><a href="ChapDependenceModel.html#cb248-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-11"><a href="ChapDependenceModel.html#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2010</span>)</span>
<span id="cb248-12"><a href="ChapDependenceModel.html#cb248-12" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb248-13"><a href="ChapDependenceModel.html#cb248-13" aria-hidden="true" tabindex="-1"></a>clayton.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;clayton&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="fl">0.5678</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-14"><a href="ChapDependenceModel.html#cb248-14" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(clayton.cop, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;paretoII&quot;</span>,<span class="st">&quot;paretoII&quot;</span>), </span>
<span id="cb248-15"><a href="ChapDependenceModel.html#cb248-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta.ALAE, <span class="at">shape=</span>alpha.ALAE),</span>
<span id="cb248-16"><a href="ChapDependenceModel.html#cb248-16" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">list</span>(<span class="at">scale =</span> theta.LOSS, <span class="at">shape=</span>alpha.LOSS)))</span>
<span id="cb248-17"><a href="ChapDependenceModel.html#cb248-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-18"><a href="ChapDependenceModel.html#cb248-18" aria-hidden="true" tabindex="-1"></a>LossData_Sim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc))</span>
<span id="cb248-19"><a href="ChapDependenceModel.html#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(LossData_Sim)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;alae&quot;</span>,<span class="st">&quot;loss&quot;</span>)</span>
<span id="cb248-20"><a href="ChapDependenceModel.html#cb248-20" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb248-21"><a href="ChapDependenceModel.html#cb248-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LossData_Sim<span class="sc">$</span>alae<span class="sc">*</span>(LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb248-22"><a href="ChapDependenceModel.html#cb248-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-23"><a href="ChapDependenceModel.html#cb248-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-24"><a href="ChapDependenceModel.html#cb248-24" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb248-25"><a href="ChapDependenceModel.html#cb248-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">14208.16</span></span>
<span id="cb248-26"><a href="ChapDependenceModel.html#cb248-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-27"><a href="ChapDependenceModel.html#cb248-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit Gumbel-Hougaard Copula and Calculate Expenses. </span></span>
<span id="cb248-28"><a href="ChapDependenceModel.html#cb248-28" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb248-29"><a href="ChapDependenceModel.html#cb248-29" aria-hidden="true" tabindex="-1"></a><span class="co"># gumbel&#39;s copula object with arbitrary parameter value</span></span>
<span id="cb248-30"><a href="ChapDependenceModel.html#cb248-30" aria-hidden="true" tabindex="-1"></a>gumbel.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;gumbel&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-31"><a href="ChapDependenceModel.html#cb248-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb248-32"><a href="ChapDependenceModel.html#cb248-32" aria-hidden="true" tabindex="-1"></a>fitgumbel.ml <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(gumbel.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>))</span>
<span id="cb248-33"><a href="ChapDependenceModel.html#cb248-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitgumbel.ml)</span>
<span id="cb248-34"><a href="ChapDependenceModel.html#cb248-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-35"><a href="ChapDependenceModel.html#cb248-35" aria-hidden="true" tabindex="-1"></a>gumbel.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;gumbel&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="fl">1.444</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-36"><a href="ChapDependenceModel.html#cb248-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-37"><a href="ChapDependenceModel.html#cb248-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2010</span>)</span>
<span id="cb248-38"><a href="ChapDependenceModel.html#cb248-38" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb248-39"><a href="ChapDependenceModel.html#cb248-39" aria-hidden="true" tabindex="-1"></a>gumbel.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;gumbel&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="fl">1.444</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb248-40"><a href="ChapDependenceModel.html#cb248-40" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(gumbel.cop, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;paretoII&quot;</span>,<span class="st">&quot;paretoII&quot;</span>), </span>
<span id="cb248-41"><a href="ChapDependenceModel.html#cb248-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta.ALAE, <span class="at">shape=</span>alpha.ALAE),</span>
<span id="cb248-42"><a href="ChapDependenceModel.html#cb248-42" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">list</span>(<span class="at">scale =</span> theta.LOSS, <span class="at">shape=</span>alpha.LOSS)))</span>
<span id="cb248-43"><a href="ChapDependenceModel.html#cb248-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-44"><a href="ChapDependenceModel.html#cb248-44" aria-hidden="true" tabindex="-1"></a>LossData_Sim <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc))</span>
<span id="cb248-45"><a href="ChapDependenceModel.html#cb248-45" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(LossData_Sim)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;alae&quot;</span>,<span class="st">&quot;loss&quot;</span>)</span>
<span id="cb248-46"><a href="ChapDependenceModel.html#cb248-46" aria-hidden="true" tabindex="-1"></a>Threshold<span class="ot">&lt;-</span><span class="dv">200000</span></span>
<span id="cb248-47"><a href="ChapDependenceModel.html#cb248-47" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LossData_Sim<span class="sc">$</span>alae<span class="sc">*</span>(LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold))<span class="sc">/</span><span class="fu">sum</span>((LossData_Sim<span class="sc">$</span>loss<span class="sc">&gt;</span>Threshold)) </span>
<span id="cb248-48"><a href="ChapDependenceModel.html#cb248-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-49"><a href="ChapDependenceModel.html#cb248-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-50"><a href="ChapDependenceModel.html#cb248-50" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb248-51"><a href="ChapDependenceModel.html#cb248-51" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">58554.37</span></span></code></pre></div>
</div>
<hr />
<div id="surveyElement164">

</div>
<div id="surveyResult164">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz164.1" href="javascript:toggleQuiz
('display.Quiz164.2','display.Quiz164.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz164.2" style="display: none">
<p id="Quiz164Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz164.js">
</script>
</div>
</div>
</div>
<div id="properties-of-copulas" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Properties of Copulas<a href="ChapDependenceModel.html#properties-of-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Interpret bounds that limit copula distribution functions as the amount of dependence varies</li>
<li>Calculate measures of association for different copulas and interpret their properties</li>
<li>Interpret tail dependency for different copulas</li>
</ul>
<hr />
<p>With many choices of copulas available, it is helpful for analysts to understand general features of how these alternatives behave.</p>
<div id="S:Sec1651" class="section level3 hasAnchor" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Bounds on Association<a href="ChapDependenceModel.html#S:Sec1651" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Any distribution function is bounded below by zero and from above by one. Additional types of bounds are available in multivariate contexts. These bounds are useful when studying dependencies. That is, as an analyst thinks about variables as being extremely dependent, one has available bounds that cannot be exceeded, regardless of the dependence. The most widely used bounds in dependence modeling are known as the <em>Fréchet-Höeffding</em> bounds, given as</p>
<p><span class="math display">\[
\max( u_1 +\cdots+ u_p - p +1, 0) \leq  C(u_1,  \ldots, u_p) \leq \min (u_1,  \ldots,u_p).
\]</span></p>
<p>To see the right-hand side of this equation, note that</p>
<p><span class="math display">\[
C(u_1,\ldots, u_p) = \Pr(U_1 \leq u_1, \ldots, U_p \leq u_p) \leq  \Pr(U_j \leq u_j),
\]</span></p>
<p>for <span class="math inline">\(j=1,\ldots,p\)</span>. The bound is achieved when <span class="math inline">\(U_1 = \cdots = U_p\)</span>. To see the left-hand side when <span class="math inline">\(p=2\)</span>, consider <span class="math inline">\(U_2=1-U_1\)</span>. In this case, if <span class="math inline">\(1-u_2 &lt; u_1\)</span> then</p>
<p><span class="math display">\[
\Pr(U_1 \leq u_1, U_2 \leq u_2) = \Pr ( 1-u_2 \leq U_1 &lt; u_1) =u_1+u_2-1.
\]</span>
See, for example, <span class="citation">Nelson (<a href="bibliography.html#ref-nelsen1997introduction" role="doc-biblioref">1997</a>)</span> for additional discussion.</p>
<p>To see how these bounds relate to the concept of dependence, consider the case of <span class="math inline">\(p=2\)</span>. As a benchmark, first note that the product copula, <span class="math inline">\(C(u_1,u_2)=u_1 \cdot u_2\)</span>, is the result of assuming independence between random variables. Now, from the above discussion, we see that the lower bound is achieved when the two random variables are perfectly negatively related (<span class="math inline">\(U_2=1-U_1\)</span>). Further, it is clear that the upper bound is achieved when they are perfectly positively related (<span class="math inline">\(U_2=U_1\)</span>). To emphasize this, the <a href="#" class="tooltip" style="color:green"><em>Frechet-Hoeffding bounds</em><span style="font-size:8pt">Bounds of multivariate distribution functions</span></a> for two random variables appear in Figure <a href="ChapDependenceModel.html#fig:Fig1612">16.12</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig1612"></span>
<img src="LDAEd2_files/figure-html/Fig1612-1.png" alt="Perfect Positive and Perfect Negative Dependence Plots" width="60%" />
<p class="caption">
Figure 16.12: <strong>Perfect Positive and Perfect Negative Dependence Plots</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.plot.1" href="javascript:togglecode('toggleCode.plot.1','displayCode.plot.1');"><i><strong>R Code for the Fréchet-Höeffding Bounds for Two Random Variables</strong></i></a>
</h5>
<div id="toggleCode.plot.1" style="display: none">
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="ChapDependenceModel.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1980</span>)</span>
<span id="cb249-2"><a href="ChapDependenceModel.html#cb249-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb249-3"><a href="ChapDependenceModel.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb249-4"><a href="ChapDependenceModel.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, <span class="dv">1</span> <span class="sc">-</span> U), <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]), <span class="at">main =</span> <span class="st">&quot;Perfect Negative Dependency&quot;</span>)  <span class="co"># W for p=2</span></span>
<span id="cb249-5"><a href="ChapDependenceModel.html#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, U), <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]), <span class="at">main =</span> <span class="st">&quot;Perfect Positive Dependency&quot;</span>)  <span class="co">#M for p=2</span></span></code></pre></div>
</div>
<p>Let’s assign the Fréchet-Höeffding lower bound as <span class="math inline">\(W\)</span> and the upper bound as <span class="math inline">\(M\)</span>. That is, <span class="math inline">\(W=\max(u_1+\cdots+u_p-p+1, 0)\)</span> and <span class="math inline">\(M=\min(u_1,\ldots,u_p)\)</span>. It’s important to note that <span class="math inline">\(W\)</span> is a copula only if <span class="math inline">\(p=2\)</span>, while <span class="math inline">\(M\)</span> is a copula for all <span class="math inline">\(p\geq2\)</span>. In dimension two, <span class="math inline">\(W=\max(u_1+u_2-1, 0)\)</span> is known as the <strong>counter-monotonic copula</strong>. It captures the inverse relationship between two variables, that is, two random variables that are perfectly negatively related. On the other hand, <span class="math inline">\(M=\min(u_1,u_2)\)</span> in dimension two is known as the <strong>comonotone copula</strong>. It captures the relationship between two variables where one is related to the other by a strictly increasing function, that is, two random variables that are perfectly positively dependent. The co-monotonic copulas can be extended to the multivariate case. However, it’s not possible to extend the counter-monotonic copula because it’s not possible to have three or more variables where each pair has a direct inverse relationship.</p>
<p><strong>Example 16.5.1. Largest Possible Value Example</strong></p>
<p>Suppose we have a variable <span class="math inline">\(X\)</span> that follows a Pareto distribution with a scale parameter of <span class="math inline">\(\theta=10\)</span> and a shape parameter of <span class="math inline">\(\alpha=1.6\)</span>. Additionally, let <span class="math inline">\(Y\)</span> be an exponential variable with a mean value of 8. Let <span class="math inline">\(F_{X,Y}(x,y)\)</span> be the joint distribution function. What is the largest possible value of <span class="math inline">\(F_{X,Y}(7.2,4.1)\)</span>?</p>
<h5 style="text-align: center;">
<a id="displayExample.16.5.1" href="javascript:toggleEX('toggleExample.16.5.1','displayExample.16.5.1');"><i><strong>Show Example Solution</strong></i></a>
</h5>
<div id="toggleExample.16.5.1" style="display: none">
<p><em>Example Solution.</em> Let <span class="math inline">\(C(u,v)\)</span> is the copula that links <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Denote the marginal distribution functions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as <span class="math inline">\(F_X(x)\)</span> and <span class="math inline">\(F_Y(y)\)</span>, respectively. Since <span class="math inline">\(F_{X,Y}(7.2,4.1)=C[F_X(7.2),F_Y(4.1)]\)</span>, we can use the marginal distribution functions to obtain the arguments of the copula function:</p>
<p>For the Pareto variable, <span class="math inline">\(X\)</span>:
<span class="math display">\[ F_X(7.2)=1- \left(  \frac{10}{7.2+ 10} \right) ^{1.6} =0.58.\]</span>
For the Exponential variable, <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[F_Y(4.1)=1-e^{-0.125\times 4.1}=0.40.\]</span></p>
<p>Hence, <span class="math inline">\(F_{X,Y}(7.2,4.1)=C[0.58,0.40]\)</span>. Now:</p>
<p>The largest value of the joint distribution function is obtained when the dependence structure is comonotonic, or <span class="math inline">\(C(u, v)=\min (u, v)\)</span>. Hence, the answer required is <span class="math inline">\(\min (0.58,0.40)=0.40\)</span>.</p>
</div>
<hr />
</div>
<div id="S:Sec1652" class="section level3 hasAnchor" number="16.5.2">
<h3><span class="header-section-number">16.5.2</span> Measures of Association<a href="ChapDependenceModel.html#S:Sec1652" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Empirical versions of Spearman’s rho and Kendall’s tau were introduced in Section <a href="ChapDependenceModel.html#S:Sec1612">16.1.2</a>, respectively. The interesting thing about these expressions is that these summary measures of association are based <strong>only</strong> on the ranks of each variable. Thus, any strictly increasing transform does not affect these measures of association. Specifically, consider two random variables, <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>, and let m<span class="math inline">\(_1\)</span> and m<span class="math inline">\(_2\)</span> be strictly increasing functions. Then, the association, when measured by Spearman’s rho or Kendall’s tau, between <span class="math inline">\(m_1(Y_1)\)</span> and <span class="math inline">\(m_2(Y_2)\)</span> does not change regardless of the choice of m<span class="math inline">\(_1\)</span> and m<span class="math inline">\(_2\)</span>. For example, this allows analysts to consider dollars, Euros, or log dollars, and still retain the same essential dependence. As we have seen in Section <a href="ChapDependenceModel.html#S:Sec161">16.1</a>, this is not the case with the Pearson’s measure of correlation.</p>
<p><span class="citation">Schweizer, Wolff, et al. (<a href="bibliography.html#ref-schweizer1981nonparametric" role="doc-biblioref">1981</a>)</span> established that the copula accounts for all the dependence in the sense that the way <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> “move together” is captured by the copula, regardless of the scale in which each variable is measured. They also showed that (population versions of) the two standard nonparametric measures of association could be expressed solely in terms of the copula function. Spearman’s correlation coefficient is given by
<span class="math display" id="eq:TheorySpearman">\[\begin{equation}
\rho_S = 12 \int_0^1 \int_0^1  \left\{C(u,v) - uv \right\} du dv.
\tag{16.5}
\end{equation}\]</span>
Kendall’s tau is given by
<span class="math display">\[
\tau= 4 \int_0^1  \int_0^1  C(u,v)~dC(u,v) - 1 .
\]</span>
For these expressions, we assume that <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> have a jointly continuous distribution function.</p>
<p><strong>Example. Loss versus Expenses</strong>. Earlier, in Section <a href="ChapDependenceModel.html#S:Sec163">16.3</a>, we saw that the Spearman’s correlation was 0.452, calculated with the <code>rho</code> function. Then, we fit Frank’s copula to these data, and estimated the dependence parameter to be <span class="math inline">\(\hat{\gamma} = 3.114\)</span>. As an alternative, the following code shows how to use the empirical version of equation <a href="ChapDependenceModel.html#eq:TheorySpearman">(16.5)</a>. In this case, the Spearman’s correlation coefficient is 0.462, which is close to the sample Spearman’s correlation coefficient, 0.452.</p>
<h5 style="text-align: center;">
<a id="displayCode.fittedCop.1" href="javascript:togglecode('toggleCode.fittedCop.1','displayCode.fittedCop.1');"><i><strong>R Code for Spearman’s Correlation Using Frank’s Copula</strong></i></a>
</h5>
<div id="toggleCode.fittedCop.1" style="display: none">
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ChapDependenceModel.html#cb250-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">param =</span> fit.ml<span class="sc">@</span>estimate)</span>
<span id="cb250-2"><a href="ChapDependenceModel.html#cb250-2" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param=</span> param, <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb250-3"><a href="ChapDependenceModel.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rho</span>(frank.cop) </span>
<span id="cb250-4"><a href="ChapDependenceModel.html#cb250-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-5"><a href="ChapDependenceModel.html#cb250-5" aria-hidden="true" tabindex="-1"></a>Output <span class="sc">:</span> </span>
<span id="cb250-6"><a href="ChapDependenceModel.html#cb250-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4622722</span></span></code></pre></div>
</div>
</div>
<div id="tail-dependency" class="section level3 hasAnchor" number="16.5.3">
<h3><span class="header-section-number">16.5.3</span> Tail Dependency<a href="ChapDependenceModel.html#tail-dependency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As discussed in Section <a href="ChapDependenceModel.html#S:Sec1613">16.1.3</a>, there are applications in which it is useful to distinguish the part of the distribution in which the association is strongest. For example, in insurance it is helpful to understand association among the largest losses, that is, association in the right tails of the data. This subsection defines upper and lower tail dependency in terms of copulas.</p>
<p>To capture this type of dependency, we use the <em>right-tail concentration</em> function, defined as
<span class="math display">\[
R(z) = \frac{\Pr(U_1 &gt;z, U_2 &gt; z)}{1-z} =\Pr(U_1 &gt; z | U_2 &gt; z) =\frac{1 - 2z + C(z,z)}{1-z} .
\]</span>
As a benchmark, <span class="math inline">\(R(z)\)</span> will be equal to <span class="math inline">\(z\)</span> under independence. Joe (1997) uses the term “upper tail dependence parameter” for <span class="math inline">\(R = \lim_{z \rightarrow 1} R(z)\)</span>.</p>
<p>In the same way, one can define the <em>left-tail concentration</em> function as
<span class="math display">\[
L(z) = \frac{\Pr(U_1 \leq z, U_2 \leq z)}{z}=\Pr(U_1 \leq z | U_2 \leq z) =\frac{ C(z,z)}{z},
\]</span>
with the lower tail dependence parameter <span class="math inline">\(L = \lim_{z \rightarrow 0} L(z)\)</span>. A <a href="#" class="tooltip" style="color:green"><em>tail dependency</em><span style="font-size:8pt">A measure of their comovements in the tails of the distributions</span></a> concentration function captures the probability of two random variables simultaneously having extreme values.</p>
<p>It is of interest to see how well a given copula can capture tail dependence. To this end, we calculate the left and right tail concentration functions for four different types of copulas; Normal, Frank, Gumbel and <span class="math inline">\(t\)</span>- copulas. The results are summarized for concentration function values for these four copulas in <a href="ChapDependenceModel.html#tab:16.8">Table 16.8</a>. As in <span class="citation">Gary G. Venter (<a href="bibliography.html#ref-venter2002tails" role="doc-biblioref">2002</a>)</span>, we show <span class="math inline">\(L(z)\)</span> for <span class="math inline">\(z\leq 0.5\)</span> and <span class="math inline">\(R(z)\)</span> for <span class="math inline">\(z&gt;0.5\)</span> in the tail dependence plot in Figure <a href="ChapDependenceModel.html#fig:Fig1613">16.13</a>. We interpret the tail dependence plot to mean that both the Frank and Normal copula exhibit no tail dependence whereas the <span class="math inline">\(t\)</span>- and the Gumbel do so. The <span class="math inline">\(t\)</span>- copula is symmetric in its treatment of upper and lower tails.</p>
<p><a id=tab:16.8></a></p>
<p><strong><span id="tab:16.8">Table 16.8</span>. Tail Dependence Parameters for Four Copulas</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rr}
    \hline
\text{Copula} &amp; \text{Lower}    &amp; \text{Upper}     \\
\hline
\text{Frank}  &amp; 0  &amp; 0   \\
\text{Gumbel}  &amp; 0   &amp; 0.74    \\
\text{Normal}  &amp; 0   &amp; 0    \\
t-  &amp; 0.10   &amp; 0.10    \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.Tail.1" href="javascript:togglecode('toggleCode.Tail.1','displayCode.Tail.1');"><i><strong>R Code for Tail Copula Functions for Different Copulas</strong></i></a>
</h5>
<div id="toggleCode.Tail.1" style="display: none">
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ChapDependenceModel.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb251-2"><a href="ChapDependenceModel.html#cb251-2" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">by =</span> <span class="fl">0.002</span>)</span>
<span id="cb251-3"><a href="ChapDependenceModel.html#cb251-3" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.002</span>)</span>
<span id="cb251-4"><a href="ChapDependenceModel.html#cb251-4" aria-hidden="true" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">rbind</span>(U1, U2)</span>
<span id="cb251-5"><a href="ChapDependenceModel.html#cb251-5" aria-hidden="true" tabindex="-1"></a>TailFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(Tailcop) {</span>
<span id="cb251-6"><a href="ChapDependenceModel.html#cb251-6" aria-hidden="true" tabindex="-1"></a>    lowertail <span class="ot">&lt;-</span> <span class="fu">pCopula</span>(<span class="fu">cbind</span>(U1, U1), Tailcop)<span class="sc">/</span>U1</span>
<span id="cb251-7"><a href="ChapDependenceModel.html#cb251-7" aria-hidden="true" tabindex="-1"></a>    uppertail <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> U2 <span class="sc">+</span> <span class="fu">pCopula</span>(<span class="fu">cbind</span>(U2, U2), Tailcop))<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> U2)</span>
<span id="cb251-8"><a href="ChapDependenceModel.html#cb251-8" aria-hidden="true" tabindex="-1"></a>    jointtail <span class="ot">&lt;-</span> <span class="fu">rbind</span>(lowertail, uppertail)</span>
<span id="cb251-9"><a href="ChapDependenceModel.html#cb251-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-10"><a href="ChapDependenceModel.html#cb251-10" aria-hidden="true" tabindex="-1"></a>Tailcop1 <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="at">family =</span> <span class="st">&quot;frank&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.05</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb251-11"><a href="ChapDependenceModel.html#cb251-11" aria-hidden="true" tabindex="-1"></a>Tailcop2 <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="at">family =</span> <span class="st">&quot;gumbel&quot;</span>, <span class="at">param =</span> <span class="dv">3</span>)</span>
<span id="cb251-12"><a href="ChapDependenceModel.html#cb251-12" aria-hidden="true" tabindex="-1"></a>Tailcop3 <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb251-13"><a href="ChapDependenceModel.html#cb251-13" aria-hidden="true" tabindex="-1"></a>Tailcop4 <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>, <span class="at">df =</span> <span class="dv">5</span>)</span>
<span id="cb251-14"><a href="ChapDependenceModel.html#cb251-14" aria-hidden="true" tabindex="-1"></a>jointtail1 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop1)</span>
<span id="cb251-15"><a href="ChapDependenceModel.html#cb251-15" aria-hidden="true" tabindex="-1"></a>jointtail2 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop2)</span>
<span id="cb251-16"><a href="ChapDependenceModel.html#cb251-16" aria-hidden="true" tabindex="-1"></a>jointtail3 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop3)</span>
<span id="cb251-17"><a href="ChapDependenceModel.html#cb251-17" aria-hidden="true" tabindex="-1"></a>jointtail4 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop4)</span></code></pre></div>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig1613"></span>
<img src="LDAEd2_files/figure-html/Fig1613-1.png" alt="Tail Dependence Plots" width="80%" />
<p class="caption">
Figure 16.13: <strong>Tail Dependence Plots</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Tailplot.1" href="javascript:togglecode('toggleCode.Tailplot.1','displayCode.Tailplot.1');"><i><strong>R Code for Tail Dependence Plot for Different Copulas</strong></i></a>
</h5>
<div id="toggleCode.Tailplot.1" style="display: none">
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="ChapDependenceModel.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U, jointtail1, <span class="at">cex =</span> <span class="fl">0.2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;Tail Dependence&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb252-2"><a href="ChapDependenceModel.html#cb252-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>))</span>
<span id="cb252-3"><a href="ChapDependenceModel.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail2, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb252-4"><a href="ChapDependenceModel.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail3, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb252-5"><a href="ChapDependenceModel.html#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail4, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb252-6"><a href="ChapDependenceModel.html#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.75</span>, <span class="fl">0.1</span>, <span class="st">&quot;Frank&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#1</span></span>
<span id="cb252-7"><a href="ChapDependenceModel.html#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="st">&quot;Gumbel&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#2</span></span>
<span id="cb252-8"><a href="ChapDependenceModel.html#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="st">&quot;normal&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#3</span></span>
<span id="cb252-9"><a href="ChapDependenceModel.html#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">0.17</span>, <span class="fl">0.1</span>, <span class="fl">0.07</span>, <span class="fl">0.12</span>, <span class="at">code =</span> <span class="dv">2</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb252-10"><a href="ChapDependenceModel.html#cb252-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.9</span>, <span class="fl">0.4</span>, <span class="st">&quot;t with 5 df&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#4</span></span></code></pre></div>
</div>
<p><strong>Example 16.5.2. Lower Tail Dependence Coefficient Example</strong></p>
<p>The bivariate distribution function <span class="math inline">\(C(u,v)=uv\)</span>. What is the lower tail dependence coefficient of this copula?</p>
<h5 style="text-align: center;">
<a id="displayExample.16.5.2" href="javascript:toggleEX('toggleExample.16.5.2','displayExample.16.5.2');"><i><strong>Show Example Solution</strong></i></a>
</h5>
<div id="toggleExample.16.5.2" style="display: none">
<p><em>Example Solution.</em></p>
<p><span class="math display">\[
\begin{aligned}
\lambda_{lo} &amp; =\lim _{u \rightarrow 0^{+}} \frac{C(u, u)}{u}=\lim _{u \rightarrow 0^{+}} \frac{u^2}{u} =\lim _{u \rightarrow 0^{+}} u=0
\end{aligned}
\]</span></p>
</div>
<hr />
<div id="surveyElement165">

</div>
<div id="surveyResult165">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz165.1" href="javascript:toggleQuiz
('display.Quiz165.2','display.Quiz165.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz165.2" style="display: none">
<p id="Quiz165Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz165.js">
</script>
</div>
</div>
<div id="S:Sec166" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Importance of Dependence Modeling<a href="ChapDependenceModel.html#S:Sec166" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Explain the importance of dependence modeling</li>
<li>Explain the importance of copulas for regression applications</li>
</ul>
<hr />
<div id="why-is-dependence-modeling-important" class="section level3 hasAnchor" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Why is Dependence Modeling Important?<a href="ChapDependenceModel.html#why-is-dependence-modeling-important" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dependence modeling is important because it enables us to understand the dependence structure by defining the relationship between variables in a dataset. In insurance, ignoring dependence modeling may not impact pricing but could lead to misestimation of required capital to cover losses. For instance, from Section <a href="ChapDependenceModel.html#S:Sec163">16.3</a> , it is seen that there was a positive relationship between <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span>. This means that, if there is a large loss then we expect expenses to be large as well and ignoring this relationship could lead to mis-estimation of reserves.</p>
<p>To illustrate the importance of dependence modeling, we refer you back to portfolio management <a href="ChapPortMgt.html#Ex:13.4.6">Example 13.4.6</a> that assumed that the property and liability risks are independent. Now, we incorporate dependence by allowing the four lines of business to depend on one another through a Gaussian copula. In <a href="ChapDependenceModel.html#tab:16.9">Table 16.9</a>, we show that dependence affects the portfolio quantiles (<span class="math inline">\(VaR_q\)</span>), although not the expected values. For instance, the <span class="math inline">\(VaR_{0.99}\)</span> for total risk which is the amount of capital required to ensure, with a <span class="math inline">\(99\%\)</span> degree of certainty that the firm does not become technically insolvent is higher when we incorporate dependence. This leads to less capital being allocated when dependence is ignored and can cause unexpected solvency problems.</p>
<div style="page-break-after: always;"></div>
<p><a id=tab:16.9></a></p>
<p><strong><span id="tab:16.9">Table 16.9</span>. Results for Portfolio Expected Value and Quantiles (<span class="math inline">\(VaR_q\)</span>)</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rrrr}
    \hline
\text{Independent} &amp;\text{Expected}   &amp; VaR_{0.9}  &amp; VaR_{0.95}  &amp; VaR_{0.99}  \\
                   &amp;\text{Value}      &amp;            &amp;             &amp;             \\
     \hline              
\text{Retained}    &amp; 269              &amp;  300       &amp; 300         &amp; 300         \\
\text{Insurer}     &amp; 2,274            &amp;  4,400     &amp; 6,173       &amp; 11,859      \\
\text{Total}       &amp; 2,543            &amp;  4,675     &amp; 6,464       &amp; 12,159      \\
   \hline
\text{Gaussian Copula}&amp;\text{Expected}&amp; VaR_{0.9}  &amp; VaR_{0.95}  &amp; VaR_{0.99}  \\
                      &amp;\text{Value}    &amp;           &amp;             &amp;              \\
     \hline                      
\text{Retained}       &amp; 269            &amp;  300      &amp; 300         &amp;  300         \\
\text{Insurer}        &amp; 2,340          &amp;  4,988    &amp; 7,339       &amp; 14,905       \\
\text{Total}          &amp; 2,609          &amp;  5,288    &amp; 7,639       &amp; 15,205       \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.SimG.1" href="javascript:togglecode('toggleCode.SimG.1','displayCode.SimG.1');"><i><strong>R Code for Simulation Using Gaussian Copula</strong></i></a>
</h5>
<div id="toggleCode.SimG.1" style="display: none">
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ChapDependenceModel.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the gamma distributions, use</span></span>
<span id="cb253-2"><a href="ChapDependenceModel.html#cb253-2" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb253-3"><a href="ChapDependenceModel.html#cb253-3" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb253-4"><a href="ChapDependenceModel.html#cb253-4" aria-hidden="true" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb253-5"><a href="ChapDependenceModel.html#cb253-5" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb253-6"><a href="ChapDependenceModel.html#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For the Pareto distributions, use</span></span>
<span id="cb253-7"><a href="ChapDependenceModel.html#cb253-7" aria-hidden="true" tabindex="-1"></a>alpha3 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb253-8"><a href="ChapDependenceModel.html#cb253-8" aria-hidden="true" tabindex="-1"></a>theta3 <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb253-9"><a href="ChapDependenceModel.html#cb253-9" aria-hidden="true" tabindex="-1"></a>alpha4 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb253-10"><a href="ChapDependenceModel.html#cb253-10" aria-hidden="true" tabindex="-1"></a>theta4 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb253-11"><a href="ChapDependenceModel.html#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Deductibles</span></span>
<span id="cb253-12"><a href="ChapDependenceModel.html#cb253-12" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb253-13"><a href="ChapDependenceModel.html#cb253-13" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb253-14"><a href="ChapDependenceModel.html#cb253-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-15"><a href="ChapDependenceModel.html#cb253-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-16"><a href="ChapDependenceModel.html#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the risks</span></span>
<span id="cb253-17"><a href="ChapDependenceModel.html#cb253-17" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co">#number of simulations</span></span>
<span id="cb253-18"><a href="ChapDependenceModel.html#cb253-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)  <span class="co">#set seed to reproduce work </span></span>
<span id="cb253-19"><a href="ChapDependenceModel.html#cb253-19" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha1, <span class="at">scale =</span> theta1)</span>
<span id="cb253-20"><a href="ChapDependenceModel.html#cb253-20" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha2, <span class="at">scale =</span> theta2)</span>
<span id="cb253-21"><a href="ChapDependenceModel.html#cb253-21" aria-hidden="true" tabindex="-1"></a><span class="co"># For the Pareto Distribution, use</span></span>
<span id="cb253-22"><a href="ChapDependenceModel.html#cb253-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb253-23"><a href="ChapDependenceModel.html#cb253-23" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rparetoII</span>(nSim, <span class="at">scale =</span> theta3, <span class="at">shape =</span> alpha3)</span>
<span id="cb253-24"><a href="ChapDependenceModel.html#cb253-24" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">rparetoII</span>(nSim, <span class="at">scale =</span> theta4, <span class="at">shape =</span> alpha4)</span>
<span id="cb253-25"><a href="ChapDependenceModel.html#cb253-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio Risks</span></span>
<span id="cb253-26"><a href="ChapDependenceModel.html#cb253-26" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4</span>
<span id="cb253-27"><a href="ChapDependenceModel.html#cb253-27" aria-hidden="true" tabindex="-1"></a>Sretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X1, d1) <span class="sc">+</span> <span class="fu">pmin</span>(X2, d2)</span>
<span id="cb253-28"><a href="ChapDependenceModel.html#cb253-28" aria-hidden="true" tabindex="-1"></a>Sinsurer <span class="ot">&lt;-</span> S <span class="sc">-</span> Sretained</span>
<span id="cb253-29"><a href="ChapDependenceModel.html#cb253-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-30"><a href="ChapDependenceModel.html#cb253-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected Claim Amounts</span></span>
<span id="cb253-31"><a href="ChapDependenceModel.html#cb253-31" aria-hidden="true" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Sretained), <span class="fu">mean</span>(Sinsurer), <span class="fu">mean</span>(S))))</span>
<span id="cb253-32"><a href="ChapDependenceModel.html#cb253-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ExpVec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb253-33"><a href="ChapDependenceModel.html#cb253-33" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ExpVec, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb253-34"><a href="ChapDependenceModel.html#cb253-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-35"><a href="ChapDependenceModel.html#cb253-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles</span></span>
<span id="cb253-36"><a href="ChapDependenceModel.html#cb253-36" aria-hidden="true" tabindex="-1"></a>quantMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">quantile</span>(Sretained, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(Sinsurer,</span>
<span id="cb253-37"><a href="ChapDependenceModel.html#cb253-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(S, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)))</span>
<span id="cb253-38"><a href="ChapDependenceModel.html#cb253-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(quantMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb253-39"><a href="ChapDependenceModel.html#cb253-39" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(quantMat, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb253-40"><a href="ChapDependenceModel.html#cb253-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-41"><a href="ChapDependenceModel.html#cb253-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(S), <span class="at">main =</span> <span class="st">&quot;Density of Total Portfolio Risk S&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;S&quot;</span>)</span>
<span id="cb253-42"><a href="ChapDependenceModel.html#cb253-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-43"><a href="ChapDependenceModel.html#cb253-43" aria-hidden="true" tabindex="-1"></a><span class="do">### Normal Copula ##</span></span>
<span id="cb253-44"><a href="ChapDependenceModel.html#cb253-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb253-45"><a href="ChapDependenceModel.html#cb253-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb253-46"><a href="ChapDependenceModel.html#cb253-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GB2)</span>
<span id="cb253-47"><a href="ChapDependenceModel.html#cb253-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statmod)</span>
<span id="cb253-48"><a href="ChapDependenceModel.html#cb253-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb253-49"><a href="ChapDependenceModel.html#cb253-49" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb253-50"><a href="ChapDependenceModel.html#cb253-50" aria-hidden="true" tabindex="-1"></a>parm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb253-51"><a href="ChapDependenceModel.html#cb253-51" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">normalCopula</span>(parm, <span class="at">dim =</span> <span class="dv">4</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb253-52"><a href="ChapDependenceModel.html#cb253-52" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(nc, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;paretoII&quot;</span>, <span class="st">&quot;paretoII&quot;</span>), <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta1,</span>
<span id="cb253-53"><a href="ChapDependenceModel.html#cb253-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> alpha1), <span class="fu">list</span>(<span class="at">scale =</span> theta2, <span class="at">shape =</span> alpha2), <span class="fu">list</span>(<span class="at">scale =</span> theta3, <span class="at">shape =</span> alpha3),</span>
<span id="cb253-54"><a href="ChapDependenceModel.html#cb253-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">scale =</span> theta4, <span class="at">shape =</span> alpha4)))</span>
<span id="cb253-55"><a href="ChapDependenceModel.html#cb253-55" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc)</span>
<span id="cb253-56"><a href="ChapDependenceModel.html#cb253-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-57"><a href="ChapDependenceModel.html#cb253-57" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[, <span class="dv">1</span>]</span>
<span id="cb253-58"><a href="ChapDependenceModel.html#cb253-58" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[, <span class="dv">2</span>]</span>
<span id="cb253-59"><a href="ChapDependenceModel.html#cb253-59" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> X[, <span class="dv">3</span>]</span>
<span id="cb253-60"><a href="ChapDependenceModel.html#cb253-60" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> X[, <span class="dv">4</span>]</span>
<span id="cb253-61"><a href="ChapDependenceModel.html#cb253-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-62"><a href="ChapDependenceModel.html#cb253-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio Risks</span></span>
<span id="cb253-63"><a href="ChapDependenceModel.html#cb253-63" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4</span>
<span id="cb253-64"><a href="ChapDependenceModel.html#cb253-64" aria-hidden="true" tabindex="-1"></a>Sretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X1, d1) <span class="sc">+</span> <span class="fu">pmin</span>(X2, d2)</span>
<span id="cb253-65"><a href="ChapDependenceModel.html#cb253-65" aria-hidden="true" tabindex="-1"></a>Sinsurer <span class="ot">&lt;-</span> S <span class="sc">-</span> Sretained</span>
<span id="cb253-66"><a href="ChapDependenceModel.html#cb253-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-67"><a href="ChapDependenceModel.html#cb253-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected Claim Amounts</span></span>
<span id="cb253-68"><a href="ChapDependenceModel.html#cb253-68" aria-hidden="true" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Sretained), <span class="fu">mean</span>(Sinsurer), <span class="fu">mean</span>(S))))</span>
<span id="cb253-69"><a href="ChapDependenceModel.html#cb253-69" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ExpVec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb253-70"><a href="ChapDependenceModel.html#cb253-70" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ExpVec, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb253-71"><a href="ChapDependenceModel.html#cb253-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-72"><a href="ChapDependenceModel.html#cb253-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles</span></span>
<span id="cb253-73"><a href="ChapDependenceModel.html#cb253-73" aria-hidden="true" tabindex="-1"></a>quantMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">quantile</span>(Sretained, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(Sinsurer,</span>
<span id="cb253-74"><a href="ChapDependenceModel.html#cb253-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(S, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)))</span>
<span id="cb253-75"><a href="ChapDependenceModel.html#cb253-75" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(quantMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb253-76"><a href="ChapDependenceModel.html#cb253-76" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(quantMat, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb253-77"><a href="ChapDependenceModel.html#cb253-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-78"><a href="ChapDependenceModel.html#cb253-78" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(S), <span class="at">main =</span> <span class="st">&quot;Density of Total Portfolio Risk S&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;S&quot;</span>)</span></code></pre></div>
</div>
<p>It should be noted that there are various methods of conducting dependence modeling, but copulas are effective for many actuarial applications. It’s important to stress that each copula function captures a distinct dependency structure based on its functional form and dependence parameters. Therefore, utilizing copulas without comprehending their limitations and properties can lead to biased and statistically incorrect results. Since selecting the right copula involves extensive effort, here are some general tips that can assist:</p>
<ol style="list-style-type: decimal">
<li><p>When analyzing data, diagnostic and exploratory analysis can provide insight into the dependence structure of the data, which can help determine suitable copula functions. For Archimedean Copulas specifically, understanding the dependence structure can narrow down the appropriate type of copula function. For instance, the Gumbel-Hougaard copula is not suitable for negative dependency, but the Frank Copula can effectively capture three distinct types of dependency in the data.</p></li>
<li><p>Researchers cannot rely on Normal copula or Frank copula functions to capture the upper and lower tail dependency in data. Instead, a <span class="math inline">\(t\)</span> copula with low degrees of freedom works well for both tails. The Gumbel-Hougaard copula shows some upper tail dependence but less or no lower tail dependence, while the Clayton copula exhibits strong lower tail dependence.</p></li>
</ol>
</div>
<div id="copula-regression" class="section level3 hasAnchor" number="16.6.2">
<h3><span class="header-section-number">16.6.2</span> Copula Regression<a href="ChapDependenceModel.html#copula-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In regression studies, the response variable is determined by a group of explanatory variables. This is often one of the initial statistical methods used to understand the connection between the response and explanatory variables. However, Linear Models and Generalized Linear Models can impose constraints on the selection of distributions for the response variables, which can be restrictive for practical data scenarios. For example, insurance claim amounts and financial asset returns typically exhibit heavy-tailed and skewed distributions, and may not adhere to normality patterns, with the possibility of having extreme values.</p>
<p>The use of copulas in regression is gaining attention in the field of actuarial science. Copula regression separates the dependency structure from the selection of marginal distributions, allowing for greater flexibility in choosing distributions for actuarial applications. The parameters for the marginal distributions and the copula distribution can be estimated either separately or together. The maximum likelihood method is often effective for estimating the parameters. However, for copula regression parameter estimation, the inference for margins method (IFM) is commonly used. Copula functions preserve the marginals and make predictions using the dependent variable’s conditional mean given the covariates. See <span class="citation">Krämer et al. (<a href="bibliography.html#ref-kramer2013total" role="doc-biblioref">2013</a>)</span>, <span class="citation">Parsa and Klugman (<a href="bibliography.html#ref-parsa2011copula" role="doc-biblioref">2011</a>)</span>; for detailed examples on copula regression.</p>
<div id="surveyElement166">

</div>
<div id="surveyResult166">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz166.1" href="javascript:toggleQuiz
('display.Quiz166.2','display.Quiz166.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz166.2" style="display: none">
<p id="Quiz166Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz166.js">
</script>
</div>
</div>
<div id="S:Sec167" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Further Resources and Contributors<a href="ChapDependenceModel.html#S:Sec167" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="contributors-11" class="section level4 unnumbered hasAnchor">
<h4>Contributors<a href="ChapDependenceModel.html#contributors-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Edward (Jed) Frees</strong> and <strong>Nii-Armah Okine</strong>, University of Wisconsin-Madison, and <strong>Emine Selin Sarıdaş</strong>, Mimar Sinan University, are the principal authors of the initial version of this chapter.
<ul>
<li>Chapter reviewers include: Runhuan Feng, Fei Huang, Himchan Jeong, Min Ji, and Toby White.</li>
</ul></li>
<li><strong>Nii-Armah Okine</strong>, Appalachian State University, and <strong>Emine Selin Sarıdaş</strong>, Mimar Sinan University, are the principal authors of the second edition of this chapter. Email: <a href="mailto:okinean@appstate.edu" class="email">okinean@appstate.edu</a> and <a href="mailto:selin.saridas@msgsu.edu.tr" class="email">selin.saridas@msgsu.edu.tr</a> for chapter comments and suggested improvements.
<ul>
<li>Chapter reviewers include Mélina Mailhot.</li>
</ul></li>
</ul>
</div>
<div id="ts-16.a.-other-classic-measures-of-scalar-associations" class="section level3 unnumbered hasAnchor">
<h3>TS 16.A. Other Classic Measures of Scalar Associations<a href="ChapDependenceModel.html#ts-16.a.-other-classic-measures-of-scalar-associations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ts-16.a.1.-blomqvists-beta" class="section level4 unnumbered hasAnchor">
<h4>TS 16.A.1. Blomqvist’s Beta<a href="ChapDependenceModel.html#ts-16.a.1.-blomqvists-beta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="citation">Blomqvist (<a href="bibliography.html#ref-blomqvist1950measure" role="doc-biblioref">1950</a>)</span> developed a measure of dependence now known as <a href="#" class="tooltip" style="color:green"><em>Blomqvist’s beta</em><span style="font-size:8pt"></span></a>, also called the <em>median concordance coefficient</em> and the <em>medial correlation coefficient</em>. Using distribution functions, this parameter can be expressed as</p>
<p><span class="math display">\[\begin{equation*}
\beta_B = 4F\left(F^{-1}_X(1/2),F^{-1}_Y(1/2) \right) - 1.
\end{equation*}\]</span></p>
<p>That is, first evaluate each marginal at its median (<span class="math inline">\(F^{-1}_X(1/2)\)</span> and <span class="math inline">\(F^{-1}_Y(1/2)\)</span>, respectively). Then, evaluate the bivariate distribution function at the two medians. After rescaling (multiplying by 4 and subtracting 1), the coefficient turns out to have a range of <span class="math inline">\([-1,1]\)</span>, where 0 occurs under independence.</p>
<p>Like Spearman’s rho and Kendall’s tau, an estimator based on ranks is easy to provide. First write <span class="math inline">\(\beta_B = 4C(1/2,1/2)-1 = 2\Pr((U_1-1/2)(U_2-1/2))-1\)</span> where <span class="math inline">\(U_1, U_2\)</span> are uniform random variables. Then, define</p>
<p><span class="math display">\[
\hat{\beta}_B = \frac{2}{n} \sum_{i=1}^n I\left( (R(X_{i})-\frac{n+1}{2})(R(Y_{i})-\frac{n+1}{2}) \ge 0 \right)-1 .
\]</span></p>
<p>See, for example, <span class="citation">Joe (<a href="bibliography.html#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>, page 57 or <span class="citation">Hougaard (<a href="bibliography.html#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, page 135, for more details.</p>
<p>Because Blomqvist’s parameter is based on the center of the distribution, it is particularly useful when data are censored; in this case, information in extreme parts of the distribution are not always reliable. How does this affect a choice of association measures? First, recall that association measures are based on a bivariate distribution function. So, if one has knowledge of a good approximation of the distribution function, then calculation of an association measure is straightforward in principle. Second, for censored data, bivariate extensions of the univariate Kaplan-Meier distribution function estimator are available. For example, the version introduced in <span class="citation">Dabrowska (<a href="bibliography.html#ref-dabrowska1988kaplan" role="doc-biblioref">1988</a>)</span> is appealing. However, because of instances when large masses of data appear at the upper range of the data, this and other estimators of the bivariate distribution function are unreliable. This means that, summary measures of the estimated distribution function based on Spearman’s rho or Kendall’s tau can be unreliable. For this situation, Blomqvist’s beta appears to be a better choice as it focuses on the center of the distribution. <span class="citation">Hougaard (<a href="bibliography.html#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, Chapter 14, provides additional discussion.</p>
<p>You can obtain the Blomqvist’s beta, using the <code>betan()</code> function from the <code>copula</code> library in <code>R</code>. From below, <span class="math inline">\(\beta_B=0.3\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
<h5 style="text-align: center;">
<a id="displayCode.beta.1" href="javascript:togglecode('toggleCode.beta.1','displayCode.beta.1');"><i><strong>R Code for Blomqvist’s Beta</strong></i></a>
</h5>
<div id="toggleCode.beta.1" style="display: none">
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="ChapDependenceModel.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Blomqvist&#39;s beta correlation between Claim and Coverage </span><span class="al">###</span></span>
<span id="cb254-2"><a href="ChapDependenceModel.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb254-3"><a href="ChapDependenceModel.html#cb254-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(Claim)</span>
<span id="cb254-4"><a href="ChapDependenceModel.html#cb254-4" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">cbind</span>(((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Claim)),((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Coverage)))</span>
<span id="cb254-5"><a href="ChapDependenceModel.html#cb254-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fu">betan</span>(U, <span class="at">scaling=</span><span class="cn">FALSE</span>)</span>
<span id="cb254-6"><a href="ChapDependenceModel.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta,<span class="dv">2</span>)</span>
<span id="cb254-7"><a href="ChapDependenceModel.html#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="ChapDependenceModel.html#cb254-8" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb254-9"><a href="ChapDependenceModel.html#cb254-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.3</span></span>
<span id="cb254-10"><a href="ChapDependenceModel.html#cb254-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-11"><a href="ChapDependenceModel.html#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Blomqvist&#39;s beta correlation between Claim and log(Coverage) </span><span class="al">###</span></span>
<span id="cb254-12"><a href="ChapDependenceModel.html#cb254-12" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(Claim)</span>
<span id="cb254-13"><a href="ChapDependenceModel.html#cb254-13" aria-hidden="true" tabindex="-1"></a>Fx<span class="ot">&lt;-</span><span class="fu">cbind</span>(((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Claim)),((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(<span class="fu">log</span>(Coverage))))</span>
<span id="cb254-14"><a href="ChapDependenceModel.html#cb254-14" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fu">betan</span>(Fx, <span class="at">scaling=</span><span class="cn">FALSE</span>)</span>
<span id="cb254-15"><a href="ChapDependenceModel.html#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta,<span class="dv">2</span>)</span>
<span id="cb254-16"><a href="ChapDependenceModel.html#cb254-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-17"><a href="ChapDependenceModel.html#cb254-17" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb254-18"><a href="ChapDependenceModel.html#cb254-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.3</span></span></code></pre></div>
</div>
<p>In addition, to show that the Blomqvist’s beta is invariant under strictly increasing transformations, <span class="math inline">\(\beta_B=0.3\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in logarithmic millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
</div>
<div id="ts-16.a.2.-nonparametric-approach-using-spearman-correlation-with-tied-ranks" class="section level4 unnumbered hasAnchor">
<h4>TS 16.A.2. Nonparametric Approach Using Spearman Correlation with Tied Ranks<a href="ChapDependenceModel.html#ts-16.a.2.-nonparametric-approach-using-spearman-correlation-with-tied-ranks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the first variable, the average rank of observations in the <span class="math inline">\(s\)</span>th row is</p>
<p><span class="math display">\[\begin{equation*}
r_{1s} = n_{m_1\bullet}+ \cdots+ n_{s-1,\bullet}+ \frac{1}{2} \left(1+ n_{s\bullet}\right)
\end{equation*}\]</span></p>
<p>and similarly <span class="math inline">\(r_{2t} = \frac{1}{2} \left[(n_{\bullet m_1}+ \cdots+ n_{\bullet,s-1}+1)+ (n_{\bullet m_1}+ \cdots+ n_{\bullet s})\right]\)</span>. With this, we have Spearman’s rho with tied rank is</p>
<p><span class="math display">\[\begin{equation*}
\hat{\rho}_S = \frac{\sum_{s=m_1}^{m_2} \sum_{t=m_1}^{m_2} n_{st}(r_{1s} - \bar{r})(r_{2t} - \bar{r})}
{\left[\sum_{s=m_1}^{m_2}n_{s \bullet}(r_{1s} - \bar{r})^2 \sum_{t=m_1}^{m_2} n_{\bullet t}(r_{2t} - \bar{r})^2
\right]^2}
\end{equation*}\]</span></p>
<p>where the average rank is <span class="math inline">\(\bar{r} = (n+1)/2\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.Thry.1" href="javascript:togglecode('toggleCode.Thry.1','displayCode.Thry.1');"><i><strong>Click to Show Proof for Special Case: Binary Data.</strong></i></a>
</h5>
<div id="toggleCode.Thry.1" style="display: none">
<p><em>Special Case: Binary Data</em>. Here, <span class="math inline">\(m_1=0\)</span> and <span class="math inline">\(m_2=1\)</span>. For the first variable ranks, we have <span class="math inline">\(r_{10} = (1+n_{0\bullet})/2\)</span> and <span class="math inline">\(r_{11} = (n_{0\bullet}+1+n)/2\)</span>. Thus, <span class="math inline">\(r_{10} -\bar{r}= (n_{0\bullet}-n)/2\)</span> and <span class="math inline">\(r_{11}-\bar{r} = n_{0\bullet}/2\)</span>.
This means that we have <span class="math inline">\(\sum_{s=0}^{1}n_{s\bullet}(r_{1s} - \bar{r})^2 = n (n-n_{0\bullet})n_{0\bullet}/4\)</span> and similarly for the second variable. For the numerator, we have
<span class="math display">\[\begin{eqnarray*}
\sum_{s=0}^{1}  \sum_{t=0}^{1} &amp;&amp; n_{st}(r_{1s} - \bar{r})(r_{2t} - \bar{r})\\
&amp;=&amp; n_{00} \frac{n_{0\bullet}-n}{2} \frac{n_{\bullet 0}-n}{2}
+n_{01} \frac{n_{0\bullet}-n}{2} \frac{n_{\bullet 0}}{2}
+n_{10} \frac{n_{0\bullet}}{2} \frac{n_{\bullet 0}-n}{2}
+n_{11} \frac{n_{0\bullet}}{2} \frac{n_{\bullet 0}}{2} \\
&amp;=&amp; \frac{1}{4}(n_{00} (n_{0\bullet}-n) (n_{\bullet 0}-n)
+(n_{0\bullet}-n_{00}) (n_{0\bullet}-n)n_{\bullet 0} \\
&amp;&amp;  ~ ~ ~ +(n_{\bullet 0}-n_{00})  n_{0\bullet}(n_{\bullet 0}-n)
+(n-n_{\bullet 0}-n_{0\bullet}+n_{00}) n_{0\bullet}n_{\bullet 0} ) \\
&amp;=&amp; \frac{1}{4}(n_{00} n^2
- n_{0\bullet} (n_{0\bullet}-n)n_{\bullet 0} \\
&amp;&amp; ~ ~ ~ +n_{\bullet 0}  n_{0\bullet}(n_{\bullet 0}-n)
+(n-n_{\bullet 0}-n_{0\bullet}) n_{0\bullet}n_{\bullet 0} ) \\
&amp;=&amp; \frac{1}{4}(n_{00} n^2
- n_{0\bullet}n_{\bullet 0} (n_{0\bullet}-n +n_{\bullet 0}-n
+n-n_{\bullet 0}-n_{0\bullet}) \\
&amp;=&amp; \frac{n}{4}(n n_{00} - n_{0\bullet}n_{\bullet 0}) .
\end{eqnarray*}\]</span></p>
<p>This yields
<span class="math display">\[\begin{eqnarray*}
\hat{\rho}_S &amp;=&amp; \frac{n(n n_{00} - n_{0\bullet}n_{\bullet 0})}
{4\sqrt{(n (n-n_{0\bullet})n_{0\bullet}/4)(n (n-n_{\bullet 0})n_{\bullet 0}/4)}} \\
&amp;=&amp; \frac{n n_{00} - n_{0\bullet}n_{\bullet 0}}
{\sqrt{ n_{0\bullet} n_{\bullet 0}(n-n_{0\bullet}) (n-n_{\bullet 0})}} \\
&amp;=&amp; \frac{n_{00} - n (1-\hat{\pi}_X)(1- \hat{\pi}_Y)}
{\sqrt{\hat{\pi}_X(1-\hat{\pi}_X)\hat{\pi}_Y(1-\hat{\pi}_Y) }}
\end{eqnarray*}\]</span>
where <span class="math inline">\(\hat{\pi}_X = (n-n_{0\bullet})/n\)</span> and similarly for <span class="math inline">\(\hat{\pi}_Y\)</span>. Note that this is same form as the Pearson measure. From this, we see that the joint count <span class="math inline">\(n_{00}\)</span> drives this association measure.</p>
</div>
<p>You can obtain the ties-corrected Spearman correlation statistic <span class="math inline">\(r_S\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>spearman</code> method. From below <span class="math inline">\(\hat{\rho}_S=-0.09\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.spearT.1" href="javascript:togglecode('toggleCode.spearT.1','displayCode.spearT.1');"><i><strong>R Code for Ties-corrected Spearman Correlation</strong></i></a>
</h5>
<div id="toggleCode.spearT.1" style="display: none">
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ChapDependenceModel.html#cb255-1" aria-hidden="true" tabindex="-1"></a>rs_ties<span class="ot">&lt;-</span><span class="fu">cor</span>(AlarmCredit,NoClaimCredit, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb255-2"><a href="ChapDependenceModel.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs_ties,<span class="dv">2</span>)</span>
<span id="cb255-3"><a href="ChapDependenceModel.html#cb255-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-4"><a href="ChapDependenceModel.html#cb255-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb255-5"><a href="ChapDependenceModel.html#cb255-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.09</span></span></code></pre></div>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ChapBonusMalus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="CAppA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LDAEd2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
